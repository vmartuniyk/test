#Область ИнтерфейсАвтоматическихТестов

Перем ЮнитТест;

Функция ПолучитьСписокТестов(ЮнитТестирование) Экспорт
	
	ЮнитТест = ЮнитТестирование;
	
	СписокТестов = Новый Массив;	
	Возврат СписокТестов;
	
КонецФункции

#КонецОбласти

#Область ПрограммныйИнтерфейс

// Загружает списки с ошибками ведения учета
// в таблицы формы.
// 
// Параметры
//  ФормаОбработки - УправляемаяФорма - основная форма обработки.
// 
Процедура СформироватьПоказатели(ФормаОбработки) Экспорт

	УстановитьПривилегированныйРежим(Истина);
	
	Элементы		= ФормаОбработки.Элементы;
	ДатаНачала		= ФормаОбработки.ДатаНачала;
	ДатаОкончания	= КонецДня(ФормаОбработки.ДатаОкончания);
	
	Запрос 			= Новый Запрос;
	Запрос.Текст 	= ПолучитьТекстОсновногоЗапроса();
	
	Запрос.УстановитьПараметр("ДатаНачала", 					ДатаНачала);
	Запрос.УстановитьПараметр("ДатаОкончания", 					ДатаОкончания);
	Запрос.УстановитьПараметр("ГраницаНачало",					Новый Граница(ДатаНачала, ВидГраницы.Включая));
	Запрос.УстановитьПараметр("ГраницаОкончания",				Новый Граница(ДатаОкончания, ВидГраницы.Включая));
	Запрос.УстановитьПараметр("ТипНоменклатуры",				Перечисления.ТипыНоменклатуры.Товар);
	Запрос.УстановитьПараметр("ВалютаУправленческогоУчета",		Константы.ВалютаУправленческогоУчета.Получить());
	Запрос.УстановитьПараметр("ВалютаРегламентированногоУчета",	Константы.ВалютаРегламентированногоУчета.Получить());	
	РезультатЗапроса = Запрос.ВыполнитьПакет();
	
	ПостроитьСписокПоступленийТоваров(ФормаОбработки, Элементы, РезультатЗапроса);
	ПостроитьСписокВнутреннихПотребленийТоваров(ФормаОбработки, Элементы, РезультатЗапроса);
	ПостроитьСписокДокументовДвиженияДенежныхСредств(ФормаОбработки, Элементы, РезультатЗапроса);
	ПостроитьСписокФинДокументовМеждуОрганизациями(ФормаОбработки, Элементы, РезультатЗапроса);
	ПостроитьСписокКурсовДвиженийДокументов(ФормаОбработки, Элементы, РезультатЗапроса);
	ПостроитьСписокАвтосведениеВзаиморасчетов(ФормаОбработки, Элементы, РезультатЗапроса);
	ПостроитьСписокОтрицательныхОстатков(ФормаОбработки, Элементы, РезультатЗапроса);
	ПостроитьСписокДокументовРентабельность(ФормаОбработки, Элементы, РезультатЗапроса);
	ПостроитьОтчетРазличныеСуммыДокументовРКОиПКО(ФормаОбработки, Элементы);
	ПостроитьОтчетНаличиеУслугВДокументахДляТоваров(ФормаОбработки, Элементы);
	ПостроитьСписокДокументовПериодВозникновения(ФормаОбработки, Элементы, РезультатЗапроса);
	ПостроитьСписокДокументовПУиПА(ФормаОбработки, Элементы, РезультатЗапроса);
	ПостроитьСписокПроверенныхДокументовПередач(ФормаОбработки, Элементы, РезультатЗапроса);
	ПостроитьСписокДвиженияРасчетыСПоставщиками(ФормаОбработки, Элементы, РезультатЗапроса);
	
КонецПроцедуры

// Формирует баланс предприятия
// в таблицы формы.
// 
// Параметры
//  ФормаОбработки - УправляемаяФорма - основная форма обработки.
//
Процедура СформироватьБаланс(ФормаОбработки) Экспорт
	
	УстановитьПривилегированныйРежим(Истина);
		
	ДатаНачала		= ФормаОбработки.ДатаНачала;
	ДатаОкончания	= КонецДня(ФормаОбработки.ДатаОкончания);
	                                 
	Запрос 			= Новый Запрос;
	Запрос.Текст 	= ПолучитьТекстЗапросаБаланс();
	Запрос.УстановитьПараметр("ПредПериод", ДатаНачала-1);
	Запрос.УстановитьПараметр("ГраницаПредПериод", Новый Граница(ДатаНачала-1, ВидГраницы.Включая));
	Запрос.УстановитьПараметр("ДатаНачала", ДатаНачала);
	Запрос.УстановитьПараметр("ГраницаДатаНачала", Новый Граница(ДатаНачала, ВидГраницы.Включая));
	Запрос.УстановитьПараметр("ДатаОкончания", ДатаОкончания);
	Запрос.УстановитьПараметр("ГраницаДатаОкончания", Новый Граница(ДатаОкончания, ВидГраницы.Включая));
	Запрос.УстановитьПараметр("ВалютаУправленческогоУчета",	Константы.ВалютаУправленческогоУчета.Получить());	
	РезультатЗапроса = Запрос.ВыполнитьПакет();

	
	
	ДОСОрганизаций = Новый Соответствие;
	ДИРОрганизаций = Новый Соответствие;
	
	ДеревоДинамикаОборотныхСредств = ФормаОбработки.РеквизитФормыВЗначение("ДинамикаОборотныхСредств");
	ДеревоДинамикаОборотныхСредств.Строки.Очистить();

	ДобавитьВДинамикуОборотныхСредств(ДОСОрганизаций, ДеревоДинамикаОборотныхСредств, "Активы", "Товары", РезультатЗапроса, 1 , 2);
	ДобавитьВДинамикуОборотныхСредств(ДОСОрганизаций, ДеревоДинамикаОборотныхСредств, "Активы", "Денежные средства наличные", РезультатЗапроса, 5 , 6);
	ДобавитьВДинамикуОборотныхСредств(ДОСОрганизаций, ДеревоДинамикаОборотныхСредств, "Активы", "Денежные средства безналичные", РезультатЗапроса, 7 , 8);
	ДобавитьВДинамикуОборотныхСредств(ДОСОрганизаций, ДеревоДинамикаОборотныхСредств, "Активы", "Расчеты между организациями", РезультатЗапроса, 9 , 10);
	ДобавитьВДинамикуОборотныхСредств(ДОСОрганизаций, ДеревоДинамикаОборотныхСредств, "Активы", "Ден. ср-ва у подотчетных лиц", РезультатЗапроса, 11 , 12);
	ДобавитьВДинамикуОборотныхСредств(ДОСОрганизаций, ДеревоДинамикаОборотныхСредств, "Активы", "Дебиторская задолженность", РезультатЗапроса, 13 , 14);
	ДобавитьВДинамикуОборотныхСредств(ДОСОрганизаций, ДеревоДинамикаОборотныхСредств, "Активы", "Ожид. ДС по эквайрингу", РезультатЗапроса, 68 , 69);
	ДобавитьВДинамикуОборотныхСредств(ДОСОрганизаций, ДеревоДинамикаОборотныхСредств, "Активы", "Ожид. ДС по банку (нет выписки)", РезультатЗапроса, 73 , 74);
	ДобавитьВДинамикуОборотныхСредств(ДОСОрганизаций, ДеревоДинамикаОборотныхСредств, "Активы", "Ожид. ДС в кассу", РезультатЗапроса, 75 , 76);
	ДобавитьВДинамикуОборотныхСредств(ДОСОрганизаций, ДеревоДинамикаОборотныхСредств, "Пассивы", "Расчеты между организациями", РезультатЗапроса, 15 , 16);
	ДобавитьВДинамикуОборотныхСредств(ДОСОрганизаций, ДеревоДинамикаОборотныхСредств, "Пассивы", "Задолженность подотчетным лицам", РезультатЗапроса, 17 , 18);
	ДобавитьВДинамикуОборотныхСредств(ДОСОрганизаций, ДеревоДинамикаОборотныхСредств, "Пассивы", "Кредиторская за товары, услуги", РезультатЗапроса, 19 , 20);
	ДобавитьВДинамикуОборотныхСредств(ДОСОрганизаций, ДеревоДинамикаОборотныхСредств, "Пассивы", "ДС к списанию по банку", РезультатЗапроса, 77 , 78);

	
	Выборка = РезультатЗапроса[72].Выбрать();
	Пока Выборка.Следующий() Цикл
		СтруктураЗаписи = ДОСОрганизаций[Выборка.Организация];
		СтрокаЗаписи = СтруктураЗаписи["Активы"];
		ЗаписьЛист = СтрокаЗаписи.Строки.Добавить();
		ЗаписьЛист.Наименование = "Расходы будущих периодов";
		ЗаписьЛист.НачальноеЗначение = 0;
		ЗаписьЛист.Значение = Выборка.СуммаОстаток;
		ЗаписьЛист.Дельта = ЗаписьЛист.Значение - ЗаписьЛист.НачальноеЗначение;		
	КонецЦикла;

	
	СКНЗ = 0; // Собственный капитал
	СККЗ = 0; // Собственный капитал
	Для каждого КлючИЗначение Из ДОСОрганизаций Цикл
		
		СтрокаАктивы  = КлючИЗначение.Значение["Активы"];
		СтрокаПассивы = КлючИЗначение.Значение["Пассивы"];
		
		АктивыРМО 	= СтрокаАктивы.Строки.Найти("Расчеты между организациями", "Наименование");
		ПассивыРМО 	= СтрокаПассивы.Строки.Найти("Расчеты между организациями", "Наименование");
		
		тАктивыРМО  = ?(АктивыРМО.Значение >= ПассивыРМО.Значение, АктивыРМО.Значение - ПассивыРМО.Значение, 0);
		тПассивыРМО = ?(АктивыРМО.Значение >= ПассивыРМО.Значение, 0, ПассивыРМО.Значение - АктивыРМО.Значение);
		тАктивыРМОн = ?(АктивыРМО.НачальноеЗначение >= ПассивыРМО.НачальноеЗначение, АктивыРМО.НачальноеЗначение - ПассивыРМО.НачальноеЗначение, 0);
		ПассивыРМОн = ?(АктивыРМО.НачальноеЗначение >= ПассивыРМО.НачальноеЗначение, 0, ПассивыРМО.НачальноеЗначение - АктивыРМО.НачальноеЗначение);	
		
		АктивыРМО.Значение 			= тАктивыРМО;
		АктивыРМО.НачальноеЗначение = тАктивыРМОн;
		АктивыРМО.Дельта 			= тАктивыРМО - тАктивыРМОн;
		
		ПассивыРМО.Значение 		 = тПассивыРМО;
		ПассивыРМО.НачальноеЗначение = ПассивыРМОн;
		ПассивыРМО.Дельта 			 = тПассивыРМО - ПассивыРМОн;
		
		Для каждого СтрокаАктивов Из СтрокаАктивы.Строки Цикл
			СтрокаАктивы.Значение = СтрокаАктивы.Значение + СтрокаАктивов.Значение;	
			СтрокаАктивы.НачальноеЗначение = СтрокаАктивы.НачальноеЗначение + СтрокаАктивов.НачальноеЗначение;
		КонецЦикла; 
		
		СтрокаАктивы.Дельта = СтрокаАктивы.Значение - СтрокаАктивы.НачальноеЗначение;
		Для каждого СтрокаАктивов Из СтрокаАктивы.Строки Цикл
			Если СтрокаАктивы.Значение = 0 Тогда
				СтрокаАктивов.Процент = 0;
			Иначе
				СтрокаАктивов.Процент = СтрокаАктивов.Значение * 100 / СтрокаАктивы.Значение;	
			КонецЕсли;
		КонецЦикла;
		
		Для каждого СтрокаПассивов Из СтрокаПассивы.Строки Цикл
			СтрокаПассивы.Значение = СтрокаПассивы.Значение + СтрокаПассивов.Значение;	
			СтрокаПассивы.НачальноеЗначение = СтрокаПассивы.НачальноеЗначение + СтрокаПассивов.НачальноеЗначение;
		КонецЦикла;
		
		СтрокаПассивы.Дельта = СтрокаПассивы.Значение - СтрокаПассивы.НачальноеЗначение;
		Для каждого СтрокаПассивов Из СтрокаПассивы.Строки Цикл
			Если СтрокаПассивы.Значение = 0 Тогда
				СтрокаПассивов.Процент = 0
			Иначе
				СтрокаПассивов.Процент = СтрокаПассивов.Значение * 100 / СтрокаПассивы.Значение;	
			КонецЕсли;	
		КонецЦикла;
		
		СтрокаКапитал = КлючИЗначение.Значение["Организация"];
		СтрокаКапитал.Значение = СтрокаАктивы.Значение - СтрокаПассивы.Значение;
		СтрокаКапитал.НачальноеЗначение = СтрокаАктивы.НачальноеЗначение - СтрокаПассивы.НачальноеЗначение;
		СтрокаКапитал.Дельта = СтрокаКапитал.Значение - СтрокаКапитал.НачальноеЗначение;
		
		СККЗ = СККЗ + СтрокаКапитал.Значение;
		СКНЗ = СКНЗ + СтрокаКапитал.НачальноеЗначение;
	
	КонецЦикла; 
	
	ДеревоДинамикаОборотныхСредств.Строки.Сортировать("Дельта Возр");
	
	СтрокаСобственныйКапитал = ДеревоДинамикаОборотныхСредств.Строки.Добавить();
	СтрокаСобственныйКапитал.Наименование = "Собственный капитал";
	СтрокаСобственныйКапитал.Значение = СККЗ;
	СтрокаСобственныйКапитал.НачальноеЗначение = СКНЗ;
	СтрокаСобственныйКапитал.Дельта = СККЗ - СКНЗ;
	СтруктураЗаписи = Новый Структура("Организация, Доходы, Расходы", СтрокаСобственныйКапитал);
	ДОСОрганизаций[Справочники.Организации.ПустаяСсылка()] = СтруктураЗаписи;	
	

	
	ДеревоДоходыИРасходы = ФормаОбработки.РеквизитФормыВЗначение("ДоходыИРасходы");
	ДеревоДоходыИРасходы.Строки.Очистить();
	
	Для каждого СтрокаДерева Из ДеревоДинамикаОборотныхСредств.Строки Цикл
		
		СтрокаОрганизация = ДеревоДоходыИРасходы.Строки.Добавить();
		СтрокаОрганизация.Организация = СтрокаДерева.Организация;
		СтрокаОрганизация.Статья = Строка(СтрокаДерева.Организация);
			СтрокаДоходы = СтрокаОрганизация.Строки.Добавить();
			СтрокаДоходы.Статья = "Доходы";			
			СтрокаРасходы = СтрокаОрганизация.Строки.Добавить();
			СтрокаРасходы.Статья = "Расходы"; 
		СтруктураЗаписи = Новый Структура("Организация, Доходы, Расходы", СтрокаОрганизация, СтрокаДоходы, СтрокаРасходы);
		ДИРОрганизаций[СтрокаДерева.Организация] = СтруктураЗаписи;
		
		Если СтрокаДерева.Организация.Пустая() Тогда
			СтрокаОрганизация.Статья = "Прибыль";	
		КонецЕсли;
		
	КонецЦикла; 
	
	
	
	
	Выборка = РезультатЗапроса[21].Выбрать();
	Пока Выборка.Следующий() Цикл
		
		СтрокаДоходы = ДИРОрганизаций[Выборка.Организация]["Доходы"];
		
		НоваяСтрока = СтрокаДоходы.Строки.Добавить();
		НоваяСтрока.Статья = "Всего выручка";
		НоваяСтрока.Значение = Выборка.ВыручкаОтПродаж;
		НоваяСтрока.Учитывать = Ложь;
		
		НоваяСтрока = СтрокаДоходы.Строки.Добавить();
		НоваяСтрока.Статья = "Себестоимость всего";
		НоваяСтрока.Значение = Выборка.СебестоимостьПродаж;
		НоваяСтрока.Учитывать = Ложь;
		
		НоваяСтрока = СтрокаДоходы.Строки.Добавить();
		НоваяСтрока.Статья = "Маржинальный доход";
		НоваяСтрока.Значение = Выборка.МаржинальныйДоход;
		НоваяСтрока.Учитывать = Истина;
		
	КонецЦикла;
	
	Выборка = РезультатЗапроса[22].Выбрать();
	Пока Выборка.Следующий() Цикл
		СтрокаДоходы = ДИРОрганизаций[Выборка.Организация]["Доходы"];
		НоваяСтрока = СтрокаДоходы.Строки.Добавить();
		НоваяСтрока.Статья = "Продажи между организациями";
		НоваяСтрока.Значение = Выборка.МаржинальныйДоход;
		НоваяСтрока.Учитывать = Истина;
	КонецЦикла;
		
	Выборка = РезультатЗапроса[23].Выбрать();
	Пока Выборка.Следующий() Цикл
		СтрокаДоходы = ДИРОрганизаций[Выборка.Организация]["Доходы"];
		НоваяСтрока = СтрокаДоходы.Строки.Добавить();
		НоваяСтрока.СтатьяДоходов = Выборка.СтатьяДоходов;
		НоваяСтрока.Статья = Строка(Выборка.СтатьяДоходов);
		НоваяСтрока.Значение = Выборка.Сумма;
		НоваяСтрока.Учитывать = Истина;	
	КонецЦикла;
	
	Выборка = РезультатЗапроса[57].Выбрать();
	Пока Выборка.Следующий() Цикл
		СтрокаДоходы = ДИРОрганизаций[Выборка.Организация]["Доходы"];
		НоваяСтрока = СтрокаДоходы.Строки.Добавить();
		НоваяСтрока.Статья = "Курсовая (от смены курса)";
		НоваяСтрока.Значение = Выборка.КурсоваяРазница;
		НоваяСтрока.Учитывать = Истина;	
	КонецЦикла;
	
	Выборка = РезультатЗапроса[99].Выбрать();
	Пока Выборка.Следующий() Цикл
		СтрокаДоходы = ДИРОрганизаций[Выборка.Организация]["Доходы"];
		НоваяСтрока = СтрокаДоходы.Строки.Добавить();
		НоваяСтрока.Статья = "Курсовая (ожид.ДС+бДС,Экв.,ДС к сп.)";
		НоваяСтрока.Значение = Выборка.КурсоваяРазница;
		НоваяСтрока.Учитывать = Истина;	
	КонецЦикла;

		
	Выборка = РезультатЗапроса[60].Выбрать();
	Пока Выборка.Следующий() Цикл
		СтрокаДоходы = ДИРОрганизаций[Выборка.Организация]["Доходы"];
		НоваяСтрока = СтрокаДоходы.Строки.Добавить();
		НоваяСтрока.Статья 		= "Наличные денежные средства (ввод остатков)";
		НоваяСтрока.Значение 	= Выборка.Сумма;
		НоваяСтрока.Учитывать 	= Истина;
	КонецЦикла;
	
	Выборка = РезультатЗапроса[61].Выбрать();
	Пока Выборка.Следующий() Цикл
		СтрокаДоходы = ДИРОрганизаций[Выборка.Организация]["Доходы"];
		НоваяСтрока = СтрокаДоходы.Строки.Добавить();
		НоваяСтрока.Статья 		= "Безналичные денежные средства (ввод остатков)";
		НоваяСтрока.Значение 	= Выборка.Сумма;
		НоваяСтрока.Учитывать 	= Истина;
	КонецЦикла;
	
	Выборка = РезультатЗапроса[62].Выбрать();
	Пока Выборка.Следующий() Цикл
		СтрокаДоходы = ДИРОрганизаций[Выборка.Организация]["Доходы"];
		НоваяСтрока = СтрокаДоходы.Строки.Добавить();
		НоваяСтрока.Статья 		= "Товары (ввод остатков)";
		НоваяСтрока.Значение 	= Выборка.Сумма;
		НоваяСтрока.Учитывать 	= Истина;
	КонецЦикла;

	Выборка = РезультатЗапроса[63].Выбрать();
	Пока Выборка.Следующий() Цикл
		СтрокаДоходы = ДИРОрганизаций[Выборка.Организация]["Доходы"];
		НоваяСтрока = СтрокаДоходы.Строки.Добавить();
		НоваяСтрока.Статья 		= "Ден. ср-ва у подотчетных лиц (ввод остатков)";
		НоваяСтрока.Значение 	= Выборка.Сумма;
		НоваяСтрока.Учитывать 	= Истина;
	КонецЦикла;
	
	Выборка = РезультатЗапроса[64].Выбрать();
	Пока Выборка.Следующий() Цикл
		СтрокаДоходы = ДИРОрганизаций[Выборка.Организация]["Доходы"];
		НоваяСтрока = СтрокаДоходы.Строки.Добавить();
		НоваяСтрока.Статья 		= "Дебиторская задолженность (ввод остатков)";
		НоваяСтрока.Значение 	= Выборка.Сумма;
		НоваяСтрока.Учитывать 	= Истина;
	КонецЦикла;
	
	Выборка = РезультатЗапроса[67].Выбрать();
	Пока Выборка.Следующий() Цикл
		СтрокаДоходы = ДИРОрганизаций[Выборка.Организация]["Доходы"];
		НоваяСтрока = СтрокаДоходы.Строки.Добавить();
		НоваяСтрока.Статья 		= "Авансы, выданные поставщикам (ввод остатков)";
		НоваяСтрока.Значение 	= Выборка.Сумма;
		НоваяСтрока.Учитывать 	= Истина;
	КонецЦикла;
	
	Выборка = РезультатЗапроса[106].Выбрать();
	Пока Выборка.Следующий() Цикл
		
		СтрокаРасходы = ДИРОрганизаций[Выборка.Организация]["Доходы"];
		
		НоваяСтрока = СтрокаРасходы.Строки.Добавить();
		//НоваяСтрока.СтатьяРасходов 	= Выборка.СтатьяРасходов;
		НоваяСтрока.Статья 			= Строка("Возвраты поставщикам");
		НоваяСтрока.Значение 		= Выборка.Сумма;
		НоваяСтрока.Учитывать 		= Истина;
	 
	КонецЦикла;
	
	Выборка = РезультатЗапроса[24].Выбрать();
	Пока Выборка.Следующий() Цикл
		
		СтрокаРасходы = ДИРОрганизаций[Выборка.Организация]["Расходы"];
		
		НоваяСтрока = СтрокаРасходы.Строки.Добавить();
		НоваяСтрока.СтатьяРасходов = Выборка.СтатьяРасходов;
		НоваяСтрока.Статья = Строка(Выборка.СтатьяРасходов);
		НоваяСтрока.Значение = Выборка.Сумма;
		НоваяСтрока.Учитывать = Истина;
	 
	КонецЦикла;
	
	Выборка = РезультатЗапроса[58].Выбрать();
	Пока Выборка.Следующий() Цикл
		
		СтрокаРасходы = ДИРОрганизаций[Выборка.Организация]["Расходы"];
		
		НоваяСтрока = СтрокаРасходы.Строки.Добавить();
		НоваяСтрока.Статья = "Курсовая (от смены курса)";
		НоваяСтрока.Значение = Выборка.КурсоваяРазница;
		НоваяСтрока.Учитывать = Истина;
	 
	КонецЦикла;
	
	Выборка = РезультатЗапроса[59].Выбрать();
	Пока Выборка.Следующий() Цикл
		
		СтрокаДоходы = ДИРОрганизаций[Выборка.Организация]["Доходы"];
		
		НоваяСтрока = СтрокаДоходы.Строки.Добавить();
		НоваяСтрока.Статья = "Курсовая (по платежным документам)";
		НоваяСтрока.Значение = Выборка.КурсоваяДоход;
		НоваяСтрока.Учитывать = Истина;
		
		СтрокаРасходы = ДИРОрганизаций[Выборка.Организация]["Расходы"];
		
		НоваяСтрока = СтрокаРасходы.Строки.Добавить();
		НоваяСтрока.Статья = "Курсовая (по платежным документам)";
		НоваяСтрока.Значение = Выборка.КурсоваяРасход;
		НоваяСтрока.Учитывать = Истина;
		
	КонецЦикла;
	
	Выборка = РезультатЗапроса[65].Выбрать();
	Пока Выборка.Следующий() Цикл
		
		СтрокаРасходы = ДИРОрганизаций[Выборка.Организация]["Расходы"];
		
		НоваяСтрока = СтрокаРасходы.Строки.Добавить();
		НоваяСтрока.Статья 		= "Кредиторская за товары, услуги (ввод остатков)";
		НоваяСтрока.Значение 	= Выборка.Сумма;
		НоваяСтрока.Учитывать 	= Истина;
		
	КонецЦикла;
	
	Выборка = РезультатЗапроса[66].Выбрать();
	Пока Выборка.Следующий() Цикл
		
		СтрокаРасходы = ДИРОрганизаций[Выборка.Организация]["Расходы"];
		
		НоваяСтрока = СтрокаРасходы.Строки.Добавить();
		НоваяСтрока.Статья 		= "Авансы, полученные от клиентов (ввод остатков)";
		НоваяСтрока.Значение 	= Выборка.Сумма;
		НоваяСтрока.Учитывать 	= Истина;
		
	КонецЦикла;
	
	Выборка = РезультатЗапроса[107].Выбрать();
	Пока Выборка.Следующий() Цикл
		
		СтрокаРасходы = ДИРОрганизаций[Выборка.Организация]["Расходы"];
		
		НоваяСтрока = СтрокаРасходы.Строки.Добавить();
		//НоваяСтрока.СтатьяРасходов 	= Выборка.СтатьяРасходов;
		НоваяСтрока.Статья 			= Строка("Возвраты поставщикам");
		НоваяСтрока.Значение 		= Выборка.Сумма;
		НоваяСтрока.Учитывать 		= Истина;
	 
	КонецЦикла;

	

	
	
	ОбщаяПрибыль = 0; // Прибыль
	Для каждого КлючИЗначение Из ДИРОрганизаций Цикл
		
		СтрокаДоходы  = КлючИЗначение.Значение["Доходы"];
		СтрокаРасходы = КлючИЗначение.Значение["Расходы"];
		
		Для каждого СтрокаДоходов Из СтрокаДоходы.Строки Цикл
			Если СтрокаДоходов.Учитывать Тогда
				СтрокаДоходы.Значение = СтрокаДоходы.Значение + СтрокаДоходов.Значение;
			КонецЕсли; 	
		КонецЦикла;
		
		Для каждого СтрокаРасходов Из СтрокаРасходы.Строки Цикл
			Если СтрокаРасходов.Учитывать Тогда
				СтрокаРасходы.Значение = СтрокаРасходы.Значение + СтрокаРасходов.Значение;
			КонецЕсли; 	
		КонецЦикла;
		
		СтрокаПрибыль = КлючИЗначение.Значение["Организация"];
		СтрокаПрибыль.Значение = СтрокаДоходы.Значение - СтрокаРасходы.Значение;

		ОбщаяПрибыль = ОбщаяПрибыль + СтрокаПрибыль.Значение;
				
	КонецЦикла;
	
	ДИРОрганизаций[Справочники.Организации.ПустаяСсылка()]["Организация"].Значение = ОбщаяПрибыль;
	
	
	
	Для каждого КлючИЗначение Из ДОСОрганизаций Цикл
		
		СтрокаДОС = КлючИЗначение.Значение["Организация"];
		СтрокаДИР = ДИРОрганизаций[СтрокаДОС.Организация]["Организация"];
		
		СтрокаДОС.Расхождение = СтрокаДОС.Дельта - СтрокаДИР.Значение;
		СтрокаДИР.Расхождение = СтрокаДИР.Значение - СтрокаДОС.Дельта;
			
	КонецЦикла;
	
	
	//ФормаОбработки.ПрибыльДинамика = СтрокаСобственныйКапитал.Дельта;
	//ФормаОбработки.ПрибыльДоходыРасходы = СтрокаПрибыль.Значение;
	//ФормаОбработки.РасхождениеБаланса = ФормаОбработки.ПрибыльДинамика - ФормаОбработки.ПрибыльДоходыРасходы;
	
	ФормаОбработки.ЗначениеВРеквизитФормы(ДеревоДоходыИРасходы, "ДоходыИРасходы");
	ФормаОбработки.ЗначениеВРеквизитФормы(ДеревоДинамикаОборотныхСредств, "ДинамикаОборотныхСредств");

КонецПроцедуры

// Формирует просроченную дебиторскую задолженость
// в таблицы формы.
// 
// Параметры
//  ФормаОбработки - УправляемаяФорма - основная форма обработки.
//
Процедура СформироватьПросрочку(ФормаОбработки) Экспорт
	
	УстановитьПривилегированныйРежим(Истина);
		
	ДатаНачала		= ФормаОбработки.ДатаНачала;
	ДатаОкончания	= КонецДня(ФормаОбработки.ДатаОкончания);
	                                 
	Запрос 			= Новый Запрос; 
	Запрос.Текст 	= ПолучитьТекстЗапросаПросрочки();
	Запрос.УстановитьПараметр("ТекущаяДата", ДатаНачала);
	Запрос.УстановитьПараметр("ГраницаТекущаяДата", Новый Граница(ДатаНачала, ВидГраницы.Включая));
	ВыборкаНачало = Запрос.Выполнить().Выбрать();
	Запрос.УстановитьПараметр("ТекущаяДата", ДатаОкончания);
	Запрос.УстановитьПараметр("ГраницаТекущаяДата", Новый Граница(ДатаОкончания, ВидГраницы.Включая));
	ВыборкаКонец = Запрос.Выполнить().Выбрать();

	СоответствиеОрганизаций = Новый Соответствие;
	ДеревоДинамикаОборотныхСредств = ФормаОбработки.РеквизитФормыВЗначение("ДинамикаОборотныхСредств");
	Для каждого Строка Из ДеревоДинамикаОборотныхСредств.Строки Цикл
		СоответствиеОрганизаций[Строка.Организация] = Строка.Строки.Найти("Дебиторская задолженность (просроченная)", "Наименование", Истина);		
	КонецЦикла; 
	
	
	Пока ВыборкаНачало.Следующий() Цикл
		СтрокаДерева = СоответствиеОрганизаций[ВыборкаНачало.Организация];	
		СтрокаДерева.НачальноеЗначение = ВыборкаНачало.СуммаПросроченныхОплат;
	КонецЦикла;
	
	Пока ВыборкаКонец.Следующий() Цикл
		СтрокаДерева = СоответствиеОрганизаций[ВыборкаКонец.Организация];	
		СтрокаДерева.Значение = ВыборкаКонец.СуммаПросроченныхОплат;
		СтрокаДерева.Дельта = СтрокаДерева.Значение - СтрокаДерева.НачальноеЗначение;
	КонецЦикла; 
	
	ФормаОбработки.ЗначениеВРеквизитФормы(ДеревоДинамикаОборотныхСредств, "ДинамикаОборотныхСредств");
	
КонецПроцедуры


// Исправляет ошибки в документах «Поступление товаров услуг»
// путем перепроведения документов.
//
// Параметры:
//  ФормаОбработки - УправляемаяФорма - основная форма обработки.
//
Процедура ИсправитьДокументыПоступленияТоваров(ФормаОбработки) Экспорт

	УстановитьПривилегированныйРежим(Истина);
	
	ТаблицаДокументы = ФормаОбработки.ТаблицаДокументыПоступления;
	
	Запрос 			= Новый Запрос;
	Запрос.Текст 	= ПолучитьТекстЗапросаИсправлениеПоступленияТоваров();
	
	Запрос.УстановитьПараметр("ТаблицаПоступлений", ТаблицаДокументы.Выгрузить());
	
	Выборка = Запрос.Выполнить().Выбрать();
	
	Пока Выборка.Следующий() Цикл
		
		ДокументОбъект = Выборка.Ссылка.ПолучитьОбъект();
		
		Если НЕ Выборка.ЕстьРасхождения Тогда
			ДокументОбъект.ЕстьРасхождения = Ложь;
		КонецЕсли;
		
		Попытка
			ДокументОбъект.Записать(РежимЗаписиДокумента.Проведение);					
		Исключение
		    ОбщегоНазначенияКлиентСервер.СообщитьПользователю(ОписаниеОшибки());
			Продолжить;
		КонецПопытки;
		
		СтруткураПоиска = Новый Структура("Ссылка", Выборка.Ссылка);
		РезультатПоиска = ТаблицаДокументы.НайтиСтроки(СтруткураПоиска);
		
		Если РезультатПоиска.Количество() > 0 Тогда
			РезультатПоиска[0].ДокументИсправлен = 1;
		КонецЕсли;
		
	КонецЦикла;

КонецПроцедуры

// Исправляет ошибки в документах «Внутреннее постребление товаров»
// путем перепроведения документов.
//
// Параметры:
//  ФормаОбработки - УправляемаяФорма - основная форма обработки.
//
Процедура ИсправитьДокументыВнутреннегоПотребленияТоваров(ФормаОбработки) Экспорт
	
	УстановитьПривилегированныйРежим(Истина);
	
	ТаблицаДокументы = ФормаОбработки.ТаблицаДокументыВнутреннегоПотребления;
	
	Запрос 			= Новый Запрос;
	Запрос.Текст 	= ПолучитьТекстЗапросаИсправлениеВнутреннегоПотребленияТоваров();
	
	Запрос.УстановитьПараметр("ТаблицаВнутреннегоПотребления", ТаблицаДокументы.Выгрузить());
	
	Выборка = Запрос.Выполнить().Выбрать();
	
	Пока Выборка.Следующий() Цикл
		
		ДокументОбъект = Выборка.Ссылка.ПолучитьОбъект();
		
		Попытка
			ДокументОбъект.Записать(РежимЗаписиДокумента.Проведение);					
		Исключение
		    ОбщегоНазначенияКлиентСервер.СообщитьПользователю(ОписаниеОшибки());
			Продолжить;
		КонецПопытки;
		
		СтруткураПоиска = Новый Структура("Ссылка", Выборка.Ссылка);
		РезультатПоиска = ТаблицаДокументы.НайтиСтроки(СтруткураПоиска);
		
		Если РезультатПоиска.Количество() > 0 Тогда
			РезультатПоиска[0].ДокументИсправлен = 1;
		КонецЕсли;
		
	КонецЦикла;

КонецПроцедуры

Процедура ИсправитьНеВернуюВалютуВзаимоРасчетов(ФормаОбработки) Экспорт
	
	УстановитьПривилегированныйРежим(Истина);
	
	ТаблицаДокументы = ФормаОбработки.ТаблицаФинДокументы;
	
	Запрос 			= Новый Запрос;
	Запрос.Текст 	= ПолучитьТекстЗапросаИсправлениеФинДокументов();
	Запрос.УстановитьПараметр("ТаблицаФинДокументы", ТаблицаДокументы.Выгрузить());
	
	Выборка = Запрос.Выполнить().Выбрать();
	
	ВалютаУправлУч = Константы.ВалютаУправленческогоУчета.Получить();
		
	Пока Выборка.Следующий() Цикл
		КурсУправлУЧ   = Выборка.КурсВзаиморасчетов;
        ДокументОбъект = Выборка.Ссылка.ПолучитьОбъект();
		Для Каждого ТекущаяСтрока Из ДокументОбъект.РасшифровкаПлатежа Цикл
			Если КурсУправлУЧ>1 Тогда
				
			    ТекущаяСтрока.СуммаВзаиморасчетов 	=	ТекущаяСтрока.Сумма/КурсУправлУЧ;
				ТекущаяСтрока.ВалютаВзаиморасчетов	=	ВалютаУправлУч; 				
			ИначеЕсли  КурсУправлУЧ<1 Тогда
				ТекущаяСтрока.СуммаВзаиморасчетов 	=	КурсУправлУЧ*ТекущаяСтрока.СуммаВзаиморасчетов;
				ТекущаяСтрока.ВалютаВзаиморасчетов	=	ВалютаУправлУч;   
			КонецЕсли;
         КонецЦикла; 
				
		Попытка
			ДокументОбъект.Записать(РежимЗаписиДокумента.Проведение);					
		Исключение
		    ОбщегоНазначенияКлиентСервер.СообщитьПользователю(ОписаниеОшибки());
			Продолжить;
		КонецПопытки;

	   	СтруткураПоиска = Новый Структура("Документ", Выборка.Ссылка);
		РезультатПоиска = ТаблицаДокументы.НайтиСтроки(СтруткураПоиска);
		
		Если РезультатПоиска.Количество() > 0 Тогда
			РезультатПоиска[0].ДокументИсправлен = 1;
		КонецЕсли;

	КонецЦикла;
 	
КонецПроцедуры

// Исправляет курс движения документов путем перепроведения документов.
//
// Параметры:
//  ФормаОбработки - УправляемаяФорма - основная форма обработки.
//
Процедура ИсправитьКурсыДвиженийДокументов(ФормаОбработки) Экспорт

	УстановитьПривилегированныйРежим(Истина);
	
	ТаблицаДокументы = ФормаОбработки.ТаблицаКурсовДвиженийДокументов;
	
	Запрос 			= Новый Запрос;
	Запрос.Текст 	= ПолучитьТекстЗапросаИсправленияКурсаДвиженийДокументов();
	
	Запрос.УстановитьПараметр("ТаблицаКурсовДвиженийДокументов", ТаблицаДокументы.Выгрузить());
	
	Выборка = Запрос.Выполнить().Выбрать();
	
	Пока Выборка.Следующий() Цикл
		
		ДокументОбъект = Выборка.Ссылка.ПолучитьОбъект();
		
		Попытка
			ДокументОбъект.Записать(РежимЗаписиДокумента.Проведение);					
		Исключение
		    ОбщегоНазначенияКлиентСервер.СообщитьПользователю(ОписаниеОшибки());
			Продолжить;
		КонецПопытки;
		
		СтруткураПоиска = Новый Структура("Ссылка", Выборка.Ссылка);
		РезультатПоиска = ТаблицаДокументы.НайтиСтроки(СтруткураПоиска);
		
		Если РезультатПоиска.Количество() > 0 Тогда
			РезультатПоиска[0].ДокументИсправлен = 1;
		КонецЕсли;
		
	КонецЦикла;

КонецПроцедуры

// Создает документы передачи товаров между организациями по всем организациям
// на конец текущего дня
//
// Параметры:
//  ФормаОбработки - УправляемаяФорма - основная форма обработки.
//
Процедура СоздатьДокументыПередачиТоваров(ФормаОбработки) Экспорт
	
	ТекущаяДата 			= КонецДня(ТекущаяДата());
	УникальныйИдентификатор = Новый УникальныйИдентификатор("a56702e0-3ffc-11e0-9f98-001517115d85");
	Валюта      		    = Справочники.Валюты.ПолучитьСсылку(УникальныйИдентификатор);
	
	УникальныйИдентификатор = Новый УникальныйИдентификатор("8bdf84fb-404c-11e0-9f98-001517115d85");
	ВидЦены      		    = Справочники.ВидыЦен.ПолучитьСсылку(УникальныйИдентификатор);
	
	УстановитьПривилегированныйРежим(Истина);
		
	Запрос	= Новый Запрос(ПолучитьТекстЗапросаСоздатьДокументыПередачиТоваров());
	Запрос.УстановитьПараметр("ТекущаяДата"		,ТекущаяДата);
	Запрос.УстановитьПараметр("Валюта"			,Валюта);
	Запрос.УстановитьПараметр("ВидЦены"			,ВидЦены);
	
	РезультатЗапроса = Запрос.Выполнить();
	
	СоздатьДокументыПередачаТоваровМеждуОрганизациями(ФормаОбработки, РезультатЗапроса, Валюта, ВидЦены);
	
КонецПроцедуры

// Выводит не проведенные документы передачи товаров между организациями 
//
// Параметры:
//  ФормаОбработки - УправляемаяФорма - основная форма обработки.
//
Процедура ПоказатьНеПроведенныеДокументыПередачиТоваров(ФормаОбработки) Экспорт
	
	ТаблицаДокументов = ФормаОбработки.ТаблицаДокументыПередачи;
	
	Запрос	= Новый Запрос(ПолучитьТекстЗапросаНеПроведенныеДокументыПередачиТоваров());
	Запрос.УстановитьПараметр("ТаблицаДокументыПередачи", ТаблицаДокументов.Выгрузить());
    ТаблицаДокументов.Загрузить(Запрос.Выполнить().Выгрузить());
 
КонецПроцедуры



// Исправляет себестоимость в документах «Передачи между организациямиг»
// путем замены цены и перепроведения документов.
//
// Параметры:
//  ФормаОбработки - УправляемаяФорма - основная форма обработки.
//
Процедура ИсправитьСебестоимостьПередач(ФормаОбработки) Экспорт

	УстановитьПривилегированныйРежим(Истина);
	
	ТаблицаДокументы = ФормаОбработки.ТаблицаСебестоимостьПередач;
	Запрос 			= Новый Запрос;
	Запрос.Текст 	= ПолучитьТекстЗапросаИсправитьСебестоимостьПередач();
	
	Запрос.УстановитьПараметр("ТаблицаПередач"	,ТаблицаДокументы.Выгрузить());
	Запрос.УстановитьПараметр("ДатаНачала"		,ФормаОбработки.ДатаНачала);
	Запрос.УстановитьПараметр("ДатаОкончания"	,КонецДня(ФормаОбработки.ДатаОкончания));
	
	РезультатЗапроса	= Запрос.Выполнить();
	ВыборкаДокумент		= РезультатЗапроса.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);  	
	Пока ВыборкаДокумент.Следующий() Цикл
		
		ДокументОбъект	= ВыборкаДокумент.Ссылка.ПолучитьОбъект();
		ВыборкаТЧ		= ВыборкаДокумент.Выбрать();
		Пока ВыборкаТЧ.Следующий() Цикл 
			СтрокаТЧ = ДокументОбъект.Товары[ВыборкаТЧ.НомерСтроки-1];
			ЗаполнитьЗначенияСвойств(СтрокаТЧ,ВыборкаТЧ);
		КонецЦикла;
		ДокументОбъект.ЗаполнитьДопКолонкиВидовЗапасов();
		Попытка
			ДокументОбъект.Записать(РежимЗаписиДокумента.Проведение);					
		Исключение
			ОбщегоНазначенияКлиентСервер.СообщитьПользователю(ОписаниеОшибки());
			Продолжить;
		КонецПопытки;
		
		СтруткураПоиска = Новый Структура("Ссылка", ДокументОбъект.Ссылка);
		РезультатПоиска = ТаблицаДокументы.НайтиСтроки(СтруткураПоиска);
		Если РезультатПоиска.Количество() > 0 Тогда
			РезультатПоиска[0].ДокументИсправлен	= 1;
			РезультатПоиска[0].Флаг					= Истина;
		КонецЕсли;
		
	КонецЦикла;

КонецПроцедуры


#КонецОбласти

#Область СлужебныеПроцедурыИФункции

// Точки входа

// Строим список документов «Поступление товаров и услуг»
// по задаче http://r.ktc-ua.com/issues/2462.
// Номер запроса из процедуры «ПолучитьТекстОсновногоЗапроса» - 0.
// 
// Парамеры:
//  ФормаОбработки 	 - УправляемаяФорма - основная форма обработки.
//	Элементы 		 - ВсеЭлементыФормы - элементы формы обрабтки.
//  РезультатЗапроса - Массив - результаты выполнения пакета запросов из ПолучитьТекстОсновногоЗапроса 
//
Процедура ПостроитьСписокПоступленийТоваров(ФормаОбработки, Элементы, РезультатЗапроса)
    Таблица		= ФормаОбработки.ТаблицаДокументыПоступления;
	Закладка	= Элементы.ЗакладкаПроверитьПТиУ;
	ВывестиРезультатыОсновногоЗапросаНаФорму(РезультатЗапроса[1], Таблица, Закладка, "«Поступление товаров и услуг»");		
КонецПроцедуры

// Строим список документов «Внутреннее потребление товаров»
// по задаче http://r.ktc-ua.com/issues/3185.
// Номер запроса из процедуры «ПолучитьТекстОсновногоЗапроса» - 1.
// 
// Парамеры:
//  ФормаОбработки 	 - УправляемаяФорма - основная форма обработки.
//	Элементы 		 - ВсеЭлементыФормы - элементы формы обрабтки.
//  РезультатЗапроса - Массив - результаты выполнения пакета запросов из ПолучитьТекстОсновногоЗапроса
//
Процедура ПостроитьСписокВнутреннихПотребленийТоваров(ФормаОбработки, Элементы, РезультатЗапроса)
	Таблица 	= ФормаОбработки.ТаблицаДокументыВнутреннегоПотребления;
	Закладка    = Элементы.ЗакладкаПроверитьВПТ;
	ВывестиРезультатыОсновногоЗапросаНаФорму(РезультатЗапроса[3], Таблица, Закладка, "«Внутреннее потребление товаров»");
КонецПроцедуры

// Строим список фин. документов между организациями в которых не верная валюта взаеморасчетов
// Номер запроса из процедуры «ПолучитьТекстОсновногоЗапроса» - 1.
// 
// Парамеры:
//  ФормаОбработки 	 - УправляемаяФорма - основная форма обработки.
//	Элементы 		 - ВсеЭлементыФормы - элементы формы обрабтки.
//  РезультатЗапроса - Массив - результаты выполнения пакета запросов из ПолучитьТекстОсновногоЗапроса
//
Процедура ПостроитьСписокФинДокументовМеждуОрганизациями(ФормаОбработки, Элементы, РезультатЗапроса)
    Таблица 	= ФормаОбработки.ТаблицаФинДокументы;
	Закладка	= Элементы.ЗакладкаПроверитьФинансовыеДокументы;
	ВывестиРезультатыОсновногоЗапросаНаФорму(РезультатЗапроса[66], Таблица, Закладка, "Фин. документы между организациями");
КонецПроцедуры
 
// Список документов движения денежных средств
// по задаче http://r.ktc-ua.com/issues/2464.
// Номер запроса из процедуры «ПолучитьТекстОсновногоЗапроса» - 3.
// 
// Парамеры:
//  ФормаОбработки 	 - УправляемаяФорма - основная форма обработки.
//	Элементы 		 - ВсеЭлементыФормы - элементы формы обрабтки.
//  РезультатЗапроса - Массив - результаты выполнения пакета запросов из ПолучитьТекстОсновногоЗапроса
//
Процедура ПостроитьСписокДокументовДвиженияДенежныхСредств(ФормаОбработки, Элементы, РезультатЗапроса)
    Таблица		= ФормаОбработки.ТаблицаДокументыДвиженияДенежныхСредств;
	Закладка	= Элементы.ЗакладкаПроверитьСиПДС;
	ВывестиРезультатыОсновногоЗапросаНаФорму(РезультатЗапроса[5], Таблица, Закладка, "«Списание и поступления ДС»");
КонецПроцедуры

// Список документов которые сделали движение с неправильным курсом
// по задаче http://r.ktc-ua.com/issues/2454.
// Номер запроса из процедуры «ПолучитьТекстОсновногоЗапроса» - 25.
// 
// Парамеры:
//  ФормаОбработки 	 - УправляемаяФорма - основная форма обработки.
//	Элементы 		 - ВсеЭлементыФормы - элементы формы обрабтки.
//  РезультатЗапроса - Массив - результаты выполнения пакета запросов из ПолучитьТекстОсновногоЗапроса
//
Процедура ПостроитьСписокКурсовДвиженийДокументов(ФормаОбработки, Элементы, РезультатЗапроса)
    Таблица		= ФормаОбработки.ТаблицаКурсовДвиженийДокументов;
	Закладка	= Элементы.ЗакладкаПроверитьКурсы;
	ВывестиРезультатыОсновногоЗапросаНаФорму(РезультатЗапроса[49], Таблица, Закладка, "Проверка курсов документов");
	
	Выборка = РезультатЗапроса[50].Выбрать();
	Если Выборка.Следующий() Тогда
	 	ФормаОбработки.КурсоваяРазницаМалоценка = Выборка.КурсоваяРазница;
	КонецЕсли;
	
КонецПроцедуры

// Список документов которые сделали движение с неправильным курсом
// по задаче http://r.ktc-ua.com/issues/2454.
// Номер запроса из процедуры «ПолучитьТекстОсновногоЗапроса» - 25.
// 
// Парамеры:
//  ФормаОбработки 	 - УправляемаяФорма - основная форма обработки.
//	Элементы 		 - ВсеЭлементыФормы - элементы формы обрабтки.
//  РезультатЗапроса - Массив - результаты выполнения пакета запросов из ПолучитьТекстОсновногоЗапроса
//
Процедура ПостроитьСписокАвтосведениеВзаиморасчетов(ФормаОбработки, Элементы, РезультатЗапроса)
    Таблица		= ФормаОбработки.ТаблицаАвтосведениеВзаиморасчетов;
	Закладка	= Элементы.ЗакладкаАвтосведениеВзаиморасчетов;
	ВывестиРезультатыОсновногоЗапросаНаФорму(РезультатЗапроса[62], Таблица, Закладка, "Проверка автосведения взаиморасчетов");
КонецПроцедуры

// Список отрицательных остатков товаров организаций
// по задаче http://r.ktc-ua.com/issues/2453.
// 
// Парамеры:
//  ФормаОбработки 	 - УправляемаяФорма - основная форма обработки.
//	Элементы 		 - ВсеЭлементыФормы - элементы формы обрабтки.
//  РезультатЗапроса - Массив - результаты выполнения пакета запросов из ПолучитьТекстОсновногоЗапроса
//
Процедура ПостроитьСписокОтрицательныхОстатков(ФормаОбработки, Элементы, РезультатЗапроса)
	Таблица		= ФормаОбработки.ТаблицаОтрицательныеОстатки;
	Закладка	= Элементы.ЗакладкаПроверитьОО;
	ВывестиРезультатыОсновногоЗапросаНаФорму(РезультатЗапроса[51], Таблица, Закладка, "Проверка отрицательных остатков");
КонецПроцедуры

// Список номенклатуры из 100% рентабельностью
// по задаче http://r.ktc-ua.com/issues/2453.
// 
// Парамеры:
//  ФормаОбработки 	 - УправляемаяФорма - основная форма обработки.
//	Элементы 		 - ВсеЭлементыФормы - элементы формы обрабтки.
//  РезультатЗапроса - Массив - результаты выполнения пакета запросов из ПолучитьТекстОсновногоЗапроса
//
Процедура ПостроитьСписокДокументовРентабельность(ФормаОбработки, Элементы, РезультатЗапроса)
	Таблица 	= ФормаОбработки.ТаблицаРентабельность;
	Закладка    = Элементы.ЗакладкаПроверитьРентабельность;
	ВывестиРезультатыОсновногоЗапросаНаФорму(РезультатЗапроса[54], Таблица, Закладка, "Проверка на 100% рентабельность");
КонецПроцедуры

// Список номенклатуры в которой есть себестоимость но которой нету на складе
// и наоборот.
// По задаче http://r.ktc-ua.com/issues/2453.
// 
// Парамеры:
//  ФормаОбработки 	 - УправляемаяФорма - основная форма обработки.
//	Элементы 		 - ВсеЭлементыФормы - элементы формы обрабтки.
//  РезультатЗапроса - Массив - результаты выполнения пакета запросов из ПолучитьТекстОсновногоЗапроса
// 
Процедура ПостроитьСписокСебестоимости(ФормаОбработки, Элементы, РезультатЗапроса)
	Таблица 	= ФормаОбработки.ТаблицаСебестоимость;
	Закладка    = Элементы.ЗакладкаПроверитьСебестоимость;
	ВывестиРезультатыОсновногоЗапросаНаФорму(РезультатЗапроса[60], Таблица, Закладка, "Проверка себестоимости");
КонецПроцедуры

// Список документов РКО и ПКО с разной суммой
// по задаче http://r.ktc-ua.com/issues/3201#change-13432.
// 
// Парамеры:
//  ФормаОбработки 	 - УправляемаяФорма - основная форма обработки.
//	Элементы 		 - ВсеЭлементыФормы - элементы формы обрабтки.
//
Процедура ПостроитьОтчетРазличныеСуммыДокументовРКОиПКО(ФормаОбработки, Элементы)
	
	ФормаОбработки.Результат.Очистить();
 	СхемаКомпоновкиДанныхДетализация	= ПолучитьМакет("МакетРКО");    
	Настройки 							= СхемаКомпоновкиДанныхДетализация.НастройкиПоУмолчанию;
	
	СхемаКомпоновкиДанныхДетализация.Параметры.ДатаНачала.Значение 		= ФормаОбработки.ДатаНачала;
	СхемаКомпоновкиДанныхДетализация.Параметры.ДатаОкончания.Значение	= КонецДня(ФормаОбработки.ДатаОкончания); 

	КомпановщикМакета	= Новый КомпоновщикМакетаКомпоновкиДанных;
	ДанныеРасшифровки	= Новый ДанныеРасшифровкиКомпоновкиДанных;

	МакетКомпановки 	= КомпановщикМакета.Выполнить(СхемаКомпоновкиДанныхДетализация, Настройки);

	ПроцессорКомпоновкиДанных = Новый ПроцессорКомпоновкиДанных;
	ПроцессорКомпоновкиДанных.Инициализировать(МакетКомпановки, , ДанныеРасшифровки);

	ПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВТабличныйДокумент;
	ПроцессорВывода.УстановитьДокумент(ФормаОбработки.Результат);
	ПроцессорВывода.Вывести(ПроцессорКомпоновкиДанных);
	
	ФормаОбработки.Результат.Показать();
	
КонецПроцедуры

// Список документов для товаров на наличие услуг
// по задаче http://r.ktc-ua.com/issues/2466.
// 
// Парамеры:
//  ФормаОбработки 	 - УправляемаяФорма - основная форма обработки.
//	Элементы 		 - ВсеЭлементыФормы - элементы формы обрабтки.
//
Процедура ПостроитьОтчетНаличиеУслугВДокументахДляТоваров(ФормаОбработки, Элементы)
	
	РезультатПроверкаДокументов = ФормаОбработки.РезультатПроверкаДокументов;
	
	РезультатПроверкаДокументов.Очистить();
	
 	СхемаКомпоновкиДанныхДетализация	= ПолучитьМакет("НаличиеУслугВДокументахДляТоваров");    
	Настройки 							= СхемаКомпоновкиДанныхДетализация.НастройкиПоУмолчанию;
	
	СхемаКомпоновкиДанныхДетализация.Параметры.ДатаНачала.Значение 		= Новый Граница(ФормаОбработки.ДатаНачала, ВидГраницы.Включая);
	СхемаКомпоновкиДанныхДетализация.Параметры.ДатаОкончания.Значение	= Новый Граница(ФормаОбработки.ДатаОкончания, ВидГраницы.Включая);  

	КомпановщикМакета	= Новый КомпоновщикМакетаКомпоновкиДанных;
	ДанныеРасшифровки	= Новый ДанныеРасшифровкиКомпоновкиДанных;

	МакетКомпановки 	= КомпановщикМакета.Выполнить(СхемаКомпоновкиДанныхДетализация, Настройки, ДанныеРасшифровки);

	ПроцессорКомпоновкиДанных = Новый ПроцессорКомпоновкиДанных;
	ПроцессорКомпоновкиДанных.Инициализировать(МакетКомпановки, , ДанныеРасшифровки);

	ПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВТабличныйДокумент;
	ПроцессорВывода.УстановитьДокумент(РезультатПроверкаДокументов);
	ПроцессорВывода.Вывести(ПроцессорКомпоновкиДанных);
	
	ФормаОбработки.ДанныеРасшифровки = ПоместитьВоВременноеХранилище(ДанныеРасшифровки, ФормаОбработки.УникальныйИдентификатор);
	
	Если РезультатПроверкаДокументов.ВысотаТаблицы > 1 Тогда
		ФормаОбработки.Элементы.ЗакладкаПроверкаНаличиеУслугВДокументахДляТоваров.ЦветФона = Новый Цвет(255, 0, 0);
	КонецЕсли;
	
КонецПроцедуры

// Список документов с неправильным периодом возникновения
// по задаче http://r.ktc-ua.com/issues/2457. 
// 
// Парамеры:
//  ФормаОбработки 	 - УправляемаяФорма - основная форма обработки.
//	Элементы 		 - ВсеЭлементыФормы - элементы формы обрабтки.
//
Процедура ПостроитьСписокДокументовПериодВозникновения(ФормаОбработки, Элементы, РезультатЗапроса)
	Таблица		= ФормаОбработки.ТаблицаПериодыВозникновения;
	Закладка	= Элементы.ЗакладкаПериодВозникновения;
	ВывестиРезультатыОсновногоЗапросаНаФорму(РезультатЗапроса[67], Таблица, Закладка, "Периоды возникновения");
КонецПроцедуры

// Список документов «Поступление услуг и прочих активов» где
// значение реквизита «Операция» отличаетса от значения «Поступление услуг». 
// 
// Парамеры:
//  ФормаОбработки 	 - УправляемаяФорма - основная форма обработки.
//	Элементы 		 - ВсеЭлементыФормы - элементы формы обрабтки.
//
Процедура ПостроитьСписокДокументовПУиПА(ФормаОбработки, Элементы, РезультатЗапроса)
	Таблица		= ФормаОбработки.ТаблицаПоступленийУслугИПрочихАктивов;
	Закладка	= Элементы.ЗакладкаПроверитьПУиПА;
	ВывестиРезультатыОсновногоЗапросаНаФорму(РезультатЗапроса[68], Таблица, Закладка, "«Поступление услуг и прочих активов»");
КонецПроцедуры

// Список документов "Передачи между организациями" с неправильной себестоимостю 
// 
// Парамеры:
//  ФормаОбработки 	 - УправляемаяФорма - основная форма обработки.
//	Элементы 		 - ВсеЭлементыФормы - элементы формы обрабтки.
//
Процедура ПостроитьСписокПроверенныхДокументовПередач(ФормаОбработки, Элементы, РезультатЗапроса)
	Таблица		= ФормаОбработки.ТаблицаСебестоимостьПередач;
	Закладка	= Элементы.ЗакладкаСебестоимостьПередачи;
	ВывестиРезультатыОсновногоЗапросаНаФорму(РезультатЗапроса[70], Таблица, Закладка, "Себестоимость «Передачи между организациями»");
КонецПроцедуры

// Список документов "Передачи между организациями" с неправильной себестоимостю 
// 
// Парамеры:
//  ФормаОбработки 	 - УправляемаяФорма - основная форма обработки.
//	Элементы 		 - ВсеЭлементыФормы - элементы формы обрабтки.
//
Процедура ПостроитьСписокДвиженияРасчетыСПоставщиками(ФормаОбработки, Элементы, РезультатЗапроса)
	Таблица		= ФормаОбработки.ТаблицаДвиженияРасчетыСПоставщиками;
	Закладка	= Элементы.ЗакладкаДвиженияРасчетыСПоставщиками;
	ВывестиРезультатыОсновногоЗапросаНаФорму(РезультатЗапроса[71], Таблица, Закладка, "Закладка движения «РасчетыСПоставщиками»");
КонецПроцедуры



  



// Универсальная процедура обработки результата основного запроса.
// Сделана для уменьшения количества кода обработки
// 
// Парамеры:
//	РезультатЗапроса 	- РезультатЗапроса 		- результат запроса, который нужно обработать в процедуре.
//	ТаблицаВывода	    - ДанныеФормыКоллекция  - таблица, в которую выгружаем результирующий запрос.
//	ЭлементЗакладка		- КнопкаФормы			- кнопка на которой нужно изменить заголовок в соответствии с результатом запроса.
//
Процедура ВывестиРезультатыОсновногоЗапросаНаФорму(РезультатЗапроса, ТаблицаВывода, ЭлементЗакладка, ТекстЗаголовкаЗакладки)

	Таблица = РезультатЗапроса.Выгрузить();
	ТаблицаВывода.Загрузить(Таблица);
	
	ТекстЗаголовка 	= НСтр("ru='%1 %2'", ОбщегоНазначенияКлиентСервер.КодОсновногоЯзыка());
	ТекстЗаголовка 	= СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(ТекстЗаголовка, ТекстЗаголовкаЗакладки, "%1");
	Количество		= Таблица.Количество();
	
	Если Количество = 0 Тогда
		ТекстЗаголовка = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(ТекстЗаголовка, "");
		ЭлементЗакладка.ЦветТекста = Новый Цвет(89, 67 , 4);
	Иначе
		ТекстЗаголовка = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(ТекстЗаголовка, "(" + Количество + ")");
		ЭлементЗакладка.ЦветТекста = Новый Цвет(255, 0 , 0);
	КонецЕсли;
	
	ЭлементЗакладка.Заголовок = ТекстЗаголовка;

КонецПроцедуры
 
Процедура ДобавитьВДинамикуОборотныхСредств(СоотОрганизаций, Дерево, Направление, Наименование, РезультатЗапроса, НомерНачалаПериода, НомерОкончанияПериода)
	
	Соответствие = Новый Соответствие;
	
	Выборка = РезультатЗапроса[НомерНачалаПериода].Выбрать();
	Пока Выборка.Следующий() Цикл
		СтруктураЗаписи = СоотОрганизаций[Выборка.Организация];
		Если СтруктураЗаписи = Неопределено Тогда
			
			СтрокаОрганизация = Дерево.Строки.Добавить();
			СтрокаОрганизация.Организация = Выборка.Организация;
			СтрокаОрганизация.Наименование = Строка(Выборка.Организация);
				СтрокаАктивы = СтрокаОрганизация.Строки.Добавить();
				СтрокаАктивы.Наименование = "Активы";			
				СтрокаПассивы = СтрокаОрганизация.Строки.Добавить();
				СтрокаПассивы.Наименование = "Пассивы"; 
			
			СтруктураЗаписи = Новый Структура("Организация, Активы, Пассивы", СтрокаОрганизация, СтрокаАктивы, СтрокаПассивы);
			
			СоотОрганизаций[Выборка.Организация] = СтруктураЗаписи;
			
		КонецЕсли;
		
		СтрокаЗаписи = СтруктураЗаписи[Направление];
		ЗаписьЛист = СтрокаЗаписи.Строки.Добавить();
		ЗаписьЛист.Наименование = Наименование;
		ЗаписьЛист.НачальноеЗначение = Выборка.СуммаОстаток;
		
		Соответствие[Выборка.Организация] = ЗаписьЛист;
		
		Если Наименование = "Дебиторская задолженность" Тогда
			НоваяСтрока = СтрокаЗаписи.Строки.Добавить();
			НоваяСтрока.Наименование = "Дебиторская задолженность (просроченная)";	
		КонецЕсли; 
		
	КонецЦикла; 
	
	Выборка = РезультатЗапроса[НомерОкончанияПериода].Выбрать();
	Пока Выборка.Следующий() Цикл
		ЗаписьЛист = Соответствие[Выборка.Организация];
		Если ЗаписьЛист = Неопределено Тогда
			СтруктураЗаписи = СоотОрганизаций[Выборка.Организация];
			Если СтруктураЗаписи = Неопределено Тогда
				
				СтрокаОрганизация = Дерево.Строки.Добавить();
				СтрокаОрганизация.Организация = Выборка.Организация;
				СтрокаОрганизация.Наименование = Строка(Выборка.Организация);
					СтрокаАктивы = СтрокаОрганизация.Строки.Добавить();
					СтрокаАктивы.Наименование = "Активы";			
					СтрокаПассивы = СтрокаОрганизация.Строки.Добавить();
					СтрокаПассивы.Наименование = "Пассивы"; 
				
				СтруктураЗаписи = Новый Структура("Организация, Активы, Пассивы", СтрокаОрганизация, СтрокаАктивы, СтрокаПассивы);
				
				СоотОрганизаций[Выборка.Организация] = СтруктураЗаписи;
				
			КонецЕсли;
			СтрокаЗаписи = СтруктураЗаписи[Направление];
			ЗаписьЛист = СтрокаЗаписи.Строки.Добавить();
			ЗаписьЛист.Наименование = Наименование;
			ЗаписьЛист.НачальноеЗначение = Выборка.СуммаОстаток;
			
			Соответствие[Выборка.Организация] = ЗаписьЛист;
		Иначе
			ЗаписьЛист.Значение = Выборка.СуммаОстаток;
			ЗаписьЛист.Дельта = ЗаписьЛист.Значение - ЗаписьЛист.НачальноеЗначение;
		КонецЕсли;
	КонецЦикла;
	
КонецПроцедуры



// Программное формирование документов

// Создание документов «Передача товаров между организациями»
// по задаче http://r.ktc-ua.com/issues/2472.
Процедура СоздатьДокументыПередачаТоваровМеждуОрганизациями(ФормаОбработки, РезультатЗапроса, Валюта, ВидЦены)
	
	Комментарий		= "Автоматически созданный обработкой сведения баланса.";			
	ТекущаяДата		= КонецДня(ТекущаяДата())-3;	
	ВыборкаСклады	= РезультатЗапроса.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
	Пока ВыборкаСклады.Следующий() Цикл
		ВыборкаПолучатель	 	= ВыборкаСклады.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
		Пока ВыборкаПолучатель.Следующий() Цикл
			ВыборкаОтправитель						= ВыборкаПолучатель.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
			Пока ВыборкаОтправитель.Следующий() Цикл
				ДокументПередачи						= Документы.ПередачаТоваровМеждуОрганизациями.СоздатьДокумент();
				ДокументПередачи.Дата					= ТекущаяДата;
				ДокументПередачи.ДатаПлатежа			= ТекущаяДата;
				ДокументПередачи.Валюта					= Валюта;
				ДокументПередачи.ВалютаВзаиморасчетов	= Валюта;
				ДокументПередачи.Заполнить(ВыборкаОтправитель);
                ДокументПередачи.ОрганизацияПолучатель	= ВыборкаПолучатель.ОрганизацияПолучатель;
				ДокументПередачи.Организация			= ВыборкаОтправитель.Организация;
				ДокументПередачи.Склад					= ВыборкаСклады.Склад;
				ДокументПередачи.НалогообложениеНДС		= ПредопределенноеЗначение("Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС");			 
				Выборка = ВыборкаОтправитель.Выбрать();
				Пока Выборка.Следующий() Цикл 
					СтрокаТоварыТЧ 						= ДокументПередачи.Товары.Добавить();
					ЗаполнитьЗначенияСвойств(СтрокаТоварыТЧ, Выборка); 
					СтрокаТоварыТЧ.Количество 			= СтрокаТоварыТЧ.КоличествоУпаковок / Выборка.Коэффициент;
					СтрокаТоварыТЧ.СтавкаНДС			= Перечисления.СтавкиНДС.БезНДС;
					СтрокаТоварыТЧ.Сумма 				= СтрокаТоварыТЧ.КоличествоУпаковок * СтрокаТоварыТЧ.Цена;
					СтрокаТоварыТЧ.СуммаСНДС            = СтрокаТоварыТЧ.Сумма;
				КонецЦикла;
				ДокументПередачи.Комментарий			= Комментарий;
				
				Попытка
					ДокументПередачи.Записать(РежимЗаписиДокумента.Проведение);
				Исключение
					ДокументПередачи.Записать(РежимЗаписиДокумента.Запись);
				КонецПопытки;
				ТаблицаДокументыПередачиЗаполнить(ФормаОбработки, ДокументПередачи);
			 КонецЦикла;
		КонецЦикла;
	КонецЦикла;
	
КонецПроцедуры

//Заполняет таблицу значений "ТаблицаДокументыПередачи"
Процедура ТаблицаДокументыПередачиЗаполнить(ФормаОбработки, Документ)
	
	ТаблицаДокументы 						= ФормаОбработки.ТаблицаДокументыПередачи;
	СтрокаТаблицы 							= ТаблицаДокументы.Добавить();
	Проведен								= Документ.Проведен;
	СтрокаТаблицы.Ссылка					= Документ.Ссылка;
	СтрокаТаблицы.ВалютаПредставления		= Документ.Валюта.Наименование;
	СтрокаТаблицы.СуммаДокумента			= Документ.СуммаДокумента;
	СтрокаТаблицы.Представление				= Строка(Документ.Ссылка);
	СтрокаТаблицы.ДокументПроведен			= Проведен;
	СтрокаТаблицы.ОрганизацияПредставление	= Документ.Организация.Наименование; 
	СтрокаТаблицы.ПолучательПредставление	= Документ.ОрганизацияПолучатель.Наименование;
	СтрокаТаблицы.ИндексКартинки            = Проведен;
	
КонецПроцедуры






// Тексты запросов

// Текст запроса который заполнет все формы обраотки
// на вкладке «Исправления».
//
// Возвращаемое значение:
//  Строка - текст запроса.
//
Функция ПолучитьТекстОсновногоЗапроса()

	ТекстЗапроса = "
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 0. Получаем список поступлений по задаче http://r.ktc-ua.com/issues/2462 
		|ВЫБРАТЬ
		|	ВЫРАЗИТЬ(Регистратор КАК Документ.ПоступлениеТоваровУслуг).Дата		        	КАК Дата,
		|	ВЫРАЗИТЬ(Регистратор КАК Документ.ПоступлениеТоваровУслуг) 						КАК Ссылка,
		|	ВЫРАЗИТЬ(Регистратор КАК Документ.ПоступлениеТоваровУслуг).Представление 		КАК Представление,
		|	Расчеты.Сумма																	КАК СуммаВРегистре,
		|	ВЫРАЗИТЬ(Регистратор КАК Документ.ПоступлениеТоваровУслуг).СуммаВзаиморасчетов 	КАК СуммаВзаиморасчетов,
		|	ПРЕДСТАВЛЕНИЕ(РегистрАналитика.Организация)										КАК Организация
		|ПОМЕСТИТЬ КешПоступленийЗаПериод
		|ИЗ
		|	РегистрНакопления.РасчетыСПоставщиками КАК Расчеты
		|		
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаПоПартнерам КАК РегистрАналитика
		|ПО Расчеты.АналитикаУчетаПоПартнерам = РегистрАналитика.КлючАналитики
        |
		|ГДЕ
		|	Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
		|И 	ВЫРАЗИТЬ(Регистратор КАК Документ.ПоступлениеТоваровУслуг).Дата >= &ДатаНачала
		|И 	ВЫРАЗИТЬ(Регистратор КАК Документ.ПоступлениеТоваровУслуг).Дата <= &ДатаОкончания
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Ссылка				
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//1. http://r.ktc-ua.com/issues/2462
		|ВЫБРАТЬ
		|	КешПоступленийЗаПериод.Дата				КАК Дата,
		|	КешПоступленийЗаПериод.Ссылка			КАК Ссылка,
		|	КешПоступленийЗаПериод.Представление 	КАК Представление,
		|	КешПоступленийЗаПериод.Организация		КАК ОрганизацияПредставление,
		|	1										КАК ИндексКартинки,
		|	0										КАК ДокументИсправлен
		|ИЗ
		|	КешПоступленийЗаПериод КАК КешПоступленийЗаПериод
		|
		|СГРУППИРОВАТЬ ПО
		|	КешПоступленийЗаПериод.Дата,
		|	КешПоступленийЗаПериод.Ссылка,
		|	КешПоступленийЗаПериод.Представление,
		|	КешПоступленийЗаПериод.Организация,
		|	КешПоступленийЗаПериод.СуммаВзаиморасчетов
		|	
		|ИМЕЮЩИЕ Сумма(IsNull(КешПоступленийЗаПериод.СуммаВРегистре, 0)) <> КешПоступленийЗаПериод.СуммаВзаиморасчетов
		|	
		|УПОРЯДОЧИТЬ ПО
		|	КешПоступленийЗаПериод.Дата,
		|	КешПоступленийЗаПериод.Организация
		|
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//2. http://r.ktc-ua.com/issues/2462
		|УНИЧТОЖИТЬ КешПоступленийЗаПериод;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 3. Получаем список внутренних потреблений товаров по задаче http://r.ktc-ua.com/issues/3185 
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	Период 																			КАК Дата,
		|	Регистратор 																	КАК Ссылка,
		|	ВЫРАЗИТЬ(Регистратор КАК Документ.ВнутреннееПотреблениеТоваров).Представление 	КАК Представление,
		|	ВЫРАЗИТЬ(Регистратор КАК Документ.ВнутреннееПотреблениеТоваров).Организация 	КАК ОрганизацияПредставление,
		|	1																				КАК ИндексКартинки,
		|	0																				КАК ДокументИсправлен
		|ИЗ
		|	РегистрНакопления.СебестоимостьТоваров 
		|ГДЕ
		|	Период >= &ДатаНачала
		|И 	Период <= &ДатаОкончания
		|И 	Регистратор ССЫЛКА Документ.ВнутреннееПотреблениеТоваров
		|И (АналитикаРасходов = НЕОПРЕДЕЛЕНО ИЛИ СтатьяРасходовСписания = НЕОПРЕДЕЛЕНО)
		|
		|ОБЪЕДИНИТЬ
		|
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	Период,
		|	Регистратор,
		|	ВЫРАЗИТЬ(Регистратор КАК Документ.ВнутреннееПотреблениеТоваров).Представление,
		|	ВЫРАЗИТЬ(Регистратор КАК Документ.ВнутреннееПотреблениеТоваров).Организация,
		|	1,
		|	0
		|ИЗ
		|	РегистрНакопления.ТоварыОрганизаций
		|ГДЕ
		|	Период >= &ДатаНачала
		|И 	Период <= &ДатаОкончания
		|И	Регистратор ССЫЛКА Документ.ВнутреннееПотреблениеТоваров
		|И 	(АналитикаРасходов = НЕОПРЕДЕЛЕНО ИЛИ СтатьяРасходов = НЕОПРЕДЕЛЕНО)
		|
		|УПОРЯДОЧИТЬ ПО
		|	Дата
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//4. Получаем список документов движения денежных средст из ошибками http://r.ktc-ua.com/issues/2464
		|ВЫБРАТЬ
		|	Период 										КАК Дата,
		|	Регистратор									КАК Ссылка,
		|	ВалютаПлатежа 								КАК Валюта,
		|	СуммаОплатыВВалютеПлатежа					КАК Сумма,
		|	ВалютаВзаиморасчетов 						КАК ВалютаВзаиморасчетов,
		|	СуммаОплатыВВалютеВзаиморасчетов			КАК СуммаВзаиморасчетов,
		|	Партнер 									КАК Партнер,
		|	Организация 								КАК Организация
		|ПОМЕСТИТЬ КешОшибокВзаиморасчетов
		|ИЗ
		|	РегистрНакопления.ДвиженияДенежныеСредстваКонтрагент
		|ГДЕ
		|	Период >= &ДатаНачала
		|	И Период < &ДатаОкончания
		|	И Регистратор ССЫЛКА Документ.СписаниеБезналичныхДенежныхСредств
		|	И НЕ ОтложенноеПроведение
		|	И ВалютаВзаиморасчетов = ВалютаПлатежа
		|	И СуммаОплатыВВалютеПлатежа <> СуммаОплатыВВалютеВзаиморасчетов
		|	
		|ОБЪЕДИНИТЬ ВСЕ

		|ВЫБРАТЬ
		|	Период 										КАК Дата,
		|	Регистратор									КАК Ссылка,
		|	ВалютаПлатежа 								КАК Валюта,
		|	СуммаОплатыВВалютеПлатежа					КАК Сумма,
		|	ВалютаВзаиморасчетов 						КАК ВалютаВзаиморасчетов,
		|	СуммаОплатыВВалютеВзаиморасчетов			КАК СуммаВзаиморасчетов,
		|	Партнер 									КАК Партнер,
		|	Организация 								КАК Организация
		|ИЗ
		|	РегистрНакопления.ДвиженияДенежныеСредстваКонтрагент
		|ГДЕ
		|	Период >= &ДатаНачала
		|	И Период < &ДатаОкончания
		|	И Регистратор ССЫЛКА Документ.СписаниеБезналичныхДенежныхСредств
		|	И НЕ ОтложенноеПроведение
		|	И ВалютаВзаиморасчетов <> ВалютаПлатежа
		|	И СуммаОплатыВВалютеПлатежа = СуммаОплатыВВалютеВзаиморасчетов
		|	
		|ОБЪЕДИНИТЬ ВСЕ	
		|	
		|ВЫБРАТЬ
		|	Период 										КАК Дата,
		|	Регистратор									КАК Ссылка,
		|	ВалютаПлатежа 								КАК Валюта,
		|	СуммаОплатыВВалютеПлатежа					КАК Сумма,
		|	ВалютаВзаиморасчетов 						КАК ВалютаВзаиморасчетов,
		|	СуммаОплатыВВалютеВзаиморасчетов			КАК СуммаВзаиморасчетов,
		|	Партнер 									КАК Партнер,
		|	Организация 								КАК Организация
		|ИЗ
		|	РегистрНакопления.ДвиженияДенежныеСредстваКонтрагент
		|ГДЕ
		|	Период >= &ДатаНачала
		|	И Период < &ДатаОкончания
		|	И Регистратор ССЫЛКА Документ.ПоступлениеБезналичныхДенежныхСредств
		|	И НЕ ОтложенноеПроведение
		|	И ВалютаВзаиморасчетов = ВалютаПлатежа
		|	И СуммаОплатыВВалютеПлатежа <> СуммаОплатыВВалютеВзаиморасчетов
		|	
		|ОБЪЕДИНИТЬ ВСЕ

		|ВЫБРАТЬ
		|	Период 										КАК Дата,
		|	Регистратор									КАК Ссылка,
		|	ВалютаПлатежа 								КАК Валюта,
		|	СуммаОплатыВВалютеПлатежа					КАК Сумма,
		|	ВалютаВзаиморасчетов 						КАК ВалютаВзаиморасчетов,
		|	СуммаОплатыВВалютеВзаиморасчетов			КАК СуммаВзаиморасчетов,
		|	Партнер 									КАК Партнер,
		|	Организация 								КАК Организация
		|ИЗ
		|	РегистрНакопления.ДвиженияДенежныеСредстваКонтрагент
		|ГДЕ
		|	Период >= &ДатаНачала
		|	И Период < &ДатаОкончания
		|	И Регистратор ССЫЛКА Документ.ПоступлениеБезналичныхДенежныхСредств
		|	И НЕ ОтложенноеПроведение
		|	И ВалютаВзаиморасчетов <> ВалютаПлатежа
		|	И СуммаОплатыВВалютеПлатежа = СуммаОплатыВВалютеВзаиморасчетов
		|	
		|ОБЪЕДИНИТЬ ВСЕ	
		|	
		|ВЫБРАТЬ
		|	Период 										КАК Дата,
		|	Регистратор									КАК Ссылка,
		|	ВалютаПлатежа 								КАК Валюта,
		|	СуммаОплатыВВалютеПлатежа					КАК Сумма,
		|	ВалютаВзаиморасчетов 						КАК ВалютаВзаиморасчетов,
		|	СуммаОплатыВВалютеВзаиморасчетов			КАК СуммаВзаиморасчетов,
		|	Партнер 									КАК Партнер,
		|	Организация 								КАК Организация
		|ИЗ
		|	РегистрНакопления.ДвиженияДенежныеСредстваКонтрагент
		|ГДЕ
		|	Период >= &ДатаНачала
		|	И Период < &ДатаОкончания
		|	И Регистратор ССЫЛКА Документ.АвансовыйОтчет
		|	И НЕ ОтложенноеПроведение
		|	И ВалютаВзаиморасчетов = ВалютаПлатежа
		|	И СуммаОплатыВВалютеПлатежа <> СуммаОплатыВВалютеВзаиморасчетов
		|	
		|ОБЪЕДИНИТЬ ВСЕ

		|ВЫБРАТЬ
		|	Период 										КАК Дата,
		|	Регистратор									КАК Ссылка,
		|	ВалютаПлатежа 								КАК Валюта,
		|	СуммаОплатыВВалютеПлатежа					КАК Сумма,
		|	ВалютаВзаиморасчетов 						КАК ВалютаВзаиморасчетов,
		|	СуммаОплатыВВалютеВзаиморасчетов			КАК СуммаВзаиморасчетов,
		|	Партнер 									КАК Партнер,
		|	Организация 								КАК Организация
		|ИЗ
		|	РегистрНакопления.ДвиженияДенежныеСредстваКонтрагент
		|ГДЕ
		|	Период >= &ДатаНачала
		|	И Период < &ДатаОкончания
		|	И Регистратор ССЫЛКА Документ.АвансовыйОтчет
		|	И НЕ ОтложенноеПроведение
		|	И ВалютаВзаиморасчетов <> ВалютаПлатежа
		|	И СуммаОплатыВВалютеПлатежа = СуммаОплатыВВалютеВзаиморасчетов
		|	
		|ОБЪЕДИНИТЬ ВСЕ	
		|	
		|ВЫБРАТЬ
		|	Период 										КАК Дата,
		|	Регистратор									КАК Ссылка,
		|	ВалютаПлатежа 								КАК Валюта,
		|	СуммаОплатыВВалютеПлатежа					КАК Сумма,
		|	ВалютаВзаиморасчетов 						КАК ВалютаВзаиморасчетов,
		|	СуммаОплатыВВалютеВзаиморасчетов			КАК СуммаВзаиморасчетов,
		|	Партнер 									КАК Партнер,
		|	Организация 								КАК Организация
		|ИЗ
		|	РегистрНакопления.ДвиженияДенежныеСредстваКонтрагент
		|ГДЕ
		|	Период >= &ДатаНачала
		|	И Период < &ДатаОкончания
		|	И Регистратор ССЫЛКА Документ.РасходныйКассовыйОрдер
		|	И НЕ ОтложенноеПроведение
		|	И ВалютаВзаиморасчетов = ВалютаПлатежа
		|	И СуммаОплатыВВалютеПлатежа <> СуммаОплатыВВалютеВзаиморасчетов
		|	
		|ОБЪЕДИНИТЬ ВСЕ

		|ВЫБРАТЬ
		|	Период 										КАК Дата,
		|	Регистратор									КАК Ссылка,
		|	ВалютаПлатежа 								КАК Валюта,
		|	СуммаОплатыВВалютеПлатежа					КАК Сумма,
		|	ВалютаВзаиморасчетов 						КАК ВалютаВзаиморасчетов,
		|	СуммаОплатыВВалютеВзаиморасчетов			КАК СуммаВзаиморасчетов,
		|	Партнер 									КАК Партнер,
		|	Организация 								КАК Организация
		|ИЗ
		|	РегистрНакопления.ДвиженияДенежныеСредстваКонтрагент
		|ГДЕ
		|	Период >= &ДатаНачала
		|	И Период < &ДатаОкончания
		|	И Регистратор ССЫЛКА Документ.РасходныйКассовыйОрдер
		|	И НЕ ОтложенноеПроведение
		|	И ВалютаВзаиморасчетов <> ВалютаПлатежа
		|	И СуммаОплатыВВалютеПлатежа = СуммаОплатыВВалютеВзаиморасчетов
		|	
		|ОБЪЕДИНИТЬ ВСЕ	
		|	
		|ВЫБРАТЬ
		|	Период 										КАК Дата,
		|	Регистратор									КАК Ссылка,
		|	ВалютаПлатежа 								КАК Валюта,
		|	СуммаОплатыВВалютеПлатежа					КАК Сумма,
		|	ВалютаВзаиморасчетов 						КАК ВалютаВзаиморасчетов,
		|	СуммаОплатыВВалютеВзаиморасчетов			КАК СуммаВзаиморасчетов,
		|	Партнер 									КАК Партнер,
		|	Организация 								КАК Организация
		|ИЗ
		|	РегистрНакопления.ДвиженияДенежныеСредстваКонтрагент
		|ГДЕ
		|	Период >= &ДатаНачала
		|	И Период < &ДатаОкончания
		|	И Регистратор ССЫЛКА Документ.ПриходныйКассовыйОрдер
		|	И НЕ ОтложенноеПроведение
		|	И ВалютаВзаиморасчетов = ВалютаПлатежа
		|	И СуммаОплатыВВалютеПлатежа <> СуммаОплатыВВалютеВзаиморасчетов
		|	
		|ОБЪЕДИНИТЬ ВСЕ

		|ВЫБРАТЬ
		|	Период 										КАК Дата,
		|	Регистратор									КАК Ссылка,
		|	ВалютаПлатежа 								КАК Валюта,
		|	СуммаОплатыВВалютеПлатежа					КАК Сумма,
		|	ВалютаВзаиморасчетов 						КАК ВалютаВзаиморасчетов,
		|	СуммаОплатыВВалютеВзаиморасчетов			КАК СуммаВзаиморасчетов,
		|	Партнер 									КАК Партнер,
		|	Организация 								КАК Организация
		|ИЗ
		|	РегистрНакопления.ДвиженияДенежныеСредстваКонтрагент
		|ГДЕ
		|	Период >= &ДатаНачала
		|	И Период < &ДатаОкончания
		|	И Регистратор ССЫЛКА Документ.ПриходныйКассовыйОрдер
		|	И НЕ ОтложенноеПроведение
		|	И ВалютаВзаиморасчетов <> ВалютаПлатежа
		|	И СуммаОплатыВВалютеПлатежа = СуммаОплатыВВалютеВзаиморасчетов
		|;
		|
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 5.
		|ВЫБРАТЬ
		|	Дата 					КАК Дата,
		|	Ссылка					КАК Ссылка,
		|	ВЫБОР
		|		КОГДА Ссылка ССЫЛКА Документ.СписаниеБезналичныхДенежныхСредств
		|			ТОГДА ВЫРАЗИТЬ(Ссылка КАК Документ.СписаниеБезналичныхДенежныхСредств).Представление
		|		КОГДА Ссылка ССЫЛКА Документ.ПоступлениеБезналичныхДенежныхСредств
		|			ТОГДА ВЫРАЗИТЬ(Ссылка КАК Документ.ПоступлениеБезналичныхДенежныхСредств).Представление
		|		КОГДА Ссылка ССЫЛКА Документ.АвансовыйОтчет
		|			ТОГДА ВЫРАЗИТЬ(Ссылка КАК Документ.АвансовыйОтчет).Представление
		|		КОГДА Ссылка ССЫЛКА Документ.РасходныйКассовыйОрдер
		|			ТОГДА ВЫРАЗИТЬ(Ссылка КАК Документ.РасходныйКассовыйОрдер).Представление
		|		КОГДА Ссылка ССЫЛКА Документ.ПриходныйКассовыйОрдер
		|			ТОГДА ВЫРАЗИТЬ(Ссылка КАК Документ.ПриходныйКассовыйОрдер).Представление
		|	КОНЕЦ КАК Предсталение,
		|	Валюта	 					КАК Валюта,
		|	Сумма						КАК Сумма,
		|	ВалютаВзаиморасчетов 		КАК ВалютаВзаиморасчетов,
		|	СуммаВзаиморасчетов			КАК СуммаВзаиморасчетов,
		|	Партнер 					КАК Партнер,
		|	Партнер.Представление       КАК ПартнерПредставление,
		|	Организация 				КАК Организация, 
		|	Организация.Представление	КАК ОрганизацияПредставление,
		|	1							КАК ИндексКартинки
		|ИЗ
		|	КешОшибокВзаиморасчетов
		|
		|УПОРЯДОЧИТЬ ПО
		|	Дата ВОЗР,
		|	Организация.Представление ВОЗР
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 6.
		|УНИЧТОЖИТЬ КешОшибокВзаиморасчетов;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 7. Наростающие итоги по курсам валют
		|ВЫБРАТЬ
		|	ВЫРАЗИТЬ(КурсыВалют.Курс/КурсыВалют.Кратность КАК ЧИСЛО(15, 4)) КАК Курс,
		|  	КурсыВалют.Валюта КАК Валюта,
		|  	КурсыВалют.Период КАК Период
		|ПОМЕСТИТЬ КурсыВалют
		|ИЗ
		|  	РегистрСведений.КурсыВалют КАК КурсыВалют
		|;
		|
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 8.
		|ВЫБРАТЬ
		|  	КурсыВалют.Курс,
		|  	КурсыВалют.Валюта,
		|  	КурсыВалют.Период КАК НачалоПериода,
		|  	МИНИМУМ(ЕСТЬNULL(КурсыВалютКопия.Период, ДАТАВРЕМЯ(3999, 1, 1))) КАК КонецПериода
		|ПОМЕСТИТЬ ТаблицаКурсов
		|ИЗ
		|  	КурсыВалют КАК КурсыВалют
		|		ЛЕВОЕ СОЕДИНЕНИЕ КурсыВалют КАК КурсыВалютКопия
		|		ПО КурсыВалютКопия.Период > КурсыВалют.Период
		|			И КурсыВалютКопия.Валюта = КурсыВалют.Валюта
		|СГРУППИРОВАТЬ ПО
		|  	КурсыВалют.Период,
		|  	КурсыВалют.Курс,
		|  	КурсыВалют.Валюта
		|
		|ИНДЕКСИРОВАТЬ ПО 
		|	КурсыВалют.Валюта
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 9.
		|УНИЧТОЖИТЬ КурсыВалют;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 10. Получаем список документов с неправильным курсом по задаче http://r.ktc-ua.com/issues/2454
		|ВЫБРАТЬ
		|	ДенСредства.Период 															КАК Дата,
		|	ВЫРАЗИТЬ(ДенСредства.Регистратор КАК Документ.АвансовыйОтчет)				КАК Ссылка,
		|	ДенСредства.Валюта															КАК Валюта,
		|	СУММА(ДенСредства.Сумма)													КАК СуммаУпр,
		|	СУММА(ДенСредства.СуммаВВалюте) 											КАК СуммаДокумента,
		|	ВЫРАЗИТЬ(СУММА(ДенСредства.СуммаВВалюте) * ТаблицаКурсовДок.Курс / ТаблицаКурсовУпр.Курс КАК ЧИСЛО(15,4)) КАК СуммаДокументаУпр
		|ПОМЕСТИТЬ ТаблицаАвансовыхОтчетов
		|ИЗ
		|	РегистрНакопления.ДвиженияДенежныеСредстваДоходыРасходы КАК ДенСредства
		|
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсовУпр
		|		ПО ТаблицаКурсовУпр.Валюта 		= 	&ВалютаУправленческогоУчета
		|		И 	ТаблицаКурсовУпр.НачалоПериода <= 	ДенСредства.Период
		|		И 	ТаблицаКурсовУпр.КонецПериода 	> 	ДенСредства.Период
		|
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсовДок
		|		ПО ТаблицаКурсовДок.Валюта 		= 	ДенСредства.Валюта
		|		И 	ТаблицаКурсовДок.НачалоПериода 	<= 	ДенСредства.Период
		|		И 	ТаблицаКурсовДок.КонецПериода 	> 	ДенСредства.Период
		|
		|ГДЕ
		|	ДенСредства.Регистратор ССЫЛКА Документ.АвансовыйОтчет
		|	И ДенСредства.Период >= &ДатаНачала
		|	И ДенСредства.Период <= &ДатаОкончания
		|	И ДенСредства.Валюта <> &ВалютаУправленческогоУчета
		|
		|СГРУППИРОВАТЬ ПО
		|	ДенСредства.Период,
		|	ВЫРАЗИТЬ(ДенСредства.Регистратор КАК Документ.АвансовыйОтчет),
		|	ДенСредства.Валюта,
		|	ТаблицаКурсовДок.Курс,
		|	ТаблицаКурсовУпр.Курс
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 11.
		|ВЫБРАТЬ
		|	Продажы.Период 																		КАК Дата,
		|	ВЫРАЗИТЬ(Продажы.Регистратор КАК Документ.РеализацияТоваровУслуг)					КАК Ссылка,
		|	ВЫРАЗИТЬ(Продажы.Регистратор КАК Документ.РеализацияТоваровУслуг).Валюта 			КАК ВалютаДокумента,
		|	ВЫРАЗИТЬ(Продажы.Регистратор КАК Документ.РеализацияТоваровУслуг).СуммаДокумента 	КАК СуммаДокумента,
		|	АналитикаНоменклатуры.Номенклатура  												КАК Номенклатура,
		|	АналитикаНоменклатуры.Характеристика  												КАК Характеристика,
		|	СУММА(Продажы.СуммаВыручки)															КАК СуммаУпр
		|ПОМЕСТИТЬ РеализацииПредварительные
		|ИЗ
		|	РегистрНакопления.ВыручкаИСебестоимостьПродаж КАК Продажы
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаНоменклатуры КАК АналитикаНоменклатуры
		|ПО Продажы.АналитикаУчетаНоменклатуры = АналитикаНоменклатуры.КлючАналитики
		|
		|ГДЕ
		|	Продажы.Регистратор ССЫЛКА Документ.РеализацияТоваровУслуг
		|И 	Продажы.Период >= &ДатаНачала
		|И 	Продажы.Период <= &ДатаОкончания
		|И 	ВЫРАЗИТЬ(Продажы.Регистратор КАК Документ.РеализацияТоваровУслуг).Валюта <> &ВалютаУправленческогоУчета
		|
		|СГРУППИРОВАТЬ ПО
		|	Продажы.Период,
		|	ВЫРАЗИТЬ(Продажы.Регистратор КАК Документ.РеализацияТоваровУслуг),
		|	ВЫРАЗИТЬ(Продажы.Регистратор КАК Документ.РеализацияТоваровУслуг).Валюта,
		|	ВЫРАЗИТЬ(Продажы.Регистратор КАК Документ.РеализацияТоваровУслуг).СуммаДокумента,
		|	АналитикаНоменклатуры.Номенклатура,
		|	АналитикаНоменклатуры.Характеристика
		|	
		|ИНДЕКСИРОВАТЬ ПО
		|	Ссылка,
		|	АналитикаНоменклатуры.Номенклатура,
		|	АналитикаНоменклатуры.Характеристика
		|;
		
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 12.
		|ВЫБРАТЬ
		|	ТоварыРеализаций.Ссылка 			КАК Ссылка,
		|	ТоварыРеализаций.Номенклатура		КАК Номенклатура,
		|	ТоварыРеализаций.Характеристика		КАК Характеристика,
		|	СУММА(ТоварыРеализаций.СуммаСНДС)   КАК СуммаДокумента
		|ПОМЕСТИТЬ ТаблицаРеализацийПредварительная
		|ИЗ
		|	Документ.РеализацияТоваровУслуг.Товары КАК ТоварыРеализаций
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ РеализацииПредварительные КАК РеализацииПредварительные
		|ПО ТоварыРеализаций.Ссылка = РеализацииПредварительные.Ссылка
		|
		|СГРУППИРОВАТЬ ПО
		|	ТоварыРеализаций.Ссылка,
		|	ТоварыРеализаций.Номенклатура,
		|	ТоварыРеализаций.Характеристика
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	ТоварыРеализаций.Ссылка,
		|	ТоварыРеализаций.Номенклатура,
		|	ТоварыРеализаций.Характеристика
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 13.
		|ВЫБРАТЬ
		|	РеализацииПредварительные.Дата 				КАК Дата,
		|	РеализацииПредварительные.Ссылка 			КАК Ссылка,
		|	РеализацииПредварительные.ВалютаДокумента	КАК Валюта,
		|	РеализацииПредварительные.СуммаДокумента	КАК СуммаДокумента,
		|	СУММА(РеализацииПредварительные.СуммаУпр)	КАК СуммаУпр,
		|	СУММА(ВЫРАЗИТЬ(ТаблицаРеализацийПредварительная.СуммаДокумента * ТаблицаКурсовДок.Курс / ТаблицаКурсовУпр.Курс КАК ЧИСЛО(15,4))) КАК СуммаДокументаУпр
		|ПОМЕСТИТЬ ТаблицаРеализаций
		|ИЗ
		|	РеализацииПредварительные КАК РеализацииПредварительные
		|		
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ ТаблицаРеализацийПредварительная КАК ТаблицаРеализацийПредварительная
		|ПО РеализацииПредварительные.Ссылка 			= ТаблицаРеализацийПредварительная.Ссылка
		|И 	РеализацииПредварительные.Номенклатура 		= ТаблицаРеализацийПредварительная.Номенклатура
		|И 	РеализацииПредварительные.Характеристика	= ТаблицаРеализацийПредварительная.Характеристика
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсовУпр
		|ПО ТаблицаКурсовУпр.Валюта 		= 	&ВалютаУправленческогоУчета
		|И 	ТаблицаКурсовУпр.НачалоПериода  <= 	РеализацииПредварительные.Дата
		|И 	ТаблицаКурсовУпр.КонецПериода 	> 	РеализацииПредварительные.Дата
		|		
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсовДок
		|ПО ТаблицаКурсовДок.Валюта 		= 	РеализацииПредварительные.ВалютаДокумента
		|И 	ТаблицаКурсовДок.НачалоПериода 	<= 	РеализацииПредварительные.Дата
		|И 	ТаблицаКурсовДок.КонецПериода 	> 	РеализацииПредварительные.Дата
		|
		|СГРУППИРОВАТЬ ПО
		|	РеализацииПредварительные.Дата,
		|	РеализацииПредварительные.Ссылка,
		|	РеализацииПредварительные.ВалютаДокумента,
		|	РеализацииПредварительные.СуммаДокумента
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 14.
		|ВЫБРАТЬ
		|	Возвраты.Период 																	КАК Дата,
		|	ВЫРАЗИТЬ(Возвраты.Регистратор КАК Документ.ВозвратТоваровОтКлиента)					КАК Ссылка,
		|	ВЫРАЗИТЬ(Возвраты.Регистратор КАК Документ.ВозвратТоваровОтКлиента).Валюта			КАК ВалютаДокумента,
		|	ВЫРАЗИТЬ(Возвраты.Регистратор КАК Документ.ВозвратТоваровОтКлиента).СуммаДокумента 	КАК СуммаДокумента,
		|	АналитикаНоменклатуры.Номенклатура  												КАК Номенклатура,
		|	АналитикаНоменклатуры.Характеристика  												КАК Характеристика,
		|	СУММА(Возвраты.СуммаВыручки * (-1))													КАК СуммаУпр
		|ПОМЕСТИТЬ ВозвратыПредварительные
		|ИЗ
		|	РегистрНакопления.ВыручкаИСебестоимостьПродаж КАК Возвраты
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаНоменклатуры КАК АналитикаНоменклатуры
		|		ПО Возвраты.АналитикаУчетаНоменклатуры = АналитикаНоменклатуры.КлючАналитики
		|ГДЕ
		|	Возвраты.Регистратор ССЫЛКА Документ.ВозвратТоваровОтКлиента
		|И 	Возвраты.Период >= &ДатаНачала
		|И 	Возвраты.Период <= &ДатаОкончания
		|И 	ВЫРАЗИТЬ(Возвраты.Регистратор КАК Документ.ВозвратТоваровОтКлиента).Валюта <> &ВалютаУправленческогоУчета
		|	
		|СГРУППИРОВАТЬ ПО
		|	Возвраты.Период,
		|	ВЫРАЗИТЬ(Возвраты.Регистратор КАК Документ.ВозвратТоваровОтКлиента),
		|	ВЫРАЗИТЬ(Возвраты.Регистратор КАК Документ.ВозвратТоваровОтКлиента).Валюта,
		|	ВЫРАЗИТЬ(Возвраты.Регистратор КАК Документ.ВозвратТоваровОтКлиента).СуммаДокумента,
		|	АналитикаНоменклатуры.Номенклатура,
		|	АналитикаНоменклатуры.Характеристика
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Ссылка,
		|	Номенклатура,
		|	Характеристика
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 15.
		|ВЫБРАТЬ
		|	ТоварыВозвратов.Ссылка 				КАК Ссылка,
		|	ТоварыВозвратов.Номенклатура 		КАК Номенклатура,
		|	ТоварыВозвратов.Характеристика 		КАК Характеристика,
		|	СУММА(ТоварыВозвратов.СуммаСНДС)    КАК СуммаДокумента
		|ПОМЕСТИТЬ ТаблицаВозвратовПредварительный
		|ИЗ
		|	Документ.ВозвратТоваровОтКлиента.Товары КАК ТоварыВозвратов
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВозвратыПредварительные КАК ВозвратыПредварительные
		|ПО ТоварыВозвратов.Ссылка = ВозвратыПредварительные.Ссылка
		|
		|СГРУППИРОВАТЬ ПО
		|	ТоварыВозвратов.Ссылка,
		|	ТоварыВозвратов.Номенклатура,
		|	ТоварыВозвратов.Характеристика
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	ТоварыВозвратов.Ссылка,
		|	ТоварыВозвратов.Номенклатура,
		|	ТоварыВозвратов.Характеристика
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 16.
		|ВЫБРАТЬ
		|	ВозвратыПредварительные.Дата 									КАК Дата,
		|	ВозвратыПредварительные.Ссылка 									КАК Ссылка,
		|	ВозвратыПредварительные.ВалютаДокумента							КАК Валюта,
		|	ВозвратыПредварительные.СуммаДокумента							КАК СуммаДокумента,
		|	СУММА(ВозвратыПредварительные.СуммаУпр) 						КАК СуммаУпр,
		|	СУММА(ВЫРАЗИТЬ(ТаблицаВозвратовПредварительный.СуммаДокумента * ТаблицаКурсовДок.Курс / ТаблицаКурсовУпр.Курс КАК ЧИСЛО(15,4))) КАК СуммаДокументаУпр
		|ПОМЕСТИТЬ ТаблицаВозвратов
		|ИЗ
		|	ВозвратыПредварительные КАК ВозвратыПредварительные
		|
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ ТаблицаВозвратовПредварительный КАК ТаблицаВозвратовПредварительный
		|ПО ВозвратыПредварительные.Ссылка 			= ТаблицаВозвратовПредварительный.Ссылка
		|И 	ВозвратыПредварительные.Номенклатура 	= ТаблицаВозвратовПредварительный.Номенклатура
		|И 	ВозвратыПредварительные.Характеристика 	= ТаблицаВозвратовПредварительный.Характеристика
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсовУпр
		|ПО ТаблицаКурсовУпр.Валюта 		= 	&ВалютаУправленческогоУчета
		|И 	ТаблицаКурсовУпр.НачалоПериода  <= 	ВозвратыПредварительные.Дата
		|И 	ТаблицаКурсовУпр.КонецПериода 	> 	ВозвратыПредварительные.Дата
		|		
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсовДок
		|ПО ТаблицаКурсовДок.Валюта 		= 	ВозвратыПредварительные.ВалютаДокумента
		|И 	ТаблицаКурсовДок.НачалоПериода 	<= 	ВозвратыПредварительные.Дата
		|И 	ТаблицаКурсовДок.КонецПериода 	> 	ВозвратыПредварительные.Дата
		|
		|СГРУППИРОВАТЬ ПО
		|	ВозвратыПредварительные.Дата,
		|	ВозвратыПредварительные.Ссылка,
		|	ВозвратыПредварительные.ВалютаДокумента,
		|	ВозвратыПредварительные.СуммаДокумента
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 17.
		|ВЫБРАТЬ
		|	Себестоимость.Период 																	КАК Дата,
		|	ВЫРАЗИТЬ(Себестоимость.Регистратор КАК Документ.ПоступлениеТоваровУслуг)				КАК Ссылка,
		|	ВЫРАЗИТЬ(Себестоимость.Регистратор КАК Документ.ПоступлениеТоваровУслуг).Валюта   		КАК ВалютаДокумента,
		|	ВЫРАЗИТЬ(Себестоимость.Регистратор КАК Документ.ПоступлениеТоваровУслуг).СуммаДокумента КАК СуммаДокумента,
		|	АналитикаНоменклатуры.Номенклатура														КАК Номенклатура,
		|	АналитикаНоменклатуры.Характеристика													КАК Характеристика,
		|	СУММА(Себестоимость.Стоимость)															КАК СуммаУпр
		|ПОМЕСТИТЬ ПоступленияПредварительные
		|ИЗ
		|	РегистрНакопления.СебестоимостьТоваров КАК Себестоимость
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаНоменклатуры КАК АналитикаНоменклатуры
		|ПО Себестоимость.АналитикаУчетаНоменклатуры = АналитикаНоменклатуры.КлючАналитики
		|
		|ГДЕ
		|	Себестоимость.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
		|	И Себестоимость.Период >= &ДатаНачала
		|	И Себестоимость.Период <= &ДатаОкончания
		|	И ВЫРАЗИТЬ(Себестоимость.Регистратор КАК Документ.ПоступлениеТоваровУслуг).Валюта <> &ВалютаУправленческогоУчета
		|
		|СГРУППИРОВАТЬ ПО
		|	Себестоимость.Период,
		|	ВЫРАЗИТЬ(Себестоимость.Регистратор КАК Документ.ПоступлениеТоваровУслуг),
		|	ВЫРАЗИТЬ(Себестоимость.Регистратор КАК Документ.ПоступлениеТоваровУслуг).Валюта,
		|	ВЫРАЗИТЬ(Себестоимость.Регистратор КАК Документ.ПоступлениеТоваровУслуг).СуммаДокумента,
		|	АналитикаНоменклатуры.Номенклатура,
		|	АналитикаНоменклатуры.Характеристика
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	Себестоимость.Период 																	КАК Дата,
		|	ВЫРАЗИТЬ(Себестоимость.Регистратор КАК Документ.ПоступлениеТоваровУслуг)				КАК Ссылка,
		|	ВЫРАЗИТЬ(Себестоимость.Регистратор КАК Документ.ПоступлениеТоваровУслуг).Валюта   		КАК ВалютаДокумента,
		|	ВЫРАЗИТЬ(Себестоимость.Регистратор КАК Документ.ПоступлениеТоваровУслуг).СуммаДокумента КАК СуммаДокумента,
		|	АналитикаНоменклатуры.Номенклатура														КАК Номенклатура,
		|	АналитикаНоменклатуры.Характеристика													КАК Характеристика,
		|	СУММА(Себестоимость.Стоимость)															КАК СуммаУпр
		|ИЗ
		|	РегистрНакопления.СебестоимостьТоваров КАК Себестоимость
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаНоменклатуры КАК АналитикаНоменклатуры
		|ПО Себестоимость.АналитикаУчетаНоменклатуры = АналитикаНоменклатуры.КлючАналитики
		|
		|ГДЕ
		|	Себестоимость.Регистратор 	ССЫЛКА Документ.ПоступлениеТоваровУслуг
		|	И Себестоимость.Период 		>= &ДатаНачала
		|	И Себестоимость.Период 		<= &ДатаОкончания
		|	И Себестоимость.Стоимость   = 0
		|	И ВЫРАЗИТЬ(Себестоимость.Регистратор КАК Документ.ПоступлениеТоваровУслуг).Валюта = &ВалютаУправленческогоУчета
		|
		|СГРУППИРОВАТЬ ПО
		|	Себестоимость.Период,
		|	ВЫРАЗИТЬ(Себестоимость.Регистратор КАК Документ.ПоступлениеТоваровУслуг),
		|	ВЫРАЗИТЬ(Себестоимость.Регистратор КАК Документ.ПоступлениеТоваровУслуг).Валюта,
		|	ВЫРАЗИТЬ(Себестоимость.Регистратор КАК Документ.ПоступлениеТоваровУслуг).СуммаДокумента,
		|	АналитикаНоменклатуры.Номенклатура,
		|	АналитикаНоменклатуры.Характеристика
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Ссылка,
		|	Номенклатура,
		|	Характеристика
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 18.
		|ВЫБРАТЬ
		|	ПоступлениеТоваров.Ссылка 				КАК Ссылка,
		|	ПоступлениеТоваров.Номенклатура			КАК Номенклатура,
		|	ПоступлениеТоваров.Характеристика		КАК Характеристика,
		|	СУММА(ПоступлениеТоваров.СуммаСНДС)     КАК СуммаДокумента
		|ПОМЕСТИТЬ ТаблицаПоступленийПредварительный
		|ИЗ
		|	Документ.ПоступлениеТоваровУслуг.Товары КАК ПоступлениеТоваров
		|
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ ПоступленияПредварительные КАК ПоступленияПредварительные
		|ПО	ПоступлениеТоваров.Ссылка = ПоступленияПредварительные.Ссылка
		|
		|СГРУППИРОВАТЬ ПО
		|	ПоступлениеТоваров.Ссылка,
		|	ПоступлениеТоваров.Номенклатура,
		|	ПоступлениеТоваров.Характеристика
		|
		|ИНДЕКСИРОВАТЬ ПО 
		|	ПоступлениеТоваров.Ссылка,
		|	ПоступлениеТоваров.Номенклатура,
		|	ПоступлениеТоваров.Характеристика
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 19.
		|ВЫБРАТЬ
		|	ПоступленияПредварительные.Дата 				КАК Дата,
		|	ПоступленияПредварительные.Ссылка 				КАК Ссылка,
		|	ПоступленияПредварительные.ВалютаДокумента		КАК Валюта,
		|	ПоступленияПредварительные.СуммаДокумента		КАК СуммаДокумента,
		|	СУММА(ПоступленияПредварительные.СуммаУпр)		КАК СуммаУпр,
		|	СУММА(ВЫРАЗИТЬ(ТаблицаПоступленийПредварительный.СуммаДокумента * ТаблицаКурсовДок.Курс / ТаблицаКурсовУпр.Курс КАК ЧИСЛО(15,4))) КАК СуммаДокументаУпр
		|ПОМЕСТИТЬ ТаблицаПоступлений
		|ИЗ
		|	ПоступленияПредварительные КАК ПоступленияПредварительные
		|		
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ ТаблицаПоступленийПредварительный КАК ТаблицаПоступленийПредварительный
		|ПО	ПоступленияПредварительные.Ссылка 			= ТаблицаПоступленийПредварительный.Ссылка
		|И	ПоступленияПредварительные.Номенклатура 	= ТаблицаПоступленийПредварительный.Номенклатура
		|И	ПоступленияПредварительные.Характеристика 	= ТаблицаПоступленийПредварительный.Характеристика
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсовУпр
		|ПО ТаблицаКурсовУпр.Валюта 		= 	&ВалютаУправленческогоУчета
		|И 	ТаблицаКурсовУпр.НачалоПериода  <=	ПоступленияПредварительные.Дата
		|И 	ТаблицаКурсовУпр.КонецПериода 	> 	ПоступленияПредварительные.Дата
		|		
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсовДок
		|ПО ТаблицаКурсовДок.Валюта 		= 	ПоступленияПредварительные.ВалютаДокумента
		|И 	ТаблицаКурсовДок.НачалоПериода 	<= 	ПоступленияПредварительные.Дата
		|И 	ТаблицаКурсовДок.КонецПериода 	> 	ПоступленияПредварительные.Дата
		|
		|СГРУППИРОВАТЬ ПО
		|	ПоступленияПредварительные.Дата,
		|	ПоступленияПредварительные.Ссылка,
		|	ПоступленияПредварительные.ВалютаДокумента,
		|	ПоступленияПредварительные.СуммаДокумента
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 20.
		|ВЫБРАТЬ
		|	Себестоимость.Период 																		КАК Дата,
		|	ВЫРАЗИТЬ(Себестоимость.Регистратор КАК Документ.ВозвратТоваровПоставщику)					КАК Ссылка,
		|	ВЫРАЗИТЬ(Себестоимость.Регистратор КАК Документ.ВозвратТоваровПоставщику).Валюта  			КАК ВалютаДокумента,
		|	ВЫРАЗИТЬ(Себестоимость.Регистратор КАК Документ.ВозвратТоваровПоставщику).СуммаДокумента	КАК СуммаДокумента,
		|	АналитикаНоменклатуры.Номенклатура															КАК Номенклатура,
		|	АналитикаНоменклатуры.Характеристика														КАК Характеристика,
		|	СУММА(Себестоимость.Стоимость)																КАК СуммаУпр
		|ПОМЕСТИТЬ ВозвратыПоставщикуПредварительные
		|ИЗ
		|	РегистрНакопления.СебестоимостьТоваров КАК Себестоимость
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаНоменклатуры КАК АналитикаНоменклатуры
		|ПО Себестоимость.АналитикаУчетаНоменклатуры = АналитикаНоменклатуры.КлючАналитики
		|
		|ГДЕ
		|	Себестоимость.Регистратор ССЫЛКА Документ.ВозвратТоваровПоставщику
		|	И Себестоимость.Период >= &ДатаНачала
		|	И Себестоимость.Период <= &ДатаОкончания
		|	И ВЫРАЗИТЬ(Себестоимость.Регистратор КАК Документ.ВозвратТоваровПоставщику).Валюта <> &ВалютаУправленческогоУчета
		|
		|СГРУППИРОВАТЬ ПО
		|	Себестоимость.Период,
		|	ВЫРАЗИТЬ(Себестоимость.Регистратор КАК Документ.ВозвратТоваровПоставщику),
		|	ВЫРАЗИТЬ(Себестоимость.Регистратор КАК Документ.ВозвратТоваровПоставщику).Валюта,
		|	ВЫРАЗИТЬ(Себестоимость.Регистратор КАК Документ.ВозвратТоваровПоставщику).СуммаДокумента,
		|	АналитикаНоменклатуры.Номенклатура,
		|	АналитикаНоменклатуры.Характеристика
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	Себестоимость.Период 																		КАК Дата,
		|	ВЫРАЗИТЬ(Себестоимость.Регистратор КАК Документ.ВозвратТоваровПоставщику)					КАК Ссылка,
		|	ВЫРАЗИТЬ(Себестоимость.Регистратор КАК Документ.ВозвратТоваровПоставщику).Валюта  			КАК ВалютаДокумента,
		|	ВЫРАЗИТЬ(Себестоимость.Регистратор КАК Документ.ВозвратТоваровПоставщику).СуммаДокумента	КАК СуммаДокумента,
		|	АналитикаНоменклатуры.Номенклатура															КАК Номенклатура,
		|	АналитикаНоменклатуры.Характеристика														КАК Характеристика,
		|	СУММА(Себестоимость.Стоимость)																КАК СуммаУпр
		|ИЗ
		|	РегистрНакопления.СебестоимостьТоваров КАК Себестоимость
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаНоменклатуры КАК АналитикаНоменклатуры
		|ПО Себестоимость.АналитикаУчетаНоменклатуры = АналитикаНоменклатуры.КлючАналитики
		|
		|ГДЕ
		|	Себестоимость.Регистратор ССЫЛКА Документ.ВозвратТоваровПоставщику
		|	И Себестоимость.Период >= &ДатаНачала
		|	И Себестоимость.Период <= &ДатаОкончания
		|	И Себестоимость.Стоимость = 0
		|	И ВЫРАЗИТЬ(Себестоимость.Регистратор КАК Документ.ВозвратТоваровПоставщику).Валюта = &ВалютаУправленческогоУчета
		|
		|СГРУППИРОВАТЬ ПО
		|	Себестоимость.Период,
		|	ВЫРАЗИТЬ(Себестоимость.Регистратор КАК Документ.ВозвратТоваровПоставщику),
		|	ВЫРАЗИТЬ(Себестоимость.Регистратор КАК Документ.ВозвратТоваровПоставщику).Валюта,
		|	ВЫРАЗИТЬ(Себестоимость.Регистратор КАК Документ.ВозвратТоваровПоставщику).СуммаДокумента,
		|	АналитикаНоменклатуры.Номенклатура,
		|	АналитикаНоменклатуры.Характеристика
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Ссылка,
		|	Номенклатура,
		|	Характеристика
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 21.
		|ВЫБРАТЬ
		|	ВозвратыПоставщикам.Ссылка 				КАК Ссылка,
		|	ВозвратыПоставщикам.Номенклатура		КАК Номенклатура,
		|	ВозвратыПоставщикам.Характеристика		КАК Характеристика,
		|	СУММА(ВозвратыПоставщикам.СуммаСНДС)    КАК СуммаДокумента
		|ПОМЕСТИТЬ ТаблицаВозвратовПоставщикамПредварительный
		|ИЗ
		|	Документ.ВозвратТоваровПоставщику.Товары КАК ВозвратыПоставщикам
		|
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВозвратыПоставщикуПредварительные КАК ВозвратыПоставщикуПредварительные
		|ПО ВозвратыПоставщикам.Ссылка = ВозвратыПоставщикуПредварительные.Ссылка
		|
		|СГРУППИРОВАТЬ ПО
		|	ВозвратыПоставщикам.Ссылка,
		|	ВозвратыПоставщикам.Номенклатура,
		|	ВозвратыПоставщикам.Характеристика
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	ВозвратыПоставщикам.Ссылка,
		|	ВозвратыПоставщикам.Номенклатура,
		|	ВозвратыПоставщикам.Характеристика
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 22.
		|ВЫБРАТЬ
		|	ВозвратыПоставщикуПредварительные.Дата 							КАК Дата,
		|	ВозвратыПоставщикуПредварительные.Ссылка 						КАК Ссылка,
		|	ВозвратыПоставщикуПредварительные.ВалютаДокумента				КАК Валюта,
		|	СУММА(ВозвратыПоставщикуПредварительные.СуммаУпр)				КАК СуммаУпр,
		|	ВозвратыПоставщикуПредварительные.СуммаДокумента				КАК СуммаДокумента,
		|	СУММА(ВЫРАЗИТЬ(ТаблицаВозвратовПоставщикамПредварительный.СуммаДокумента * ТаблицаКурсовДок.Курс / ТаблицаКурсовУпр.Курс КАК ЧИСЛО(15,4))) КАК СуммаДокументаУпр
		|ПОМЕСТИТЬ ТаблицаВозвратовПоставщикам
		|ИЗ
		|	ВозвратыПоставщикуПредварительные КАК ВозвратыПоставщикуПредварительные
		|
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ ТаблицаВозвратовПоставщикамПредварительный КАК ТаблицаВозвратовПоставщикамПредварительный
		|ПО ВозвратыПоставщикуПредварительные.Ссылка 			= ТаблицаВозвратовПоставщикамПредварительный.Ссылка
		|И  ВозвратыПоставщикуПредварительные.Номенклатура 		= ТаблицаВозвратовПоставщикамПредварительный.Номенклатура
		|И  ВозвратыПоставщикуПредварительные.Характеристика 	= ТаблицаВозвратовПоставщикамПредварительный.Характеристика
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсовУпр
		|ПО ТаблицаКурсовУпр.Валюта 		= 	&ВалютаУправленческогоУчета
		|И 	ТаблицаКурсовУпр.НачалоПериода  <= 	ВозвратыПоставщикуПредварительные.Дата
		|И 	ТаблицаКурсовУпр.КонецПериода 	> 	ВозвратыПоставщикуПредварительные.Дата
		|		
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсовДок
		|ПО ТаблицаКурсовДок.Валюта 		= 	ВозвратыПоставщикуПредварительные.ВалютаДокумента
		|И 	ТаблицаКурсовДок.НачалоПериода 	<= 	ВозвратыПоставщикуПредварительные.Дата
		|И 	ТаблицаКурсовДок.КонецПериода 	> 	ВозвратыПоставщикуПредварительные.Дата
		|
		|СГРУППИРОВАТЬ ПО
		|	ВозвратыПоставщикуПредварительные.Дата,
		|	ВозвратыПоставщикуПредварительные.Ссылка,
		|	ВозвратыПоставщикуПредварительные.ВалютаДокумента,
		|	ВозвратыПоставщикуПредварительные.СуммаДокумента
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 23.
		|ВЫБРАТЬ
		|	ДенСредства.Период 														КАК Дата,
		|	ВЫРАЗИТЬ(ДенСредства.Регистратор КАК Документ.ВыпискаПоРасчетномуСчету)	КАК Ссылка,
		|	ДенСредства.Валюта 														КАК Валюта,
		|	ДенСредства.Сумма 														КАК СуммаУпр,
		|	ДенСредства.СуммаВВалюте												КАК СуммаДокумента,
		|	ВЫРАЗИТЬ(ДенСредства.СуммаВВалюте * ТаблицаКурсовДок.Курс / ТаблицаКурсовУпр.Курс КАК ЧИСЛО(15,4)) КАК СуммаДокументаУпр
		|ПОМЕСТИТЬ ТаблицаБанковскихВыписок
		|ИЗ
		|	РегистрНакопления.ДвиженияДенежныхСредств КАК ДенСредства
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсовУпр
		|		ПО ТаблицаКурсовУпр.Валюта 		= 	&ВалютаУправленческогоУчета
		|		И 	ТаблицаКурсовУпр.НачалоПериода  <= 	ДенСредства.Период
		|		И 	ТаблицаКурсовУпр.КонецПериода 	> 	ДенСредства.Период
		|		
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсовДок
		|		ПО ТаблицаКурсовДок.Валюта 		= 	ДенСредства.Валюта
		|		И 	ТаблицаКурсовДок.НачалоПериода 	<= 	ДенСредства.Период
		|		И 	ТаблицаКурсовДок.КонецПериода 	> 	ДенСредства.Период

		|ГДЕ
		|	ДенСредства.Регистратор Ссылка Документ.ВыпискаПоРасчетномуСчету
		|	И ДенСредства.Период <= &ДатаНачала
		|	И ДенСредства.Период >=	&ДатаОкончания
		|	И ДенСредства.Валюта <> &ВалютаУправленческогоУчета
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 24.
		|ВЫБРАТЬ
		|	Регистратор			КАК Ссылка,
		|	Организация			КАК Организация,
		//|	СтатьяРасходов		КАК СтатьяРасходов,
		//|	АналитикаРасходов   КАК АналитикаРасходов,
		|	СУММА(СуммаОборот)	КАК СуммаУпр
		|ПОМЕСТИТЬ ПоступленияПрочихУслугИАктивовПредварительные
		|ИЗ
		|	РегистрНакопления.ПрочиеРасходы.Обороты(&ГраницаНачало, &ГраницаОкончания, Регистратор)
		|ГДЕ
		|	Регистратор ССЫЛКА Документ.ПоступлениеУслугПрочихАктивов

		|СГРУППИРОВАТЬ ПО
		|	Регистратор,
		|	Организация//,
		//|	СтатьяРасходов,
		//|	АналитикаРасходов
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 25.
		|ВЫБРАТЬ
		|	Расходы.Ссылка 					КАК Ссылка,
		|	Расходы.Ссылка.Организация      КАК Организация,
		|	Расходы.Ссылка.Валюта      		КАК Валюта,
		|	Расходы.Ссылка.Дата      		КАК Дата,
		//|	Расходы.СтатьяРасходов			КАК СтатьяРасходов,
		//|	Расходы.АналитикаРасходов		КАК АналитикаРасходов,
		|	СУММА(Расходы.СуммаСНДС)		КАК СуммаДокумента
		|ПОМЕСТИТЬ ТаблицаПоступленийУслугИПрочихАктивовПредварительная
		|ИЗ
		|	Документ.ПоступлениеУслугПрочихАктивов.Расходы КАК Расходы
		|	
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ ПоступленияПрочихУслугИАктивовПредварительные КАК ПрочиеУслугиИАктивы
		|ПО Расходы.Ссылка = ПрочиеУслугиИАктивы.Ссылка

		|СГРУППИРОВАТЬ ПО
		|	Расходы.Ссылка//,
		//|	Расходы.СтатьяРасходов,
		//|	Расходы.АналитикаРасходов
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 26.
		|ВЫБРАТЬ
		|	ТаблицаПрочиеУслугиИАктивы.Дата 		КАК Дата,
		|	ТаблицаПрочиеУслугиИАктивы.Ссылка       КАК Ссылка,
		|	ТаблицаПрочиеУслугиИАктивы.Валюта		КАК Валюта,
		|	СУММА(ПрочиеУслугиИАктивы.СуммаУпр)		КАК СуммаУпр,
		|	ТаблицаПрочиеУслугиИАктивы.СуммаДокумента КАК СуммаДокумента,
		|	СУММА(ВЫРАЗИТЬ(ТаблицаПрочиеУслугиИАктивы.СуммаДокумента * ТаблицаКурсовДок.Курс / ТаблицаКурсовУпр.Курс КАК ЧИСЛО(15,4))) КАК СуммаДокументаУпр
		|ПОМЕСТИТЬ ТаблицаУслугиИПрочиеАктивы
		|ИЗ
		|	ТаблицаПоступленийУслугИПрочихАктивовПредварительная КАК ТаблицаПрочиеУслугиИАктивы
		|	
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ ПоступленияПрочихУслугИАктивовПредварительные КАК ПрочиеУслугиИАктивы
		|ПО ТаблицаПрочиеУслугиИАктивы.Ссылка 			= ПрочиеУслугиИАктивы.Ссылка
		|И ТаблицаПрочиеУслугиИАктивы.Организация 		= ПрочиеУслугиИАктивы.Организация
		//|И ТаблицаПрочиеУслугиИАктивы.СтатьяРасходов 	= ПрочиеУслугиИАктивы.СтатьяРасходов
		//|И ТаблицаПрочиеУслугиИАктивы.АналитикаРасходов 	= ПрочиеУслугиИАктивы.АналитикаРасходов

		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсовДок
		|ПО ТаблицаПрочиеУслугиИАктивы.Валюта 	=  ТаблицаКурсовДок.Валюта
		|И ТаблицаПрочиеУслугиИАктивы.Дата 		>= ТаблицаКурсовДок.НачалоПериода
		|И ТаблицаПрочиеУслугиИАктивы.Дата 		<  ТаблицаКурсовДок.КонецПериода

		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсовУпр
		|ПО ТаблицаКурсовУпр.Валюта 		= &ВалютаУправленческогоУчета
		|И ТаблицаПрочиеУслугиИАктивы.Дата 	>= ТаблицаКурсовУпр.НачалоПериода
		|И ТаблицаПрочиеУслугиИАктивы.Дата 	<  ТаблицаКурсовУпр.КонецПериода
		|
		|СГРУППИРОВАТЬ ПО
		|	ТаблицаПрочиеУслугиИАктивы.Дата,
		|	ТаблицаПрочиеУслугиИАктивы.Ссылка,
		|	ТаблицаПрочиеУслугиИАктивы.Валюта,
		|	ТаблицаПрочиеУслугиИАктивы.СуммаДокумента
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 27.
		|ВЫБРАТЬ
		|	ДенСредства.Период 														КАК Дата,
		|	ВЫРАЗИТЬ(ДенСредства.Регистратор КАК Документ.РасходныйКассовыйОрдер) 	КАК Ссылка,
		|	ДенСредства.Касса.ВалютаДенежныхСредств									КАК Валюта,
		|	ДенСредства.СуммаУпрОборот * (-1)												КАК СуммаУпр,
		|	ДенСредства.СуммаОборот	* (-1)												КАК СуммаДокумента,
		|	ВЫРАЗИТЬ(ДенСредства.СуммаОборот * (-1) * ТаблицаКурсовДок.Курс / ТаблицаКурсовУпр.Курс КАК ЧИСЛО(15,4)) КАК СуммаДокументаУпр
		|ПОМЕСТИТЬ ТаблицаНаличныеДенежныеСредста
		|ИЗ
		|	РегистрНакопления.ДенежныеСредстваНаличные.Обороты(&ГраницаНачало, &ГраницаОкончания, Регистратор) КАК ДенСредства
		
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсовДок
		|ПО ДенСредства.Касса.ВалютаДенежныхСредств	=  ТаблицаКурсовДок.Валюта
		|И ДенСредства.Период 						>= ТаблицаКурсовДок.НачалоПериода
		|И ДенСредства.Период 						<  ТаблицаКурсовДок.КонецПериода

		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсовУпр
		|ПО ТаблицаКурсовУпр.Валюта = &ВалютаУправленческогоУчета
		|И ДенСредства.Период 		>= ТаблицаКурсовУпр.НачалоПериода
		|И ДенСредства.Период 		<  ТаблицаКурсовУпр.КонецПериода
		
		|ГДЕ
		|	ДенСредства.Регистратор ССЫЛКА Документ.РасходныйКассовыйОрдер
		|	
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДенСредства.Период 														КАК Дата,
		|	ВЫРАЗИТЬ(ДенСредства.Регистратор КАК Документ.ПриходныйКассовыйОрдер) 	КАК Ссылка,
		|	ДенСредства.Касса.ВалютаДенежныхСредств									КАК Валюта,
		|	ДенСредства.СуммаУпрОборот												КАК СуммаУпр,
		|	ДенСредства.СуммаОборот													КАК СуммаДокумента,
		|	ВЫРАЗИТЬ(ДенСредства.СуммаОборот * ТаблицаКурсовДок.Курс / ТаблицаКурсовУпр.Курс КАК ЧИСЛО(15,4)) КАК СуммаДокументаУпр
		|ИЗ
		|	РегистрНакопления.ДенежныеСредстваНаличные.Обороты(&ГраницаНачало, &ГраницаОкончания, Регистратор) КАК ДенСредства
		
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсовДок
		|ПО ДенСредства.Касса.ВалютаДенежныхСредств	=  ТаблицаКурсовДок.Валюта
		|И ДенСредства.Период 						>= ТаблицаКурсовДок.НачалоПериода
		|И ДенСредства.Период 						<  ТаблицаКурсовДок.КонецПериода

		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсовУпр
		|ПО ТаблицаКурсовУпр.Валюта = &ВалютаУправленческогоУчета
		|И ДенСредства.Период 		>= ТаблицаКурсовУпр.НачалоПериода
		|И ДенСредства.Период 		<  ТаблицаКурсовУпр.КонецПериода
		
		|ГДЕ
		|	ДенСредства.Регистратор ССЫЛКА Документ.ПриходныйКассовыйОрдер
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 28.
		|ВЫБРАТЬ
		|	ВЫРАЗИТЬ(Регистратор КАК Документ.АвансовыйОтчет) 	КАК Ссылка,
		|	Организация											КАК Организация,
		//|	СтатьяРасходов										КАК СтатьяРасходов,
		//|	АналитикаРасходов   								КАК АналитикаРасходов,
		|	СУММА(СуммаОборот)									КАК СуммаУпр
		|ПОМЕСТИТЬ АвансовыеОтчетыПрочиеРасходыПредварительные
		|ИЗ
		|	РегистрНакопления.ПрочиеРасходы.Обороты(&ГраницаНачало, &ГраницаОкончания, Регистратор)
		|ГДЕ
		|	Регистратор ССЫЛКА Документ.АвансовыйОтчет
		|	И Регистратор НЕ В (ВЫБРАТЬ Ссылка ИЗ ТаблицаАвансовыхОтчетов)

		|СГРУППИРОВАТЬ ПО
		|	Регистратор,
		|	Организация//,
		//|	СтатьяРасходов,
		//|	АналитикаРасходов
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 29.
		|ВЫБРАТЬ
		|	Расходы.Ссылка 					КАК Ссылка,
		|	Расходы.Ссылка.Организация      КАК Организация,
		|	Расходы.Ссылка.Валюта      		КАК Валюта,
		|	Расходы.Ссылка.Дата      		КАК Дата,
		//|	Расходы.СтатьяРасходов			КАК СтатьяРасходов,
		//|	Расходы.АналитикаРасходов		КАК АналитикаРасходов,
		|	СУММА(Расходы.Сумма)			КАК СуммаДокумента
		|ПОМЕСТИТЬ ТаблицаАвансовыеОтчетыПрочиеРасходыПредварительная
		|ИЗ
		|	Документ.АвансовыйОтчет.ПрочиеРасходы КАК Расходы
		|	
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ АвансовыеОтчетыПрочиеРасходыПредварительные КАК ПрочиеУслугиИАктивы
		|ПО Расходы.Ссылка = ПрочиеУслугиИАктивы.Ссылка

		|СГРУППИРОВАТЬ ПО
		|	Расходы.Ссылка//,
		//|	Расходы.СтатьяРасходов,
		//|	Расходы.АналитикаРасходов
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 30.
		|ВЫБРАТЬ
		|	ТаблицаПрочиеУслуги.Дата 					КАК Дата,
		|	ТаблицаПрочиеУслуги.Ссылка       			КАК Ссылка,
		|	ТаблицаПрочиеУслуги.Валюта					КАК Валюта,
		|	СУММА(ПрочиеУслуги.СуммаУпр)				КАК СуммаУпр,
		|	СУММА(ТаблицаПрочиеУслуги.СуммаДокумента) 	КАК СуммаДокумента,
		|	СУММА(ВЫРАЗИТЬ(ТаблицаПрочиеУслуги.СуммаДокумента * ТаблицаКурсовДок.Курс / ТаблицаКурсовУпр.Курс КАК ЧИСЛО(15,4))) КАК СуммаДокументаУпр
		|ПОМЕСТИТЬ ТаблицаАвансовыеОтчетыПрочиеАктивы
		|ИЗ
		|	ТаблицаАвансовыеОтчетыПрочиеРасходыПредварительная КАК ТаблицаПрочиеУслуги
		|	
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ АвансовыеОтчетыПрочиеРасходыПредварительные КАК ПрочиеУслуги
		|ПО ТаблицаПрочиеУслуги.Ссылка 			 = ПрочиеУслуги.Ссылка
		|И ТаблицаПрочиеУслуги.Организация 		 = ПрочиеУслуги.Организация
		//|И ТаблицаПрочиеУслуги.СтатьяРасходов 	 = ПрочиеУслуги.СтатьяРасходов
		//|И ТаблицаПрочиеУслуги.АналитикаРасходов = ПрочиеУслуги.АналитикаРасходов

		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсовДок
		|ПО ТаблицаПрочиеУслуги.Валюта 	=  ТаблицаКурсовДок.Валюта
		|И ТаблицаПрочиеУслуги.Дата 	>= ТаблицаКурсовДок.НачалоПериода
		|И ТаблицаПрочиеУслуги.Дата 	<  ТаблицаКурсовДок.КонецПериода

		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсовУпр
		|ПО ТаблицаКурсовУпр.Валюта 	= &ВалютаУправленческогоУчета
		|И ТаблицаПрочиеУслуги.Дата 	>= ТаблицаКурсовУпр.НачалоПериода
		|И ТаблицаПрочиеУслуги.Дата 	<  ТаблицаКурсовУпр.КонецПериода
		|
		|СГРУППИРОВАТЬ ПО
		|	ТаблицаПрочиеУслуги.Дата,
		|	ТаблицаПрочиеУслуги.Ссылка,
		|	ТаблицаПрочиеУслуги.Валюта
		|;

		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 31.
		|ВЫБРАТЬ
		|	Дата 				КАК Дата,
		|	Ссылка 				КАК Ссылка,
		|	ВЫБОР
		|		КОГДА СуммаУпр = 0
		|		ТОГДА 0.01
		|		ИНАЧЕ СуммаУпр
		|	КОНЕЦ				КАК СуммаУпр,
		|	СуммаДокумента		КАК СуммаДокумента,
		|	СуммаДокументаУпр 	КАК СуммаДокументаУпр,
		|	Валюта 				КАК Валюта
		|ПОМЕСТИТЬ ТаблицаРасчетаКурсов
		|ИЗ
		|	ТаблицаАвансовыхОтчетов
		|	
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	Дата 				КАК Дата,
		|	Ссылка 				КАК Ссылка,
		|	ВЫБОР
		|		КОГДА СуммаУпр = 0
		|		ТОГДА 0.01
		|		ИНАЧЕ СуммаУпр
		|	КОНЕЦ				КАК СуммаУпр,
		|	СуммаДокумента		КАК СуммаДокумента,
		|	СуммаДокументаУпр 	КАК СуммаДокументаУпр,
		|	Валюта 				КАК Валюта
		|ИЗ
		|	ТаблицаРеализаций
		|	
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	Дата 				КАК Дата,
		|	Ссылка 				КАК Ссылка,
		|	ВЫБОР
		|		КОГДА СуммаУпр = 0
		|		ТОГДА 0.01
		|		ИНАЧЕ СуммаУпр
		|	КОНЕЦ				КАК СуммаУпр,
		|	СуммаДокумента		КАК СуммаДокумента,
		|	СуммаДокументаУпр 	КАК СуммаДокументаУпр,
		|	Валюта 				КАК Валюта
		|ИЗ
		|	ТаблицаВозвратов
		|	
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	Дата 				КАК Дата,
		|	Ссылка 				КАК Ссылка,
		|	ВЫБОР
		|		КОГДА СуммаУпр = 0
		|		ТОГДА 0.01
		|		ИНАЧЕ СуммаУпр
		|	КОНЕЦ				КАК СуммаУпр,
		|	СуммаДокумента		КАК СуммаДокумента,
		|	СуммаДокументаУпр 	КАК СуммаДокументаУпр,
		|	Валюта 				КАК Валюта
		|ИЗ
		|	ТаблицаПоступлений
		|	
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	Дата 				КАК Дата,
		|	Ссылка 				КАК Ссылка,
		|	ВЫБОР
		|		КОГДА СуммаУпр = 0
		|		ТОГДА 0.01
		|		ИНАЧЕ СуммаУпр
		|	КОНЕЦ				КАК СуммаУпр,
		|	СуммаДокумента		КАК СуммаДокумента,
		|	СуммаДокументаУпр 	КАК СуммаДокументаУпр,
		|	Валюта 				КАК Валюта
		|ИЗ
		|	ТаблицаВозвратовПоставщикам
		|	
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	Дата 				КАК Дата,
		|	Ссылка 				КАК Ссылка,
		|	ВЫБОР
		|		КОГДА СуммаУпр = 0
		|		ТОГДА 0.01
		|		ИНАЧЕ СуммаУпр
		|	КОНЕЦ				КАК СуммаУпр,
		|	СуммаДокумента		КАК СуммаДокумента,
		|	СуммаДокументаУпр 	КАК СуммаДокументаУпр,
		|	Валюта 				КАК Валюта
		|ИЗ
		|	ТаблицаБанковскихВыписок
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	Дата 				КАК Дата,
		|	Ссылка 				КАК Ссылка,
		|	ВЫБОР
		|		КОГДА СуммаУпр = 0
		|		ТОГДА 0.01
		|		ИНАЧЕ СуммаУпр
		|	КОНЕЦ				КАК СуммаУпр,
		|	СуммаДокумента		КАК СуммаДокумента,
		|	СуммаДокументаУпр 	КАК СуммаДокументаУпр,
		|	Валюта 				КАК Валюта
		|ИЗ
		|	ТаблицаУслугиИПрочиеАктивы
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	Дата 				КАК Дата,
		|	Ссылка 				КАК Ссылка,
		|	ВЫБОР
		|		КОГДА СуммаУпр = 0
		|		ТОГДА 0.01
		|		ИНАЧЕ СуммаУпр
		|	КОНЕЦ				КАК СуммаУпр,
		|	ВЫБОР
		|		КОГДА СуммаДокумента = 0
		|		ТОГДА 0.01
		|		ИНАЧЕ СуммаДокумента
		|	КОНЕЦ КАК СуммаДокумента,
		|	СуммаДокументаУпр 	КАК СуммаДокументаУпр,
		|	Валюта 				КАК Валюта
		|ИЗ
		|	ТаблицаНаличныеДенежныеСредста
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	Дата 				КАК Дата,
		|	Ссылка 				КАК Ссылка,
		|	ВЫБОР
		|		КОГДА СуммаУпр = 0
		|		ТОГДА 0.01
		|		ИНАЧЕ СуммаУпр
		|	КОНЕЦ				КАК СуммаУпр,
		|	ВЫБОР
		|		КОГДА СуммаДокумента = 0
		|		ТОГДА 0.01
		|		ИНАЧЕ СуммаДокумента
		|	КОНЕЦ КАК СуммаДокумента,
		|	СуммаДокументаУпр 	КАК СуммаДокументаУпр,
		|	Валюта 				КАК Валюта
		|ИЗ
		|	ТаблицаАвансовыеОтчетыПрочиеАктивы
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 32.
		|УНИЧТОЖИТЬ ТаблицаАвансовыхОтчетов;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 33.
		|УНИЧТОЖИТЬ ТаблицаРеализацийПредварительная;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 34.
		|УНИЧТОЖИТЬ ТаблицаРеализаций;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 35.
		|УНИЧТОЖИТЬ ТаблицаВозвратов;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 36.
		|УНИЧТОЖИТЬ ТаблицаВозвратовПредварительный;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 37.
		|УНИЧТОЖИТЬ ТаблицаПоступленийПредварительный;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 38.
		|УНИЧТОЖИТЬ ТаблицаПоступлений;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 39.
		|УНИЧТОЖИТЬ ТаблицаВозвратовПоставщикамПредварительный;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 40.
		|УНИЧТОЖИТЬ ТаблицаВозвратовПоставщикам;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 41.
		|УНИЧТОЖИТЬ ТаблицаБанковскихВыписок;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 42.
		|УНИЧТОЖИТЬ ПоступленияПрочихУслугИАктивовПредварительные;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 43.
		|УНИЧТОЖИТЬ ТаблицаПоступленийУслугИПрочихАктивовПредварительная;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 44.
		|УНИЧТОЖИТЬ ТаблицаУслугиИПрочиеАктивы;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 45.
		|УНИЧТОЖИТЬ ТаблицаНаличныеДенежныеСредста;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 46.
		|УНИЧТОЖИТЬ АвансовыеОтчетыПрочиеРасходыПредварительные;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 47.
		|УНИЧТОЖИТЬ ТаблицаАвансовыеОтчетыПрочиеРасходыПредварительная;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 48.
		|УНИЧТОЖИТЬ ТаблицаАвансовыеОтчетыПрочиеАктивы;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 49.
		|ВЫБРАТЬ
		|	ТаблицаРасчетаКурсов.Дата 					КАК Дата,
		|	ТаблицаРасчетаКурсов.Ссылка 				КАК Ссылка,
		|	ВЫБОР
		|		КОГДА ТаблицаРасчетаКурсов.Ссылка ССЫЛКА Документ.РеализацияТоваровУслуг
		|			ТОГДА ВЫРАЗИТЬ(ТаблицаРасчетаКурсов.Ссылка КАК Документ.РеализацияТоваровУслуг).Представление
		|		КОГДА ТаблицаРасчетаКурсов.Ссылка ССЫЛКА Документ.ВозвратТоваровОтКлиента
		|			ТОГДА ВЫРАЗИТЬ(ТаблицаРасчетаКурсов.Ссылка КАК Документ.ВозвратТоваровОтКлиента).Представление
		|		КОГДА ТаблицаРасчетаКурсов.Ссылка ССЫЛКА Документ.АвансовыйОтчет
		|			ТОГДА ВЫРАЗИТЬ(ТаблицаРасчетаКурсов.Ссылка КАК Документ.АвансовыйОтчет).Представление
		|		КОГДА ТаблицаРасчетаКурсов.Ссылка ССЫЛКА Документ.ПоступлениеТоваровУслуг
		|			ТОГДА ВЫРАЗИТЬ(ТаблицаРасчетаКурсов.Ссылка КАК Документ.ПоступлениеТоваровУслуг).Представление
		|		КОГДА ТаблицаРасчетаКурсов.Ссылка ССЫЛКА Документ.ВозвратТоваровПоставщику
		|			ТОГДА ВЫРАЗИТЬ(ТаблицаРасчетаКурсов.Ссылка КАК Документ.ВозвратТоваровПоставщику).Представление
		|		КОГДА ТаблицаРасчетаКурсов.Ссылка ССЫЛКА Документ.ПоступлениеУслугПрочихАктивов
		|			ТОГДА ВЫРАЗИТЬ(ТаблицаРасчетаКурсов.Ссылка КАК Документ.ПоступлениеУслугПрочихАктивов).Представление
		|		КОГДА ТаблицаРасчетаКурсов.Ссылка ССЫЛКА Документ.ПриходныйКассовыйОрдер
		|			ТОГДА ВЫРАЗИТЬ(ТаблицаРасчетаКурсов.Ссылка КАК Документ.ПриходныйКассовыйОрдер).Представление
		|		КОГДА ТаблицаРасчетаКурсов.Ссылка ССЫЛКА Документ.РасходныйКассовыйОрдер
		|			ТОГДА ВЫРАЗИТЬ(ТаблицаРасчетаКурсов.Ссылка КАК Документ.РасходныйКассовыйОрдер).Представление
		|	КОНЕЦ КАК Представление,
		|	ТаблицаРасчетаКурсов.СуммаУпр				КАК СуммаДвижения,
		|	&ВалютаУправленческогоУчета					КАК ВалютаДвижения,
		|	ТаблицаРасчетаКурсов.СуммаДокумента 		КАК СуммаДокумента,
		|	ТаблицаРасчетаКурсов.Валюта 				КАК ВалютаДокумента,
		|	ВЫРАЗИТЬ(	ВЫБОР
		|					КОГДА &ВалютаУправленческогоУчета = ТаблицаРасчетаКурсов.Валюта
		|					ТОГДА ТаблицаРасчетаКурсов.СуммаДокумента
		|					ИНАЧЕ ТаблицаРасчетаКурсов.СуммаДокумента * ТаблицаКурсовДок.Курс 
		|				КОНЕЦ / ТаблицаРасчетаКурсов.СуммаУпр КАК ЧИСЛО(15, 4))	КАК КурсДокумента,
		|	ТаблицаКурсовуУпр.Курс 												КАК КурсФактический,
		|	1																	КАК ИндексКартинки
		|ИЗ
		|	ТаблицаРасчетаКурсов КАК ТаблицаРасчетаКурсов
		|	
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсовуУпр
		|		ПО 	ТаблицаКурсовуУпр.Валюта = &ВалютаУправленческогоУчета
		|		И 	ТаблицаРасчетаКурсов.Дата >= ТаблицаКурсовуУпр.НачалоПериода
		|		И 	ТаблицаРасчетаКурсов.Дата < ТаблицаКурсовуУпр.КонецПериода
		|		
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсовДок
		|		ПО 	ТаблицаРасчетаКурсов.Валюта = ТаблицаКурсовДок.Валюта
		|		И 	ТаблицаРасчетаКурсов.Дата >= ТаблицаКурсовДок.НачалоПериода
		|		И 	ТаблицаРасчетаКурсов.Дата < ТаблицаКурсовДок.КонецПериода
		|		
		|ГДЕ
		|	ВЫРАЗИТЬ(ТаблицаРасчетаКурсов.СуммаДокументаУпр КАК ЧИСЛО(15,2)) <> ТаблицаРасчетаКурсов.СуммаУпр
		|И	ВЫРАЗИТЬ(	ВЫБОР
		|					КОГДА &ВалютаУправленческогоУчета = ТаблицаРасчетаКурсов.Валюта
		|					ТОГДА ТаблицаРасчетаКурсов.СуммаДокумента
		|					ИНАЧЕ ТаблицаРасчетаКурсов.СуммаДокумента * ТаблицаКурсовДок.Курс 
		|				КОНЕЦ / ТаблицаРасчетаКурсов.СуммаУпр КАК ЧИСЛО(15, 2)) <> ВЫРАЗИТЬ(ТаблицаКурсовуУпр.Курс КАК ЧИСЛО(15, 2)) 
		|	
		|УПОРЯДОЧИТЬ ПО
		|	ТаблицаРасчетаКурсов.СуммаДокумента УБЫВ
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 50.
		|ВЫБРАТЬ
		|	СУММА(ТаблицаРасчетаКурсов.СуммаДокумента / ТаблицаКурсовуУпр.Курс - ТаблицаРасчетаКурсов.СуммаУпр) КАК КурсоваяРазница
		|ИЗ
		|	ТаблицаРасчетаКурсов КАК ТаблицаРасчетаКурсов
		|	
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсовуУпр
		|		ПО 	ТаблицаКурсовуУпр.Валюта = &ВалютаУправленческогоУчета
		|		И 	ТаблицаРасчетаКурсов.Дата >= ТаблицаКурсовуУпр.НачалоПериода
		|		И 	ТаблицаРасчетаКурсов.Дата < ТаблицаКурсовуУпр.КонецПериода
		|		
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсовДок
		|		ПО 	ТаблицаРасчетаКурсов.Валюта = ТаблицаКурсовДок.Валюта
		|		И 	ТаблицаРасчетаКурсов.Дата >= ТаблицаКурсовДок.НачалоПериода
		|		И 	ТаблицаРасчетаКурсов.Дата < ТаблицаКурсовДок.КонецПериода
		|		
		|ГДЕ
		|	ТаблицаРасчетаКурсов.СуммаДокументаУпр <> ТаблицаРасчетаКурсов.СуммаУпр
		|И	ВЫРАЗИТЬ(	ВЫБОР
		|					КОГДА &ВалютаУправленческогоУчета = ТаблицаРасчетаКурсов.Валюта
		|					ТОГДА ТаблицаРасчетаКурсов.СуммаДокумента
		|					ИНАЧЕ ТаблицаРасчетаКурсов.СуммаДокумента * ТаблицаКурсовДок.Курс 
		|				КОНЕЦ / ТаблицаРасчетаКурсов.СуммаУпр КАК ЧИСЛО(15, 4)) <> ТаблицаКурсовуУпр.Курс 
		|;
		//////////////////////////////////////////////////////////////////
		// 51. Получаем отрицательные остатки товаров организации
		|ВЫБРАТЬ
		|	Себестоимость.РазделУчета				КАК РазделУчета,
		|	Себестоимость.ВидЗапасов 				КАК ВидЗапасов,
		|	Себестоимость.Организация 				КАК Организация,
		|	СУММА(Себестоимость.КоличествоОстаток) 	КАК Количество,
		|	АналитикаНоменклатуры.Номенклатура 		КАК Номенклатура,
		|	АналитикаНоменклатуры.Характеристика 	КАК Характеристика,
		|	АналитикаНоменклатуры.Склад 			КАК Склад
		|ИЗ
		|	РегистрНакопления.СебестоимостьТоваров.Остатки(&ДатаОкончания, ) КАК Себестоимость
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаНоменклатуры КАК АналитикаНоменклатуры
		|		ПО Себестоимость.АналитикаУчетаНоменклатуры = АналитикаНоменклатуры.КлючАналитики
		|ГДЕ
		|	Себестоимость.КоличествоОстаток < 0
		|
		|СГРУППИРОВАТЬ ПО
		|	АналитикаНоменклатуры.Характеристика,
		|	Себестоимость.РазделУчета,
		|	Себестоимость.ВидЗапасов,
		|	Себестоимость.Организация,
		|	АналитикаНоменклатуры.Номенклатура,
		|	АналитикаНоменклатуры.Склад
		|;
		//////////////////////////////////////////////////////////////////
		// 52. Проверка «Валовой прибыли» на 100% рентабельности
		|ВЫБРАТЬ
		|	Продажи.Регистратор						КАК Регистратор,
		|	АналитикаНоменклатуры.Номенклатура 		КАК Номенклатура,
		|	АналитикаНоменклатуры.Характеристика 	КАК Характеристика,
		|	Продажи.КоличествоОборот             	КАК Количество,
		|	Продажи.СуммаВыручкиОборот           	КАК Выручка,
		|	ВЫБОР
		|		КОГДА Продажи.ТипЗапасов = ЗНАЧЕНИЕ(Перечисление.ТипыЗапасов.КомиссионныйТовар) 
		|			ТОГДА Продажи.СуммаВыручкиОборот
		|		КОГДА ЕСТЬNULL(РасчетСебестоимости.Ссылка.ПредварительныйРасчет, ЛОЖЬ) 
		|			ТОГДА ВЫРАЗИТЬ(Продажи.КоличествоОборот * ЕСТЬNULL(СтоимостьНоменклатуры.Стоимость, 0) КАК ЧИСЛО(15, 2))
		|		ИНАЧЕ Продажи.СебестоимостьОборот
		|	КОНЕЦ КАК Себестоимость,
		|	ВЫБОР
		|		КОГДА Продажи.ТипЗапасов = ЗНАЧЕНИЕ(Перечисление.ТипыЗапасов.КомиссионныйТовар) 
		|			ТОГДА 0
		|		КОГДА ЕСТЬNULL(РасчетСебестоимости.Ссылка.ПредварительныйРасчет, ЛОЖЬ) 
		|			ТОГДА ВЫРАЗИТЬ(Продажи.КоличествоОборот * ЕСТЬNULL(СтоимостьНоменклатуры.СтоимостьДопРасходы, 0) КАК ЧИСЛО(15, 2))
		|		ИНАЧЕ Продажи.СуммаДополнительныхРасходовОборот
		|	КОНЕЦ КАК ДопРасходы
		|ПОМЕСТИТЬ ДокументыРентабельности
		|ИЗ
		|	РегистрНакопления.ВыручкаИСебестоимостьПродаж.Обороты(&ДатаНачала, &ДатаОкончания, Авто, АналитикаУчетаНоменклатуры.Номенклатура.ТипНоменклатуры = &ТипНоменклатуры) КАК Продажи
		|	
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаНоменклатуры КАК АналитикаНоменклатуры
		|		ПО Продажи.АналитикаУчетаНоменклатуры = АналитикаНоменклатуры.КлючАналитики
		|		
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаПоПартнерам КАК АналитикаПоПартнерам
		|		ПО Продажи.АналитикаУчетаПоПартнерам = АналитикаПоПартнерам.КлючАналитики
		|		
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.РасчетСебестоимостиТоваров.Организации КАК РасчетСебестоимости
		|		ПО (НАЧАЛОПЕРИОДА(Продажи.ПериодМесяц, МЕСЯЦ) = НАЧАЛОПЕРИОДА(РасчетСебестоимости.Ссылка.Дата, МЕСЯЦ)) 
		|			И (АналитикаПоПартнерам.Организация       = РасчетСебестоимости.Организация)
		|			И (РасчетСебестоимости.Ссылка.Проведен)
		|			
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СтоимостьТоваров КАК СтоимостьНоменклатуры
		|		ПО Продажи.АналитикаУчетаНоменклатуры   = СтоимостьНоменклатуры.АналитикаУчетаНоменклатуры
		|			И (АналитикаПоПартнерам.Организация = СтоимостьНоменклатуры.Организация)
		|			И (Продажи.ВидЗапасов               = СтоимостьНоменклатуры.ВидЗапасов)
		|			И (СтоимостьНоменклатуры.Период     = НАЧАЛОПЕРИОДА(Продажи.ПериодМесяц,МЕСЯЦ))
		//|ГДЕ
		//|	АналитикаПоПартнерам.Партнер <> ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)
		|;
		//////////////////////////////////////////////////////////////////
		// 53.
		|ВЫБРАТЬ
		|	Номенклатура 			КАК Номенклатура,
		|	Характеристика 			КАК Характеристика,
		|	СУММА(Количество)		КАК Количество,
		|	СУММА(Выручка) 			КАК Выручка,
		|	СУММА(Себестоимость) 	КАК Себестоимость,
		|	СУММА(ДопРасходы) 		КАК ДопРасходы,
		|	ВЫБОР
		|		КОГДА СУММА(Выручка) = 0 
		|			ТОГДА 0
		|		ИНАЧЕ
		|			ВЫРАЗИТЬ((СУММА(Выручка)-СУММА(Себестоимость)-СУММА(ДопРасходы))/СУММА(Выручка)*100 КАК ЧИСЛО(15,2))
		|	КОНЕЦ КАК Рентабельность
		|ПОМЕСТИТЬ ДанныеРентабельности
		|ИЗ
		|	ДокументыРентабельности
		|	
		|СГРУППИРОВАТЬ ПО
		|	Номенклатура,
		|	Характеристика
		|;
		//////////////////////////////////////////////////////////////////
		// 54.
		|ВЫБРАТЬ
		|	Номенклатура 	КАК Номенклатура,
		|	Характеристика  КАК Характеристика,
		|	Количество		КАК Количество,
		|	Выручка			КАК Выручка,
		|	Себестоимость	КАК Себестоимость,
		|	ДопРасходы		КАК ДопРасходы,
		|	Рентабельность	КАК Рентабельность
		|ИЗ
		|	ДанныеРентабельности
		|ГДЕ
		|	Рентабельность >= 100 И Количество > 0
		|;
		//////////////////////////////////////////////////////////////////
		// 55, 56.
		|УНИЧТОЖИТЬ ДокументыРентабельности;
		|УНИЧТОЖИТЬ ДанныеРентабельности;
		//////////////////////////////////////////////////////////////////
		// 57. Проверка «Анализ себестоимости товаров» на «Стоимость конечный остаток» > 0 И «Количество конечный остаток» = 0
		//  И «Стоимость конечный остаток» = 0 И «Количество конечный остаток» > 0
		|ВЫБРАТЬ
		|	АналитикаНоменклатуры.Номенклатура 						КАК Номенклатура,
		|	АналитикаНоменклатуры.Характеристика    				КАК Характеристика,
		|	УчетСебестоимости.Организация							КАК Организация,
		|	
		|	УчетСебестоимости.КоличествоНачальныйОстаток 			КАК КоличествоНачальныйОстаток,
		|	УчетСебестоимости.КоличествоПриход 						КАК КоличествоПриход,
		|	УчетСебестоимости.КоличествоРасход 						КАК КоличествоРасход,
		|	УчетСебестоимости.КоличествоКонечныйОстаток  			КАК КоличествоКонечныйОстаток,
		|	
		|	УчетСебестоимости.СтоимостьНачальныйОстаток 
		|	+ УчетСебестоимости.СуммаДопРасходовНачальныйОстаток	КАК СебестоимостьНачальныйОстаток,
		|	
		|	УчетСебестоимости.СтоимостьКонечныйОстаток
		|	+ УчетСебестоимости.СуммаДопРасходовКонечныйОстаток		КАК СебестоимостьКонечныйОстаток,
		|	
		|	УчетСебестоимости.СтоимостьПриход
		|	+ УчетСебестоимости.СуммаДопРасходовПриход				КАК СебестоимостьПриход,
		|	
		|	УчетСебестоимости.СтоимостьРасход
		|	+ УчетСебестоимости.СуммаДопРасходовРасход				КАК СебестоимостьРасход
		|ПОМЕСТИТЬ ТаблицаСебестоимости	
		|ИЗ
		|	РегистрНакопления.СебестоимостьТоваров.ОстаткиИОбороты(&ДатаНачала, &ДатаОкончания, Авто, ,) КАК УчетСебестоимости
		|		
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаНоменклатуры КАК АналитикаНоменклатуры
		|ПО УчетСебестоимости.АналитикаУчетаНоменклатуры = АналитикаНоменклатуры.КлючАналитики
		|;
		//////////////////////////////////////////////////////////////////
		// 58.
		|ВЫБРАТЬ
		|	Номенклатура 					КАК Номенклатура,
		|	Характеристика    				КАК Характеристика,
		|	Организация						КАК Организация,
		|	КоличествоНачальныйОстаток 		КАК КоличествоНачальныйОстаток,
		|	КоличествоПриход 				КАК КоличествоПриход,
		|	КоличествоРасход 				КАК КоличествоРасход,
		|	КоличествоКонечныйОстаток  		КАК КоличествоКонечныйОстаток,
		|	СебестоимостьНачальныйОстаток	КАК СебестоимостьНачальныйОстаток,
		|	СебестоимостьКонечныйОстаток	КАК СебестоимостьКонечныйОстаток,
		|	СебестоимостьПриход				КАК СебестоимостьПриход,
		|	СебестоимостьРасход				КАК СебестоимостьРасход
		|ИЗ
		|	ТаблицаСебестоимости
		|ГДЕ
		|	СебестоимостьКонечныйОстаток > 0 И КоличествоКонечныйОстаток = 0
		|	
		|ОБЪЕДИНИТЬ ВСЕ

		|ВЫБРАТЬ
		|	Номенклатура 					КАК Номенклатура,
		|	Характеристика    				КАК Характеристика,
		|	Организация						КАК Организация,
		|	КоличествоНачальныйОстаток 		КАК КоличествоНачальныйОстаток,
		|	КоличествоПриход 				КАК КоличествоПриход,
		|	КоличествоРасход 				КАК КоличествоРасход,
		|	КоличествоКонечныйОстаток  		КАК КоличествоКонечныйОстаток,
		|	СебестоимостьНачальныйОстаток	КАК СебестоимостьНачальныйОстаток,
		|	СебестоимостьКонечныйОстаток	КАК СебестоимостьКонечныйОстаток,
		|	СебестоимостьПриход				КАК СебестоимостьПриход,
		|	СебестоимостьРасход				КАК СебестоимостьРасход
		|ИЗ
		|	ТаблицаСебестоимости
		|ГДЕ
		|	СебестоимостьКонечныйОстаток = 0 И КоличествоКонечныйОстаток > 0
		|;
		//////////////////////////////////////////////////////////////////
		// 59, 60.
		|УНИЧТОЖИТЬ ТаблицаСебестоимости;
		|УНИЧТОЖИТЬ ТаблицаРасчетаКурсов;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 61.
		|ВЫБРАТЬ
		|	Вложенный.Партнер,
		|	Вложенный.Организация,
		|	Вложенный.Валюта,
		|	СУММА(Вложенный.ДолгПартнера) КАК ДолгПартнера,
		|	СУММА(Вложенный.НашДолг) КАК НашДолг
		|ПОМЕСТИТЬ КешВсеРасчеты
		|ИЗ
		|	(ВЫБРАТЬ
		|		РасчетыСКлиентамиОстатки.АналитикаУчетаПоПартнерам.Партнер КАК Партнер,
		|		РасчетыСКлиентамиОстатки.АналитикаУчетаПоПартнерам.Организация КАК Организация,
		|		РасчетыСКлиентамиОстатки.ЗаказКлиента КАК ЗаказКлиента,
		|		РасчетыСКлиентамиОстатки.Валюта КАК Валюта,
		|		ВЫБОР
		|			КОГДА РасчетыСКлиентамиОстатки.СуммаОстаток >= 0
		|				ТОГДА РасчетыСКлиентамиОстатки.СуммаОстаток
		|			ИНАЧЕ 0
		|		КОНЕЦ КАК ДолгПартнера,
		|		-ВЫБОР
		|			КОГДА РасчетыСКлиентамиОстатки.СуммаОстаток < 0
		|				ТОГДА РасчетыСКлиентамиОстатки.СуммаОстаток
		|			ИНАЧЕ 0
		|		КОНЕЦ КАК НашДолг
		|	ИЗ
		|		РегистрНакопления.РасчетыСКлиентами.Остатки(, АналитикаУчетаПоПартнерам.Партнер <> ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)) КАК РасчетыСКлиентамиОстатки
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		РасчетыСПоставщикамиОстатки.АналитикаУчетаПоПартнерам.Партнер,
		|		РасчетыСПоставщикамиОстатки.АналитикаУчетаПоПартнерам.Организация,
		|		РасчетыСПоставщикамиОстатки.ЗаказПоставщику,
		|		РасчетыСПоставщикамиОстатки.Валюта,
		|		ВЫБОР
		|			КОГДА РасчетыСПоставщикамиОстатки.СуммаОстаток >= 0
		|				ТОГДА РасчетыСПоставщикамиОстатки.СуммаОстаток
		|			ИНАЧЕ 0
		|		КОНЕЦ,
		|		-ВЫБОР
		|			КОГДА РасчетыСПоставщикамиОстатки.СуммаОстаток < 0
		|				ТОГДА РасчетыСПоставщикамиОстатки.СуммаОстаток
		|			ИНАЧЕ 0
		|		КОНЕЦ
		|	ИЗ
		|		РегистрНакопления.РасчетыСПоставщиками.Остатки(, АналитикаУчетаПоПартнерам.Партнер <> ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)) КАК РасчетыСПоставщикамиОстатки
		|	) КАК Вложенный
		|
		|СГРУППИРОВАТЬ ПО
		|	Вложенный.Организация,
		|	Вложенный.Партнер,
		|	Вложенный.Валюта
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 62.
		|ВЫБРАТЬ
		|	КешВсеРасчеты.Партнер,
		|	КешВсеРасчеты.Организация,
		|	КешВсеРасчеты.Валюта,
		|	КешВсеРасчеты.ДолгПартнера,
		|	КешВсеРасчеты.НашДолг
		|ИЗ
		|	КешВсеРасчеты КАК КешВсеРасчеты
		|ГДЕ
		|	НЕ (КешВсеРасчеты.ДолгПартнера <> 0
		|		И КешВсеРасчеты.НашДолг =0)
		|	И НЕ (КешВсеРасчеты.ДолгПартнера  = 0
		|		И КешВсеРасчеты.НашДолг <> 0)
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 63.
		|УНИЧТОЖИТЬ КешВсеРасчеты;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 64.
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	РасчетыСКлиентами.АналитикаУчетаПоПартнерам,
		|	РасчетыСКлиентами.АналитикаУчетаПоПартнерам.Организация КАК Продавец,
		|	ВЫРАЗИТЬ(РасчетыСКлиентами.АналитикаУчетаПоПартнерам.Контрагент КАК Справочник.Организации) КАК Покупатель,
		|	РасчетыСКлиентами.Валюта КАК ВалютаВзаиморасчетов,
		|	ВЫБОР
		|		КОГДА РасчетыСКлиентами.Регистратор = НЕОПРЕДЕЛЕНО
		|			ТОГДА NULL
		|		ИНАЧЕ РасчетыСКлиентами.Регистратор
		|	КОНЕЦ КАК Документ,
		|	РасчетыСКлиентами.Регистратор.Дата КАК Дата
		|ПОМЕСТИТЬ КешДокНеВернаяВалютаВзаемоРасчета
		|ИЗ
		|	РегистрНакопления.РасчетыСКлиентами.ОстаткиИОбороты(
		|			,
		|			,
		|			Авто,
		|			,
		|			АналитикаУчетаПоПартнерам.Партнер = ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)
		|				И Валюта <> &ВалютаУправленческогоУчета) КАК РасчетыСКлиентами
		|		
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаПоПартнерам КАК РегистрАналитикаУчетаПоПартнерам
		|ПО РасчетыСКлиентами.АналитикаУчетаПоПартнерам = РегистрАналитикаУчетаПоПартнерам.КлючАналитики
        |
		|ОБЪЕДИНИТЬ ВСЕ
        |
		|ВЫБРАТЬ
		|	РасчетыСПоставщиками.АналитикаУчетаПоПартнерам,
		|	РегистрАналитикаУчетаПоПартнерам.Организация,
		|	ВЫРАЗИТЬ(РегистрАналитикаУчетаПоПартнерам.Контрагент КАК Справочник.Организации),
		|	РасчетыСПоставщиками.Валюта,
		|	ВЫБОР
		|		КОГДА РасчетыСПоставщиками.Регистратор = НЕОПРЕДЕЛЕНО
		|			ТОГДА NULL
		|		ИНАЧЕ РасчетыСПоставщиками.Регистратор
		|	КОНЕЦ,
		|	РасчетыСПоставщиками.Регистратор.Дата
		|ИЗ
		|	РегистрНакопления.РасчетыСПоставщиками.ОстаткиИОбороты(
		|			,
		|			,
		|			Авто,
		|			,
		|			АналитикаУчетаПоПартнерам.Партнер = ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)
		|				И Валюта <> &ВалютаУправленческогоУчета) КАК РасчетыСПоставщиками
		|		
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаПоПартнерам КАК РегистрАналитикаУчетаПоПартнерам
		|ПО РасчетыСПоставщиками.АналитикаУчетаПоПартнерам = РегистрАналитикаУчетаПоПартнерам.КлючАналитики
		|;
        //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 65.
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	РасчетыСПоставщиками.Период,
		|	ВЫРАЗИТЬ(РасчетыСПоставщиками.Регистратор КАК Документ.РасходныйКассовыйОрдер) КАК Документ,
		|	РасчетыСПоставщиками.Валюта КАК ВалютаВзаиморасчетов,
		|	РасходныйКассовыйОрдерРасшифровкаПлатежа.СуммаВзаиморасчетов КАК СуммаУпрУч,
		|	РасходныйКассовыйОрдерРасшифровкаПлатежа.Сумма КАК СуммаРеглУч,
		|	ТаблицаКурсов.Курс КАК Курс,
		|	ВЫРАЗИТЬ(РасходныйКассовыйОрдерРасшифровкаПлатежа.Сумма / РасходныйКассовыйОрдерРасшифровкаПлатежа.СуммаВзаиморасчетов КАК ЧИСЛО(15, 3)) КАК КурсДокумента,
		|	ВЫРАЗИТЬ(РасходныйКассовыйОрдерРасшифровкаПлатежа.Сумма / ТаблицаКурсов.Курс КАК ЧИСЛО(15, 2)) КАК СуммаУпрУчСВернымКурсом
		|ПОМЕСТИТЬ КешТаблицаРКО
		|ИЗ
		|	РегистрНакопления.РасчетыСПоставщиками.Обороты(
		|			&ДатаНачала,
		|			&ДатаОкончания,
		|			Регистратор,
		|			АналитикаУчетаПоПартнерам.Партнер = ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)
		|			И Валюта = &ВалютаУправленческогоУчета
		|			И ЗаказПоставщику = НЕОПРЕДЕЛЕНО
		|													) КАК РасчетыСПоставщиками
		|
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.РасходныйКассовыйОрдер.РасшифровкаПлатежа КАК РасходныйКассовыйОрдерРасшифровкаПлатежа
		|ПО (ВЫРАЗИТЬ(РасчетыСПоставщиками.Регистратор КАК Документ.РасходныйКассовыйОрдер) = РасходныйКассовыйОрдерРасшифровкаПлатежа.Ссылка)
		|И РасчетыСПоставщиками.Валюта = РасходныйКассовыйОрдерРасшифровкаПлатежа.ВалютаВзаиморасчетов
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсов
		|ПО РасчетыСПоставщиками.Валюта = ТаблицаКурсов.Валюта
		|И РасчетыСПоставщиками.Период < ТаблицаКурсов.КонецПериода
		|И РасчетыСПоставщиками.Период >= ТаблицаКурсов.НачалоПериода
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	РасчетыСПоставщиками.Период,
		|	ВЫРАЗИТЬ(РасчетыСПоставщиками.Регистратор КАК Документ.СписаниеБезналичныхДенежныхСредств),
		|	РасчетыСПоставщиками.Валюта,
		|	СписаниеБезналичныхДенежныхСредствРасшифровкаПлатежа.СуммаВзаиморасчетов,
		|	СписаниеБезналичныхДенежныхСредствРасшифровкаПлатежа.Сумма,
		|	ТаблицаКурсов.Курс,
		|	ВЫРАЗИТЬ(СписаниеБезналичныхДенежныхСредствРасшифровкаПлатежа.Сумма / СписаниеБезналичныхДенежныхСредствРасшифровкаПлатежа.СуммаВзаиморасчетов КАК ЧИСЛО(15, 3)),
		|	ВЫРАЗИТЬ(СписаниеБезналичныхДенежныхСредствРасшифровкаПлатежа.Сумма / ТаблицаКурсов.Курс КАК ЧИСЛО(15, 2))
		|ИЗ
		|	РегистрНакопления.РасчетыСПоставщиками.Обороты(
		|			&ДатаНачала,
		|			&ДатаОкончания,
		|			Регистратор,
		|			АналитикаУчетаПоПартнерам.Партнер = ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)
		|			И Валюта = &ВалютаУправленческогоУчета
		|			И ЗаказПоставщику = НЕОПРЕДЕЛЕНО
		|												) КАК РасчетыСПоставщиками
		|
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.СписаниеБезналичныхДенежныхСредств.РасшифровкаПлатежа КАК СписаниеБезналичныхДенежныхСредствРасшифровкаПлатежа
		|ПО РасчетыСПоставщиками.Валюта = СписаниеБезналичныхДенежныхСредствРасшифровкаПлатежа.ВалютаВзаиморасчетов
		|И (ВЫРАЗИТЬ(РасчетыСПоставщиками.Регистратор КАК Документ.СписаниеБезналичныхДенежныхСредств) = СписаниеБезналичныхДенежныхСредствРасшифровкаПлатежа.Ссылка)
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсов
		|ПО РасчетыСПоставщиками.Валюта = ТаблицаКурсов.Валюта
		|И РасчетыСПоставщиками.Период < ТаблицаКурсов.КонецПериода
		|И РасчетыСПоставщиками.Период >= ТаблицаКурсов.НачалоПериода
		|;
        /// 66.
		////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	КешДокНеВернаяВалютаВзаемоРасчета.Дата,
		|	КешДокНеВернаяВалютаВзаемоРасчета.ВалютаВзаиморасчетов,
		|	КешДокНеВернаяВалютаВзаемоРасчета.Документ,
		|	СРЕДНЕЕ(ВЫРАЗИТЬ(ТаблицаКурсовНеВерныйВалюты.Курс / ТаблицаКурсовУправУчета.Курс КАК ЧИСЛО(15, 4))) КАК КурсВзаиморасчетов
		|ИЗ
		|	КешДокНеВернаяВалютаВзаемоРасчета КАК КешДокНеВернаяВалютаВзаемоРасчета
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсовНеВерныйВалюты
		|		ПО КешДокНеВернаяВалютаВзаемоРасчета.ВалютаВзаиморасчетов = ТаблицаКурсовНеВерныйВалюты.Валюта
		|			И КешДокНеВернаяВалютаВзаемоРасчета.Дата < ТаблицаКурсовНеВерныйВалюты.КонецПериода
		|			И КешДокНеВернаяВалютаВзаемоРасчета.Дата >= ТаблицаКурсовНеВерныйВалюты.НачалоПериода
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсовУправУчета
		|		ПО КешДокНеВернаяВалютаВзаемоРасчета.Дата >= ТаблицаКурсовУправУчета.НачалоПериода
		|			И КешДокНеВернаяВалютаВзаемоРасчета.Дата < ТаблицаКурсовУправУчета.КонецПериода
		|			И (&ВалютаУправленческогоУчета = ТаблицаКурсовУправУчета.Валюта)
        |СГРУППИРОВАТЬ ПО
		|	КешДокНеВернаяВалютаВзаемоРасчета.ВалютаВзаиморасчетов,
		|	КешДокНеВернаяВалютаВзаемоРасчета.Документ,
		|	КешДокНеВернаяВалютаВзаемоРасчета.Дата
       	|ОБЪЕДИНИТЬ ВСЕ
        |ВЫБРАТЬ
		|	КешТаблицаРКО.Период,
		|	КешТаблицаРКО.ВалютаВзаиморасчетов,
		|	КешТаблицаРКО.Документ,
		|	КешТаблицаРКО.Курс
		|ИЗ
		|	КешТаблицаРКО КАК КешТаблицаРКО
		|ГДЕ
		|	КешТаблицаРКО.СуммаУпрУч <> КешТаблицаРКО.СуммаУпрУчСВернымКурсом
		|	И КешТаблицаРКО.КурсДокумента <> 1
       	|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 67.
		|ВЫБРАТЬ
		|	ПрочиеРасходыОбороты.Регистратор КАК Ссылка,
		|	ПрочиеРасходыОбороты.Организация КАК Организация,
		|	1 КАК ИндексКартинки,
		|	ВЫРАЗИТЬ(ПрочиеРасходыОбороты.Регистратор КАК Документ.АвансовыйОтчет).Дата КАК Дата
		|ИЗ
		|	РегистрНакопления.ПрочиеРасходы.Обороты(, , Регистратор, ) КАК ПрочиеРасходыОбороты
		|ГДЕ
		|	ПрочиеРасходыОбороты.Регистратор ССЫЛКА Документ.АвансовыйОтчет
		|	И НАЧАЛОПЕРИОДА(ПрочиеРасходыОбороты.Период, ДЕНЬ) <> НАЧАЛОПЕРИОДА(ВЫРАЗИТЬ(ПрочиеРасходыОбороты.Регистратор КАК Документ.АвансовыйОтчет).Дата, ДЕНЬ)

		|ОБЪЕДИНИТЬ ВСЕ

		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	ПрочиеРасходыОбороты.Регистратор,
		|	ПрочиеРасходыОбороты.Организация,
		|	1,
		|	ВЫРАЗИТЬ(ПрочиеРасходыОбороты.Регистратор КАК Документ.СписаниеБезналичныхДенежныхСредств).Дата
		|ИЗ
		|	РегистрНакопления.ПрочиеРасходы.Обороты(, , Регистратор, ) КАК ПрочиеРасходыОбороты
		|ГДЕ
		|	ПрочиеРасходыОбороты.Регистратор ССЫЛКА Документ.СписаниеБезналичныхДенежныхСредств
		|	И ПрочиеРасходыОбороты.Регистратор.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПрочиеРасходы)
		|	И НАЧАЛОПЕРИОДА(ПрочиеРасходыОбороты.Период, ДЕНЬ) <> НАЧАЛОПЕРИОДА(ВЫРАЗИТЬ(ПрочиеРасходыОбороты.Регистратор КАК Документ.СписаниеБезналичныхДенежныхСредств).Дата, ДЕНЬ)

		|ОБЪЕДИНИТЬ ВСЕ

		|ВЫБРАТЬ
		|	ПрочиеРасходыОбороты.Регистратор,
		|	ПрочиеРасходыОбороты.Организация,
		|	1,
		|	ВЫРАЗИТЬ(ПрочиеРасходыОбороты.Регистратор КАК Документ.РасходныйКассовыйОрдер).Дата
		|ИЗ
		|	РегистрНакопления.ПрочиеРасходы.Обороты(, , Регистратор, ) КАК ПрочиеРасходыОбороты
		|ГДЕ
		|	ПрочиеРасходыОбороты.Регистратор ССЫЛКА Документ.РасходныйКассовыйОрдер
		|	И ПрочиеРасходыОбороты.Регистратор.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПрочиеРасходы)
		|	И НАЧАЛОПЕРИОДА(ПрочиеРасходыОбороты.Период, ДЕНЬ) <> НАЧАЛОПЕРИОДА(ВЫРАЗИТЬ(ПрочиеРасходыОбороты.Регистратор КАК Документ.РасходныйКассовыйОрдер).Дата, ДЕНЬ)

		|УПОРЯДОЧИТЬ ПО
		|	Дата		
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 68. Проверка документов «Поступление прочих услуг и активов» на хозяйственную операцию «Поступление услуг»
		|ВЫБРАТЬ
		|	Дата		КАК Дата,
		|	Ссылка 		КАК Ссылка,
		|	Организация	КАК Организация,
		|	1			КАК ИндексКартинки
		|ИЗ
		|	Документ.ПоступлениеУслугПрочихАктивов
		|ГДЕ
		|	Проведен
		|	И Дата >= &ДатаНачала
		|	И Дата <= &ДатаОкончания
		|	И ХозяйственнаяОперация <> ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ЗакупкаУПоставщика)
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 69.   Проверка себестоимости в документах "Передачи между организациями"
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	НАЧАЛОПЕРИОДА(Период, ДЕНЬ) 												КАК Дата,
		|	АналитикаУчетаНоменклатуры.Номенклатура 									КАК Номенклатура,
		|	АналитикаУчетаПоПартнерам.Организация 										КАК ОрганизацияОтправитель,
		|	КоличествоОборот 															КАК Количество,
		|	СуммаВыручкиОборот 															КАК Сумма,
		|	ВЫРАЗИТЬ(СебестоимостьОборот / КоличествоОборот КАК ЧИСЛО(15, 2))			КАК Себестоимость,
		|	АналитикаУчетаНоменклатуры													КАК АналитикаУчетаНоменклатуры,
		|	АналитикаУчетаПоПартнерам													КАК АналитикаУчетаПоПартнерам
		|ПОМЕСТИТЬ КешЦеныНоменклатуры
		|ИЗ
		|	РегистрНакопления.ВыручкаИСебестоимостьПродаж.Обороты(&ГраницаНачало, &ГраницаОкончания, ДЕНЬ, АналитикаУчетаПоПартнерам.Партнер = ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие))
		|ГДЕ
		|	КоличествоОборот <> 0
		|	И СебестоимостьОборот <> 0
		|	И СебестоимостьОборот <> СуммаВыручкиОборот
		|;
        //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 70. 
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	Продажи.Регистратор 																КАК Ссылка,
		|	ПРЕДСТАВЛЕНИЕССЫЛКИ(Продажи.Регистратор) 											КАК Представление,
		|	1 																					КАК ИндексКартинки
		|ИЗ
		|	РегистрНакопления.ВыручкаИСебестоимостьПродаж.Обороты(&ГраницаНачало, &ГраницаОкончания, АВТО, АналитикаУчетаПоПартнерам.Партнер = ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)) КАК Продажи
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ КешЦеныНоменклатуры КАК КешЦеныНоменклатуры
		|		ПО Продажи.АналитикаУчетаНоменклатуры = КешЦеныНоменклатуры.АналитикаУчетаНоменклатуры
		|			И Продажи.АналитикаУчетаПоПартнерам = КешЦеныНоменклатуры.АналитикаУчетаПоПартнерам
		|			И (НАЧАЛОПЕРИОДА(ВЫРАЗИТЬ(Продажи.Регистратор КАК Документ.ПередачаТоваровМеждуОрганизациями).Дата, ДЕНЬ) = КешЦеныНоменклатуры.Дата)
		|ГДЕ
		|	Продажи.Регистратор ССЫЛКА Документ.ПередачаТоваровМеждуОрганизациями
		|	И Продажи.СебестоимостьОборот <> Продажи.СуммаВыручкиОборот
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 71.
		|ВЫБРАТЬ
		|  	РасчетыСПоставщиками.АналитикаУчетаПоПартнерам.Организация 	КАК Организация,
		|	РасчетыСПоставщиками.Регистратор							КАК Ссылка,
		|	РасчетыСПоставщиками.СуммаОборот	
		|ИЗ
		|	РегистрНакопления.РасчетыСПоставщиками.Обороты(&ДатаНачала, &ДатаОкончания, Регистратор) КАК РасчетыСПоставщиками
		|	
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.СебестоимостьТоваров КАК СебестоимостьТоваров
		|ПО	СебестоимостьТоваров.Регистратор = РасчетыСПоставщиками.Регистратор
        |
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК КурсКассы
		|ПО 	КурсКассы.Валюта         = 	РасчетыСПоставщиками.Валюта
		|И	КурсКассы.НачалоПериода <= 	&ДатаОкончания
		|И	КурсКассы.КонецПериода 	>  	&ДатаОкончания 
        |
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК УпрКурс
		|ПО 	УпрКурс.Валюта 	   	 =  &ВалютаУправленческогоУчета
		|И 	УпрКурс.НачалоПериода 	<= &ДатаОкончания
		|И	УпрКурс.КонецПериода  	>  &ДатаОкончания
        |
		|ГДЕ
		|	РасчетыСПоставщиками.Регистратор Ссылка Документ.ПоступлениеТоваровУслуг
		|ИЛИ РасчетыСПоставщиками.Регистратор Ссылка Документ.ВозвратТоваровПоставщику
		| 
		|СГРУППИРОВАТЬ ПО
		|	РасчетыСПоставщиками.Регистратор,
		|  	РасчетыСПоставщиками.АналитикаУчетаПоПартнерам.Организация,
		|	РасчетыСПоставщиками.СуммаОборот,
		|	КурсКассы.Курс,	
		|	УпрКурс.Курс
		|	
		|ИМЕЮЩИЕ 
		|	(1 - СУММА(СебестоимостьТоваров.Стоимость) / 	ВЫБОР
		|														КОГДА РасчетыСПоставщиками.Регистратор Ссылка Документ.ПоступлениеТоваровУслуг
		|														ТОГДА - РасчетыСПоставщиками.СуммаОборот * КурсКассы.Курс / УпрКурс.Курс
		|														ИНАЧЕ   РасчетыСПоставщиками.СуммаОборот * КурсКассы.Курс / УпрКурс.Курс
		|													КОНЕЦ ) * 100 > 1
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 71.
		|УНИЧТОЖИТЬ КешЦеныНоменклатуры;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 72.
		|УНИЧТОЖИТЬ ТаблицаКурсов;
		|";			
	Возврат ТекстЗапроса;

КонецФункции // ПолучитьТекстЗапросаПоступленияТоваров()

// Текст запроса который заполнет все формы обраотки
// на вкладке «Исправления».
//
// Возвращаемое значение:
//  Строка - текст запроса.
//
Функция ПолучитьТекстЗапросаБаланс()

	ТекстЗапроса = "
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//0. Товары на начало периода
		|ВЫБРАТЬ
		|	Ссылка КАК Организация
		|ПОМЕСТИТЬ СпрОрганизации
		|ИЗ
		|	Справочник.Организации	
		|ГДЕ
		|	Ссылка <> ЗНАЧЕНИЕ(Справочник.Организации.УправленческаяОрганизация) 	
		|	
		|ИНДЕКСИРОВАТЬ ПО
		|	Организация	
		|;
	    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//1. Товары на начало периода
		|ВЫБРАТЬ
		|	СпрОрганизации.Организация,
		|	IsNull(СебестоимостьТоваров.СтоимостьОстаток, 0) КАК СуммаОстаток	
		|ИЗ
		|	СпрОрганизации КАК СпрОрганизации
		|			
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.СебестоимостьТоваров.Остатки(&ГраницаПредПериод) КАК СебестоимостьТоваров
		|ПО	СебестоимостьТоваров.Организация = СпрОрганизации.Организация
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//2. Товары на конец периода
		|ВЫБРАТЬ
		|	СпрОрганизации.Организация,
		|	IsNull(СебестоимостьТоваров.СтоимостьОстаток, 0) КАК СуммаОстаток	
		|ИЗ
		|	СпрОрганизации КАК СпрОрганизации
		|			
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.СебестоимостьТоваров.Остатки(&ГраницаДатаОкончания) КАК СебестоимостьТоваров
		|ПО	СебестоимостьТоваров.Организация = СпрОрганизации.Организация
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//3.
		|ВЫБРАТЬ
		|	ВЫРАЗИТЬ(КурсыВалют.Курс / КурсыВалют.Кратность КАК ЧИСЛО(15, 4)) КАК Курс,
		|	КурсыВалют.Валюта КАК Валюта,
		|	КурсыВалют.Период КАК Период
		|ПОМЕСТИТЬ КурсыВалют
		|ИЗ
		|	РегистрСведений.КурсыВалют КАК КурсыВалют
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//4.
		|ВЫБРАТЬ
		|  	КурсыВалют.Курс,
		|  	КурсыВалют.Валюта,
		|  	КурсыВалют.Период КАК НачалоПериода,
		|  	МИНИМУМ(ЕСТЬNULL(КурсыВалютКопия.Период, ДАТАВРЕМЯ(3999, 1, 1))) КАК КонецПериода
		|ПОМЕСТИТЬ ТаблицаКурсов
		|ИЗ
		|  	КурсыВалют КАК КурсыВалют
		|		
		|ЛЕВОЕ СОЕДИНЕНИЕ КурсыВалют КАК КурсыВалютКопия
		|ПО 	КурсыВалютКопия.Период > КурсыВалют.Период
		|И 	КурсыВалютКопия.Валюта = КурсыВалют.Валюта
		|			
		|СГРУППИРОВАТЬ ПО
		|  	КурсыВалют.Период,
		|  	КурсыВалют.Курс,
		|  	КурсыВалют.Валюта
		|
		|ИНДЕКСИРОВАТЬ ПО 
		|	КурсыВалют.Валюта
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//5.
		|ВЫБРАТЬ
		|	СпрОрганизации.Организация КАК Организация,
		|	IsNull(СУММА(	ВЫБОР
		|				КОГДА КурсКассы.Валюта = &ВалютаУправленческогоУчета
		|				ТОГДА НаличныеДС.СуммаОстаток
		|				ИНАЧЕ НаличныеДС.СуммаОстаток * КурсКассы.Курс / УпрКурс.Курс
		|			КОНЕЦ), 0) 	КАК СуммаОстаток
		|ИЗ
		|	СпрОрганизации КАК СпрОрганизации
		|	
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ДенежныеСредстваНаличные.Остатки(&ГраницаПредПериод) КАК НаличныеДС
		|ПО	НаличныеДС.Организация = СпрОрганизации.Организация
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК КурсКассы
		|ПО КурсКассы.Валюта     	= 	НаличныеДС.Касса.ВалютаДенежныхСредств
		|И	КурсКассы.НачалоПериода <= 	&ПредПериод
		|И	КурсКассы.КонецПериода 	>  	&ПредПериод 
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК УпрКурс
		|ПО УпрКурс.Валюта 			=  &ВалютаУправленческогоУчета
		|И 	УпрКурс.НачалоПериода 	<= &ПредПериод
		|И	УпрКурс.КонецПериода  	>  &ПредПериод
		|
		|СГРУППИРОВАТЬ ПО
		|	СпрОрганизации.Организация	
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//6.
		|ВЫБРАТЬ
		|	СпрОрганизации.Организация КАК Организация,
		|	IsNull(СУММА(	ВЫБОР
		|				КОГДА КурсКассы.Валюта = &ВалютаУправленческогоУчета
		|				ТОГДА НаличныеДС.СуммаОстаток
		|				ИНАЧЕ НаличныеДС.СуммаОстаток * КурсКассы.Курс / УпрКурс.Курс
		|			КОНЕЦ), 0) 	КАК СуммаОстаток
		|ИЗ
		|	СпрОрганизации КАК СпрОрганизации
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ДенежныеСредстваНаличные.Остатки(&ГраницаДатаОкончания) КАК НаличныеДС
		|ПО	НаличныеДС.Организация = СпрОрганизации.Организация
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК КурсКассы
		|ПО КурсКассы.Валюта        = 	НаличныеДС.Касса.ВалютаДенежныхСредств
		|И	КурсКассы.НачалоПериода <= 	&ДатаОкончания
		|И	КурсКассы.КонецПериода 	>  	&ДатаОкончания 
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК УпрКурс
		|ПО УпрКурс.Валюта 	   	 	=  &ВалютаУправленческогоУчета
		|И 	УпрКурс.НачалоПериода 	<= &ДатаОкончания
		|И	УпрКурс.КонецПериода  	>  &ДатаОкончания
		|
		|СГРУППИРОВАТЬ ПО
		|	СпрОрганизации.Организация
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//7.
		|ВЫБРАТЬ
		|	СпрОрганизации.Организация КАК Организация,
		|	IsNull(СУММА(	ВЫБОР
		|				КОГДА КурсКассы.Валюта = &ВалютаУправленческогоУчета
		|				ТОГДА БезналичныеДС.СуммаОстаток
		|				ИНАЧЕ БезналичныеДС.СуммаОстаток * КурсКассы.Курс / УпрКурс.Курс
		|			КОНЕЦ), 0) 	КАК СуммаОстаток
		|ИЗ
		|	СпрОрганизации КАК СпрОрганизации
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ДенежныеСредстваБезналичные.Остатки(&ГраницаПредПериод) КАК БезналичныеДС
		|ПО	БезналичныеДС.Организация = СпрОрганизации.Организация
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК КурсКассы
		|ПО КурсКассы.Валюта     	= 	БезналичныеДС.БанковскийСчет.ВалютаДенежныхСредств
		|И	КурсКассы.НачалоПериода <= 	&ПредПериод
		|И	КурсКассы.КонецПериода 	>  	&ПредПериод 
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК УпрКурс
		|ПО УпрКурс.Валюта 			=  &ВалютаУправленческогоУчета
		|И 	УпрКурс.НачалоПериода 	<= &ПредПериод
		|И	УпрКурс.КонецПериода  	>  &ПредПериод
		|
		|СГРУППИРОВАТЬ ПО
		|	СпрОрганизации.Организация
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//8.
		|ВЫБРАТЬ
		|	СпрОрганизации.Организация КАК Организация,
		|	СУММА(	ВЫБОР
		|				КОГДА КурсКассы.Валюта = &ВалютаУправленческогоУчета
		|				ТОГДА БезналичныеДС.СуммаОстаток
		|				ИНАЧЕ БезналичныеДС.СуммаОстаток * КурсКассы.Курс / УпрКурс.Курс
		|			КОНЕЦ) 	КАК СуммаОстаток
		|ИЗ
		|	СпрОрганизации КАК СпрОрганизации
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ДенежныеСредстваБезналичные.Остатки(&ГраницаДатаОкончания) КАК БезналичныеДС
		|ПО	БезналичныеДС.Организация = СпрОрганизации.Организация
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК КурсКассы
		|ПО КурсКассы.Валюта        = 	БезналичныеДС.БанковскийСчет.ВалютаДенежныхСредств
		|И	КурсКассы.НачалоПериода <= 	&ДатаОкончания
		|И	КурсКассы.КонецПериода 	>  	&ДатаОкончания 
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК УпрКурс
		|ПО УпрКурс.Валюта 	   	 	=  &ВалютаУправленческогоУчета
		|И 	УпрКурс.НачалоПериода 	<= &ДатаОкончания
		|И	УпрКурс.КонецПериода  	>  &ДатаОкончания
		|
		|СГРУППИРОВАТЬ ПО
		|	СпрОрганизации.Организация
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//9.
		|ВЫБРАТЬ
		|	СпрОрганизации.Организация КАК Организация,
		|	IsNull(СУММА(	ВЫБОР
		|				КОГДА РасчетыМеждуОрганизациями.Валюта = &ВалютаУправленческогоУчета
		|				ТОГДА РасчетыМеждуОрганизациями.СуммаОстаток
		|				ИНАЧЕ РасчетыМеждуОрганизациями.СуммаОстаток * КурсКассы.Курс / УпрКурс.Курс
		|			КОНЕЦ), 0) КАК СуммаОстаток
		|ИЗ
		|	СпрОрганизации КАК СпрОрганизации
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.РасчетыСКлиентами.Остатки(&ГраницаПредПериод, 
		|						АналитикаУчетаПоПартнерам.Партнер = ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)) КАК РасчетыМеждуОрганизациями
		|ПО	РасчетыМеждуОрганизациями.АналитикаУчетаПоПартнерам.Организация = СпрОрганизации.Организация
		| 
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК КурсКассы
		|ПО КурсКассы.Валюта         = 	РасчетыМеждуОрганизациями.Валюта
		|И	КурсКассы.НачалоПериода <= 	&ПредПериод
		|И	КурсКассы.КонецПериода 	>  	&ПредПериод 
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК УпрКурс
		|ПО УпрКурс.Валюта 	   	 	=  &ВалютаУправленческогоУчета
		|И 	УпрКурс.НачалоПериода 	<= &ПредПериод
		|И	УпрКурс.КонецПериода  	>  &ПредПериод
		|
		|СГРУППИРОВАТЬ ПО
		|	СпрОрганизации.Организация
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//10.
		|ВЫБРАТЬ
		|	СпрОрганизации.Организация КАК Организация,
		|	IsNull(СУММА(	ВЫБОР
		|				КОГДА РасчетыМеждуОрганизациями.Валюта = &ВалютаУправленческогоУчета
		|				ТОГДА РасчетыМеждуОрганизациями.СуммаОстаток
		|				ИНАЧЕ РасчетыМеждуОрганизациями.СуммаОстаток * КурсКассы.Курс / УпрКурс.Курс
		|			КОНЕЦ), 0) КАК СуммаОстаток
		|ИЗ
		|	СпрОрганизации КАК СпрОрганизации
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.РасчетыСКлиентами.Остатки(&ГраницаДатаОкончания, 
		|						АналитикаУчетаПоПартнерам.Партнер = ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)) КАК РасчетыМеждуОрганизациями
		|ПО	РасчетыМеждуОрганизациями.АналитикаУчетаПоПартнерам.Организация = СпрОрганизации.Организация
		| 
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК КурсКассы
		|ПО КурсКассы.Валюта         = 	РасчетыМеждуОрганизациями.Валюта
		|И	КурсКассы.НачалоПериода <= 	&ДатаОкончания
		|И	КурсКассы.КонецПериода 	>  	&ДатаОкончания 
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК УпрКурс
		|ПО УпрКурс.Валюта 	   	 	=  &ВалютаУправленческогоУчета
		|И 	УпрКурс.НачалоПериода 	<= &ДатаОкончания
		|И	УпрКурс.КонецПериода  	>  &ДатаОкончания
		|
		|СГРУППИРОВАТЬ ПО
		|	СпрОрганизации.Организация
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//11.
		|ВЫБРАТЬ
		|	СпрОрганизации.Организация КАК Организация,
		|	IsNull(СУММА(Вл.СуммаОстаток), 0) КАК СуммаОстаток
		|ИЗ
		|	СпрОрганизации КАК СпрОрганизации
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ (
		|		ВЫБРАТЬ
		|			ПодотчетДС.Организация,
		|			ПодотчетДС.ПодотчетноеЛицо,
		|			ПодотчетДС.Валюта,
		|			ВЫБОР
		|				КОГДА ПодотчетДС.Валюта = &ВалютаУправленческогоУчета
		|				ТОГДА ПодотчетДС.СуммаОстаток
		|				ИНАЧЕ ПодотчетДС.СуммаОстаток * КурсКассы.Курс / УпрКурс.Курс 
		|			КОНЕЦ КАК СуммаОстаток
		|		ИЗ
		|			РегистрНакопления.ДенежныеСредстваУПодотчетныхЛиц.Остатки(&ГраницаПредПериод) КАК ПодотчетДС
		|
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК КурсКассы
		|		ПО 	КурсКассы.Валюта         = 	ПодотчетДС.Валюта
		|		И	КурсКассы.НачалоПериода <= 	&ПредПериод
		|		И	КурсКассы.КонецПериода 	>  	&ПредПериод 
		|
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК УпрКурс
		|		ПО 	УпрКурс.Валюта 	   	 	=  &ВалютаУправленческогоУчета
		|		И 	УпрКурс.НачалоПериода 	<= &ПредПериод
		|		И	УпрКурс.КонецПериода  	>  &ПредПериод
		|		
		|		ГДЕ
		|			ПодотчетДС.СуммаОстаток > 0 	
		|	) КАК Вл
		|ПО	Вл.Организация = СпрОрганизации.Организация
		|
		|СГРУППИРОВАТЬ ПО
		|	СпрОрганизации.Организация
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//12.
		|ВЫБРАТЬ
		|	СпрОрганизации.Организация КАК Организация,
		|	IsNull(СУММА(Вл.СуммаОстаток), 0) КАК СуммаОстаток
		|ИЗ
		|	СпрОрганизации КАК СпрОрганизации
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ (
		|		ВЫБРАТЬ
		|			ПодотчетДС.Организация,
		|			ПодотчетДС.ПодотчетноеЛицо,
		|			ПодотчетДС.Валюта,
		|			ВЫБОР
		|				КОГДА ПодотчетДС.Валюта = &ВалютаУправленческогоУчета
		|				ТОГДА ПодотчетДС.СуммаОстаток
		|				ИНАЧЕ ПодотчетДС.СуммаОстаток * КурсКассы.Курс / УпрКурс.Курс 
		|			КОНЕЦ КАК СуммаОстаток
		|		ИЗ
		|			РегистрНакопления.ДенежныеСредстваУПодотчетныхЛиц.Остатки(&ГраницаДатаОкончания) КАК ПодотчетДС
		|
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК КурсКассы
		|		ПО 	КурсКассы.Валюта         = 	ПодотчетДС.Валюта
		|		И	КурсКассы.НачалоПериода <= 	&ДатаОкончания
		|		И	КурсКассы.КонецПериода 	>  	&ДатаОкончания 
		|
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК УпрКурс
		|		ПО 	УпрКурс.Валюта 	   	 	=  &ВалютаУправленческогоУчета
		|		И 	УпрКурс.НачалоПериода 	<= &ДатаОкончания
		|		И	УпрКурс.КонецПериода  	>  &ДатаОкончания
		|		
		|		ГДЕ
		|			ПодотчетДС.СуммаОстаток > 0 	
		|	) КАК Вл
		|ПО	Вл.Организация = СпрОрганизации.Организация
		|
		|СГРУППИРОВАТЬ ПО
		|	СпрОрганизации.Организация
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//13.
		|ВЫБРАТЬ
		|	СпрОрганизации.Организация 			КАК Организация,
		|	IsNull(СУММА(Вл.СуммаОстаток) , 0) 	КАК СуммаОстаток
		|ИЗ
		|	СпрОрганизации КАК СпрОрганизации
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ (
		|		ВЫБРАТЬ
		|			РасчетыСКлиентами.АналитикаУчетаПоПартнерам,
		|			РасчетыСКлиентами.Валюта,
		|			ВЫБОР
		|				КОГДА РасчетыСКлиентами.Валюта = &ВалютаУправленческогоУчета
		|				ТОГДА РасчетыСКлиентами.СуммаОстаток
		|				ИНАЧЕ РасчетыСКлиентами.СуммаОстаток * КурсКассы.Курс / УпрКурс.Курс 
		|			КОНЕЦ КАК СуммаОстаток
		|		ИЗ
		|			РегистрНакопления.РасчетыСКлиентами.Остатки(&ГраницаПредПериод,
		|											АналитикаУчетаПоПартнерам.Партнер <> ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие) 
		|														) КАК РасчетыСКлиентами
		|
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК КурсКассы
		|		ПО 	КурсКассы.Валюта         = 	РасчетыСКлиентами.Валюта
		|		И	КурсКассы.НачалоПериода <= 	&ПредПериод
		|		И	КурсКассы.КонецПериода 	>  	&ПредПериод 
		|
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК УпрКурс
		|		ПО 	УпрКурс.Валюта 	   	 	=  &ВалютаУправленческогоУчета
		|		И 	УпрКурс.НачалоПериода 	<= &ПредПериод
		|		И	УпрКурс.КонецПериода  	>  &ПредПериод
		|		
		|		ГДЕ
		|			РасчетыСКлиентами.СуммаОстаток > 0 
		|			
		|		ОБЪЕДИНИТЬ ВСЕ 
		|		
		|		ВЫБРАТЬ
		|			РасчетыСПоставщиками.АналитикаУчетаПоПартнерам,
		|			РасчетыСПоставщиками.Валюта,
		|			ВЫБОР
		|				КОГДА РасчетыСПоставщиками.Валюта = &ВалютаУправленческогоУчета
		|				ТОГДА РасчетыСПоставщиками.СуммаОстаток
		|				ИНАЧЕ РасчетыСПоставщиками.СуммаОстаток * КурсКассы.Курс / УпрКурс.Курс 
		|			КОНЕЦ КАК СуммаОстаток
		|		ИЗ
		|			РегистрНакопления.РасчетыСПоставщиками.Остатки(&ГраницаПредПериод,
		|											АналитикаУчетаПоПартнерам.Партнер <> ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие) 
		|															) КАК РасчетыСПоставщиками
		|
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК КурсКассы
		|		ПО 	КурсКассы.Валюта         = 	РасчетыСПоставщиками.Валюта
		|		И	КурсКассы.НачалоПериода <= 	&ПредПериод
		|		И	КурсКассы.КонецПериода 	>  	&ПредПериод 
		|
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК УпрКурс
		|		ПО 	УпрКурс.Валюта 	   	 	=  &ВалютаУправленческогоУчета
		|		И 	УпрКурс.НачалоПериода 	<= &ПредПериод
		|		И	УпрКурс.КонецПериода  	>  &ПредПериод
		|		
		|		ГДЕ
		|			РасчетыСПоставщиками.СуммаОстаток > 0	
		|	) КАК Вл
		|ПО	Вл.АналитикаУчетаПоПартнерам.Организация = СпрОрганизации.Организация
		|
		|СГРУППИРОВАТЬ ПО
		|	СпрОрганизации.Организация
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//14.
		|ВЫБРАТЬ
		|	СпрОрганизации.Организация КАК Организация,
		|	IsNull(СУММА(Вл.СуммаОстаток) , 0) КАК СуммаОстаток
		|ИЗ
		|	СпрОрганизации КАК СпрОрганизации
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ (
		|		ВЫБРАТЬ
		|			РасчетыСКлиентами.АналитикаУчетаПоПартнерам,
		|			РасчетыСКлиентами.Валюта,
		|			ВЫБОР
		|				КОГДА РасчетыСКлиентами.Валюта = &ВалютаУправленческогоУчета
		|				ТОГДА РасчетыСКлиентами.СуммаОстаток
		|				ИНАЧЕ РасчетыСКлиентами.СуммаОстаток * КурсКассы.Курс / УпрКурс.Курс 
		|			КОНЕЦ КАК СуммаОстаток
		|		ИЗ
		|			РегистрНакопления.РасчетыСКлиентами.Остатки(&ГраницаДатаОкончания,
		|											АналитикаУчетаПоПартнерам.Партнер <> ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие) 
		|														) КАК РасчетыСКлиентами
		|
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК КурсКассы
		|		ПО 	КурсКассы.Валюта         = 	РасчетыСКлиентами.Валюта
		|		И	КурсКассы.НачалоПериода <= 	&ДатаОкончания
		|		И	КурсКассы.КонецПериода 	>  	&ДатаОкончания 
		|
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК УпрКурс
		|		ПО 	УпрКурс.Валюта 	   	 	=  &ВалютаУправленческогоУчета
		|		И 	УпрКурс.НачалоПериода 	<= &ДатаОкончания
		|		И	УпрКурс.КонецПериода  	>  &ДатаОкончания
		|		
		|		ГДЕ
		|			РасчетыСКлиентами.СуммаОстаток > 0 
		|			
		|		ОБЪЕДИНИТЬ ВСЕ 
		|		
		|		ВЫБРАТЬ
		|			РасчетыСПоставщиками.АналитикаУчетаПоПартнерам,
		|			РасчетыСПоставщиками.Валюта,
		|			ВЫБОР
		|				КОГДА РасчетыСПоставщиками.Валюта = &ВалютаУправленческогоУчета
		|				ТОГДА РасчетыСПоставщиками.СуммаОстаток
		|				ИНАЧЕ РасчетыСПоставщиками.СуммаОстаток * КурсКассы.Курс / УпрКурс.Курс 
		|			КОНЕЦ КАК СуммаОстаток
		|		ИЗ
		|			РегистрНакопления.РасчетыСПоставщиками.Остатки(&ГраницаДатаОкончания,
		|											АналитикаУчетаПоПартнерам.Партнер <> ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие) 
		|															) КАК РасчетыСПоставщиками
		|
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК КурсКассы
		|		ПО 	КурсКассы.Валюта         = 	РасчетыСПоставщиками.Валюта
		|		И	КурсКассы.НачалоПериода <= 	&ДатаОкончания
		|		И	КурсКассы.КонецПериода 	>  	&ДатаОкончания 
		|
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК УпрКурс
		|		ПО 	УпрКурс.Валюта 	   	 	=  &ВалютаУправленческогоУчета
		|		И 	УпрКурс.НачалоПериода 	<= &ДатаОкончания
		|		И	УпрКурс.КонецПериода  	>  &ДатаОкончания
		|		
		|		ГДЕ
		|			РасчетыСПоставщиками.СуммаОстаток > 0	
		|	) КАК Вл
		|ПО	Вл.АналитикаУчетаПоПартнерам.Организация = СпрОрганизации.Организация
		|
		|СГРУППИРОВАТЬ ПО
		|	СпрОрганизации.Организация
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//15.
		|ВЫБРАТЬ
		|	СпрОрганизации.Организация КАК Организация,
		|	IsNull(СУММА(	ВЫБОР
		|				КОГДА РасчетыМеждуОрганизациями.Валюта = &ВалютаУправленческогоУчета
		|				ТОГДА РасчетыМеждуОрганизациями.СуммаОстаток
		|				ИНАЧЕ РасчетыМеждуОрганизациями.СуммаОстаток * КурсКассы.Курс / УпрКурс.Курс
		|			КОНЕЦ), 0) КАК СуммаОстаток
		|ИЗ
		|	СпрОрганизации КАК СпрОрганизации
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.РасчетыСКлиентами.Остатки(&ГраницаПредПериод, 
		|						АналитикаУчетаПоПартнерам.Партнер = ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)) КАК РасчетыМеждуОрганизациями
		|ПО	РасчетыМеждуОрганизациями.АналитикаУчетаПоПартнерам.Контрагент = СпрОрганизации.Организация
		| 
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК КурсКассы
		|ПО КурсКассы.Валюта         = 	РасчетыМеждуОрганизациями.Валюта
		|И	КурсКассы.НачалоПериода <= 	&ПредПериод
		|И	КурсКассы.КонецПериода 	>  	&ПредПериод 
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК УпрКурс
		|ПО УпрКурс.Валюта 	   	 	=  &ВалютаУправленческогоУчета
		|И 	УпрКурс.НачалоПериода 	<= &ПредПериод
		|И	УпрКурс.КонецПериода  	>  &ПредПериод
		|
		|СГРУППИРОВАТЬ ПО
		|	СпрОрганизации.Организация
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//16.
		|ВЫБРАТЬ
		|	СпрОрганизации.Организация КАК Организация,
		|	IsNull(СУММА(	ВЫБОР
		|				КОГДА РасчетыМеждуОрганизациями.Валюта = &ВалютаУправленческогоУчета
		|				ТОГДА РасчетыМеждуОрганизациями.СуммаОстаток
		|				ИНАЧЕ РасчетыМеждуОрганизациями.СуммаОстаток * КурсКассы.Курс / УпрКурс.Курс
		|			КОНЕЦ),  0) КАК СуммаОстаток
		|ИЗ
		|	СпрОрганизации КАК СпрОрганизации
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.РасчетыСКлиентами.Остатки(&ГраницаДатаОкончания, 
		|						АналитикаУчетаПоПартнерам.Партнер = ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)) КАК РасчетыМеждуОрганизациями
		|ПО	РасчетыМеждуОрганизациями.АналитикаУчетаПоПартнерам.Контрагент = СпрОрганизации.Организация
		| 
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК КурсКассы
		|ПО КурсКассы.Валюта         = 	РасчетыМеждуОрганизациями.Валюта
		|И	КурсКассы.НачалоПериода <= 	&ДатаОкончания
		|И	КурсКассы.КонецПериода 	>  	&ДатаОкончания 
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК УпрКурс
		|ПО УпрКурс.Валюта 	   	 	=  &ВалютаУправленческогоУчета
		|И 	УпрКурс.НачалоПериода 	<= &ДатаОкончания
		|И	УпрКурс.КонецПериода  	>  &ДатаОкончания
		|
		|СГРУППИРОВАТЬ ПО
		|	СпрОрганизации.Организация
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//17.
		|ВЫБРАТЬ
		|	СпрОрганизации.Организация КАК Организация,
		|	-IsNull(СУММА(Вл.СуммаОстаток), 0) КАК СуммаОстаток
		|ИЗ
		|	СпрОрганизации КАК СпрОрганизации
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ (
		|		ВЫБРАТЬ
		|			ПодотчетДС.Организация,
		|			ПодотчетДС.ПодотчетноеЛицо,
		|			ПодотчетДС.Валюта,
		|			ВЫБОР
		|				КОГДА ПодотчетДС.Валюта = &ВалютаУправленческогоУчета
		|				ТОГДА ПодотчетДС.СуммаОстаток
		|				ИНАЧЕ ПодотчетДС.СуммаОстаток * КурсКассы.Курс / УпрКурс.Курс 
		|			КОНЕЦ КАК СуммаОстаток
		|		ИЗ
		|			РегистрНакопления.ДенежныеСредстваУПодотчетныхЛиц.Остатки(&ГраницаПредПериод) КАК ПодотчетДС
		|
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК КурсКассы
		|		ПО 	КурсКассы.Валюта         = 	ПодотчетДС.Валюта
		|		И	КурсКассы.НачалоПериода <= 	&ПредПериод
		|		И	КурсКассы.КонецПериода 	>  	&ПредПериод 
		|
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК УпрКурс
		|		ПО 	УпрКурс.Валюта 	   	 	=  &ВалютаУправленческогоУчета
		|		И 	УпрКурс.НачалоПериода 	<= &ПредПериод
		|		И	УпрКурс.КонецПериода  	>  &ПредПериод
		|		
		|		ГДЕ
		|			ПодотчетДС.СуммаОстаток < 0 	
		|	) КАК Вл
		|ПО	Вл.Организация = СпрОрганизации.Организация
		|
		|СГРУППИРОВАТЬ ПО
		|	СпрОрганизации.Организация
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//18.
		|ВЫБРАТЬ
		|	СпрОрганизации.Организация КАК Организация,
		|	-IsNull(СУММА(Вл.СуммаОстаток), 0) КАК СуммаОстаток
		|ИЗ
		|	СпрОрганизации КАК СпрОрганизации
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ (
		|		ВЫБРАТЬ
		|			ПодотчетДС.Организация,
		|			ПодотчетДС.ПодотчетноеЛицо,
		|			ПодотчетДС.Валюта,
		|			ВЫБОР
		|				КОГДА ПодотчетДС.Валюта = &ВалютаУправленческогоУчета
		|				ТОГДА ПодотчетДС.СуммаОстаток
		|				ИНАЧЕ ПодотчетДС.СуммаОстаток * КурсКассы.Курс / УпрКурс.Курс 
		|			КОНЕЦ КАК СуммаОстаток
		|		ИЗ
		|			РегистрНакопления.ДенежныеСредстваУПодотчетныхЛиц.Остатки(&ГраницаДатаОкончания) КАК ПодотчетДС
		|
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК КурсКассы
		|		ПО 	КурсКассы.Валюта         = 	ПодотчетДС.Валюта
		|		И	КурсКассы.НачалоПериода <= 	&ДатаОкончания
		|		И	КурсКассы.КонецПериода 	>  	&ДатаОкончания 
		|
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК УпрКурс
		|		ПО 	УпрКурс.Валюта 	   	 	=  &ВалютаУправленческогоУчета
		|		И 	УпрКурс.НачалоПериода 	<= &ДатаОкончания
		|		И	УпрКурс.КонецПериода  	>  &ДатаОкончания
		|		
		|		ГДЕ
		|			ПодотчетДС.СуммаОстаток < 0 	
		|	) КАК Вл
		|ПО	Вл.Организация = СпрОрганизации.Организация
		|
		|СГРУППИРОВАТЬ ПО
		|	СпрОрганизации.Организация
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//19.
		|ВЫБРАТЬ
		|	СпрОрганизации.Организация КАК Организация,
		|	-IsNull(СУММА(Вл.СуммаОстаток) , 0) КАК СуммаОстаток
		|ИЗ
		|	СпрОрганизации КАК СпрОрганизации
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ (
		|		ВЫБРАТЬ
		|			РасчетыСКлиентами.АналитикаУчетаПоПартнерам,
		|			РасчетыСКлиентами.Валюта,
		|			ВЫБОР
		|				КОГДА РасчетыСКлиентами.Валюта = &ВалютаУправленческогоУчета
		|				ТОГДА РасчетыСКлиентами.СуммаОстаток
		|				ИНАЧЕ РасчетыСКлиентами.СуммаОстаток * КурсКассы.Курс / УпрКурс.Курс 
		|			КОНЕЦ КАК СуммаОстаток
		|		ИЗ
		|			РегистрНакопления.РасчетыСКлиентами.Остатки(&ГраницаПредПериод,
		|											АналитикаУчетаПоПартнерам.Партнер <> ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)
		|														) КАК РасчетыСКлиентами
		|
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК КурсКассы
		|		ПО 	КурсКассы.Валюта         = 	РасчетыСКлиентами.Валюта
		|		И	КурсКассы.НачалоПериода <= 	&ПредПериод
		|		И	КурсКассы.КонецПериода 	>  	&ПредПериод 
		|
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК УпрКурс
		|		ПО 	УпрКурс.Валюта 	   	 	=  &ВалютаУправленческогоУчета
		|		И 	УпрКурс.НачалоПериода 	<= &ПредПериод
		|		И	УпрКурс.КонецПериода  	>  &ПредПериод
		|		
		|		ГДЕ
		|			РасчетыСКлиентами.СуммаОстаток < 0 
		|			
		|		ОБЪЕДИНИТЬ ВСЕ 
		|		
		|		ВЫБРАТЬ
		|			РасчетыСПоставщиками.АналитикаУчетаПоПартнерам,
		|			РасчетыСПоставщиками.Валюта,
		|			ВЫБОР
		|				КОГДА РасчетыСПоставщиками.Валюта = &ВалютаУправленческогоУчета
		|				ТОГДА РасчетыСПоставщиками.СуммаОстаток
		|				ИНАЧЕ РасчетыСПоставщиками.СуммаОстаток * КурсКассы.Курс / УпрКурс.Курс 
		|			КОНЕЦ КАК СуммаОстаток
		|		ИЗ
		|			РегистрНакопления.РасчетыСПоставщиками.Остатки(&ГраницаПредПериод,
		|											АналитикаУчетаПоПартнерам.Партнер <> ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)
		|															) КАК РасчетыСПоставщиками
		|
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК КурсКассы
		|		ПО 	КурсКассы.Валюта         = 	РасчетыСПоставщиками.Валюта
		|		И	КурсКассы.НачалоПериода <= 	&ПредПериод
		|		И	КурсКассы.КонецПериода 	>  	&ПредПериод 
		|
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК УпрКурс
		|		ПО 	УпрКурс.Валюта 	   	 	=  &ВалютаУправленческогоУчета
		|		И 	УпрКурс.НачалоПериода 	<= &ПредПериод
		|		И	УпрКурс.КонецПериода  	>  &ПредПериод
		|		
		|		ГДЕ
		|			РасчетыСПоставщиками.СуммаОстаток < 0	
		|	) КАК Вл
		|ПО	Вл.АналитикаУчетаПоПартнерам.Организация = СпрОрганизации.Организация
		|
		|СГРУППИРОВАТЬ ПО
		|	СпрОрганизации.Организация
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//20.
		|ВЫБРАТЬ
		|	СпрОрганизации.Организация КАК Организация,
		|	-IsNull(СУММА(Вл.СуммаОстаток) , 0) КАК СуммаОстаток
		|ИЗ
		|	СпрОрганизации КАК СпрОрганизации
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ (
		|		ВЫБРАТЬ
		|			РасчетыСКлиентами.АналитикаУчетаПоПартнерам,
		|			РасчетыСКлиентами.Валюта,
		|			ВЫБОР
		|				КОГДА РасчетыСКлиентами.Валюта = &ВалютаУправленческогоУчета
		|				ТОГДА РасчетыСКлиентами.СуммаОстаток
		|				ИНАЧЕ РасчетыСКлиентами.СуммаОстаток * КурсКассы.Курс / УпрКурс.Курс 
		|			КОНЕЦ КАК СуммаОстаток
		|		ИЗ
		|			РегистрНакопления.РасчетыСКлиентами.Остатки(&ГраницаДатаОкончания,
		|											АналитикаУчетаПоПартнерам.Партнер <> ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)
		|														) КАК РасчетыСКлиентами
		|
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК КурсКассы
		|		ПО 	КурсКассы.Валюта         = 	РасчетыСКлиентами.Валюта
		|		И	КурсКассы.НачалоПериода <= 	&ДатаОкончания
		|		И	КурсКассы.КонецПериода 	>  	&ДатаОкончания 
		|
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК УпрКурс
		|		ПО 	УпрКурс.Валюта 	   	 	=  &ВалютаУправленческогоУчета
		|		И 	УпрКурс.НачалоПериода 	<= &ДатаОкончания
		|		И	УпрКурс.КонецПериода  	>  &ДатаОкончания
		|		
		|		ГДЕ
		|			РасчетыСКлиентами.СуммаОстаток < 0 
		|			
		|		ОБЪЕДИНИТЬ ВСЕ 
		|		
		|		ВЫБРАТЬ
		|			РасчетыСПоставщиками.АналитикаУчетаПоПартнерам,
		|			РасчетыСПоставщиками.Валюта,
		|			ВЫБОР
		|				КОГДА РасчетыСПоставщиками.Валюта = &ВалютаУправленческогоУчета
		|				ТОГДА РасчетыСПоставщиками.СуммаОстаток
		|				ИНАЧЕ РасчетыСПоставщиками.СуммаОстаток * КурсКассы.Курс / УпрКурс.Курс 
		|			КОНЕЦ КАК СуммаОстаток
		|		ИЗ
		|			РегистрНакопления.РасчетыСПоставщиками.Остатки(&ГраницаДатаОкончания,
		|											АналитикаУчетаПоПартнерам.Партнер <> ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)
		|															) КАК РасчетыСПоставщиками
		|
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК КурсКассы
		|		ПО 	КурсКассы.Валюта         = 	РасчетыСПоставщиками.Валюта
		|		И	КурсКассы.НачалоПериода <= 	&ДатаОкончания
		|		И	КурсКассы.КонецПериода 	>  	&ДатаОкончания 
		|
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК УпрКурс
		|		ПО 	УпрКурс.Валюта 	   	 	=  &ВалютаУправленческогоУчета
		|		И 	УпрКурс.НачалоПериода 	<= &ДатаОкончания
		|		И	УпрКурс.КонецПериода  	>  &ДатаОкончания
		|		
		|		ГДЕ
		|			РасчетыСПоставщиками.СуммаОстаток < 0	
		|	) КАК Вл
		|ПО	Вл.АналитикаУчетаПоПартнерам.Организация = СпрОрганизации.Организация
		|
		|СГРУППИРОВАТЬ ПО
		|	СпрОрганизации.Организация
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//21.
		|ВЫБРАТЬ
        |	СпрОрганизации.Организация КАК Организация,
		|	IsNull(СУММА(ВыручкаИСебестоимостьПродаж.СуммаВыручкиОборот), 0)	КАК ВыручкаОтПродаж,
		|	IsNull(СУММА(ВыручкаИСебестоимостьПродаж.СебестоимостьОборот), 0) 	КАК СебестоимостьПродаж,
		|	IsNull(СУММА(ВыручкаИСебестоимостьПродаж.СуммаВыручкиОборот), 0) - IsNull(СУММА(ВыручкаИСебестоимостьПродаж.СебестоимостьОборот), 0) КАК МаржинальныйДоход
		|ИЗ
		|	СпрОрганизации КАК СпрОрганизации
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ВыручкаИСебестоимостьПродаж.Обороты(
		|													&ГраницаДатаНачала, 
		|													&ГраницаДатаОкончания, 
		|													, 
		|													АналитикаУчетаПоПартнерам.Партнер <> ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)) КАК ВыручкаИСебестоимостьПродаж
		|ПО	ВыручкаИСебестоимостьПродаж.АналитикаУчетаПоПартнерам.Организация = СпрОрганизации.Организация
		|
		|СГРУППИРОВАТЬ ПО
		|	СпрОрганизации.Организация
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//22.
		|ВЫБРАТЬ
		|	СпрОрганизации.Организация 				КАК Организация,
		| 	IsNull(Сумма(ВыручкаОтПродаж), 0) 		КАК ВыручкаОтПродаж,
		| 	IsNull(Сумма(СебестоимостьПродаж), 0)	КАК СебестоимостьПродаж,
		| 	IsNull(Сумма(МаржинальныйДоход), 0)		КАК МаржинальныйДоход
		|ИЗ
		|	СпрОрганизации КАК СпрОрганизации
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ (
		|		ВЫБРАТЬ
		|			АналитикаУчетаПоПартнерам.Организация		КАК Организация,
		|			СуммаВыручкиОборот							КАК ВыручкаОтПродаж,
		|			СебестоимостьОборот 						КАК СебестоимостьПродаж,
		|			СуммаВыручкиОборот - СебестоимостьОборот 	КАК МаржинальныйДоход
		|		ИЗ
		|			РегистрНакопления.ВыручкаИСебестоимостьПродаж.Обороты(
		|															&ГраницаДатаНачала, 
		|															&ГраницаДатаОкончания, 
		|															, 
	//	|															АналитикаУчетаНоменклатуры.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Товар)
		|														 	АналитикаУчетаПоПартнерам.Партнер = ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие))
		|														
		|		ОБЪЕДИНИТЬ ВСЕ
		|
		|		ВЫБРАТЬ
		|			АналитикаУчетаПоПартнерам.Контрагент,
		|			СуммаВыручкиОборот,
		|			СебестоимостьОборот,
		|			-(СуммаВыручкиОборот - СебестоимостьОборот)
		|		ИЗ
		|			РегистрНакопления.ВыручкаИСебестоимостьПродаж.Обороты(
		|															&ГраницаДатаНачала, 
		|															&ГраницаДатаОкончания, 
		|															, 
		|															АналитикаУчетаНоменклатуры.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Товар)
		|														И	АналитикаУчетаПоПартнерам.Партнер = ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие))
		|	) КАК Вл
		|ПО	Вл.Организация = СпрОрганизации.Организация
		|
		|СГРУППИРОВАТЬ ПО
		|	СпрОрганизации.Организация
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//23.
		|ВЫБРАТЬ
		|	СпрОрганизации.Организация 	КАК Организация,
		|	СтатьяДоходов				КАК СтатьяДоходов,
		| 	СуммаОборот 				КАК Сумма
		|ИЗ
		|	СпрОрганизации КАК СпрОрганизации
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ПрочиеДоходы.Обороты( 
		|											&ГраницаДатаНачала, 
		|											&ГраницаДатаОкончания, 
		|											,
		|											АналитикаДоходов <> Значение(Перечисление.АналитикаКурсовыхРазниц.ДенежныеСредства)
		|										И	СтатьяДоходов 	 <> Значение(ПланВидовХарактеристик.СтатьиДоходов.КурсовыеРазницы)) КАК ПрочиеДоходы
		|ПО	ПрочиеДоходы.Организация = СпрОрганизации.Организация
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	СпрОрганизации.Организация 	КАК Организация,
		|	СтатьяДоходов				КАК СтатьяДоходов,
		| 	СУММА(СуммаОборот) 			КАК Сумма
		|ИЗ
		|	СпрОрганизации КАК СпрОрганизации
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ПрочиеДоходы.Обороты(
		|											&ГраницаДатаНачала, 
		|											&ГраницаДатаОкончания,
		|											Регистратор, 
		|											СтатьяДоходов = Значение(ПланВидовХарактеристик.СтатьиДоходов.КурсовыеРазницы)
		|											) КАК ПрочиеДоходы
		|ПО	ПрочиеДоходы.Организация = СпрОрганизации.Организация
		|											
		|ГДЕ
		|	Регистратор ССылка Документ.РасходныйКассовыйОрдер
		|
		|СГРУППИРОВАТЬ ПО
		|	СпрОрганизации.Организация,
		|	СтатьяДоходов	
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//24.
		|ВЫБРАТЬ
		|	СпрОрганизации.Организация 	КАК Организация,
		|	СтатьяРасходов		КАК СтатьяРасходов,
		| 	СуммаОборот 		КАК Сумма
		|ИЗ
		|	СпрОрганизации КАК СпрОрганизации
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ПрочиеРасходы.Обороты(
		|											&ГраницаДатаНачала, 
		|											&ГраницаДатаОкончания, 
		|											, 
		|											АналитикаРасходов 							<> Значение(Перечисление.АналитикаКурсовыхРазниц.ДенежныеСредства)
		|										И	СтатьяРасходов 								<> Значение(ПланВидовХарактеристик.СтатьиРасходов.КурсовыеРазницы)
		|										И	СтатьяРасходов.ВариантРаспределенияРасходов <> ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаРасходыБудущихПериодов)
		|														) КАК ПрочиеРасходы
		|ПО	ПрочиеРасходы.Организация = СпрОрганизации.Организация
		|
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	СпрОрганизации.Организация,
		|	СтатьяРасходов,
		| 	СУММА(СуммаОборот)
		|ИЗ
		|	СпрОрганизации КАК СпрОрганизации
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ПрочиеРасходы.Обороты(
		|											&ГраницаДатаНачала, 
		|											&ГраницаДатаОкончания,
		|											Регистратор, 
		|											СтатьяРасходов = Значение(ПланВидовХарактеристик.СтатьиРасходов.КурсовыеРазницы)
		|											) КАК ПрочиеРасходы
		|ПО	ПрочиеРасходы.Организация = СпрОрганизации.Организация
		|											
		|ГДЕ
		|	Регистратор ССылка Документ.РасходныйКассовыйОрдер
		|
		|СГРУППИРОВАТЬ ПО
		|	СпрОрганизации.Организация,
		|	СтатьяРасходов	
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//25. Точки
		|ВЫБРАТЬ
		|  	НачалоПериода КАК Период
		|ПОМЕСТИТЬ Точки
		|ИЗ
		|  	ТаблицаКурсов
		|  	
		|ОБЪЕДИНИТЬ 
		|
		|ВЫБРАТЬ
		|  	КонецПериода
		|ИЗ
		|  	ТаблицаКурсов
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Период			
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 26. Пересечения
		|ВЫБРАТЬ
		|  	Точки.Период КАК НачалоПериода,
		|  	МИНИМУМ(ЕСТЬNULL(ТочкиКопия.Период, ДАТАВРЕМЯ(3999, 1, 1))) КАК КонецПериода
		|ПОМЕСТИТЬ Пересечения
		|ИЗ
		| 	Точки КАК Точки
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ Точки КАК ТочкиКопия
		|ПО 	ТочкиКопия.Период > Точки.Период
		|
		|СГРУППИРОВАТЬ ПО
		|	Точки.Период
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	НачалоПериода,
		|	КонецПериода			
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//27.
		|ВЫБРАТЬ
		|	Дебиторка.Период								КАК Период,
		|	Дебиторка.АналитикаУчетаПоПартнерам.Партнер 	КАК Партнер,
		|	Дебиторка.АналитикаУчетаПоПартнерам.Организация КАК Организация,
		|	Дебиторка.Валюта								КАК Валюта,
		|	СуммаКонечныйОстаток                			КАК СуммаОстаток
		|ПОМЕСТИТЬ ОборотыПоПартнерам
		|ИЗ
		|	РегистрНакопления.РасчетыСКлиентами.ОстаткиИОбороты(
		|							ДОБАВИТЬКДАТЕ(&ДатаНачала, ДЕНЬ, -1), 
		|							&ГраницаДатаОкончания,
		|							ДЕНЬ,
		|							, 
		|							
		|							) КАК Дебиторка
		|
		|ГДЕ
		|	Дебиторка.Валюта <> &ВалютаУправленческогоУчета
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//28.
		|ВЫБРАТЬ
		|	ОборотыПоПартнерам.Валюта		КАК Валюта,
		|	ОборотыПоПартнерам.Организация	КАК Организация,
		|	ОборотыПоПартнерам.СуммаОстаток	КАК СуммаОстаток,
		|	ОборотыПоПартнерам.Период 		КАК НачалоПериода,
		|	МИНИМУМ(ISNULL(ОборотыПоПартнерамКопия.Период, ДАТАВРЕМЯ(3999, 1, 1))) КАК КонецПериода
		|ПОМЕСТИТЬ ОборотыПоПартнерамНарастающие
		|ИЗ
		|   ОборотыПоПартнерам КАК ОборотыПоПартнерам
		|   
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ ОборотыПоПартнерам КАК ОборотыПоПартнерамКопия
		|ПО ОборотыПоПартнерамКопия.Организация = ОборотыПоПартнерам.Организация
		|И	ОборотыПоПартнерамКопия.Партнер 	= ОборотыПоПартнерам.Партнер
		|И	ОборотыПоПартнерамКопия.Валюта 		= ОборотыПоПартнерам.Валюта
		|И  ОборотыПоПартнерамКопия.Период  	> ОборотыПоПартнерам.Период
		|
		|СГРУППИРОВАТЬ ПО
		|	ОборотыПоПартнерам.Период,
		|	ОборотыПоПартнерам.Валюта,
		|	ОборотыПоПартнерам.Организация,
		|	ОборотыПоПартнерам.СуммаОстаток
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//29.	
		|ВЫБРАТЬ
		|	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1) 	КАК Период,
		|	ОборотыНарастающие.Организация						КАК Организация,
		|  - СУММА(СуммаОстаток * СтарыйКурс.Курс / СтарыйУпрКурс.Курс
		|  - СуммаОстаток * IsNull(НовыйКурс.Курс, СтарыйКурс.Курс) / НовыйУпрКурс.Курс) КАК КурсоваяРазница
		|ПОМЕСТИТЬ Доходы_РасчетыСКлиентами  
		|ИЗ
		|	ОборотыПоПартнерамНарастающие КАК ОборотыНарастающие
		|
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ Пересечения КАК Пересечения
		|ПО ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1) >= ОборотыНарастающие.НачалоПериода
		|И	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1) <  ОборотыНарастающие.КонецПериода 	 
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК НовыйКурс
		|ПО НовыйКурс.Валюта         = 	ОборотыНарастающие.Валюта
		|И	НовыйКурс.НачалоПериода >= 	Пересечения.НачалоПериода
		|И	НовыйКурс.НачалоПериода <  	Пересечения.КонецПериода 
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК СтарыйКурс
		|ПО СтарыйКурс.Валюта 	   	 = 	ОборотыНарастающие.Валюта
		|И 	СтарыйКурс.НачалоПериода <= ОборотыНарастающие.НачалоПериода
		|И	СтарыйКурс.КонецПериода  > 	ОборотыНарастающие.НачалоПериода
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК НовыйУпрКурс
		|ПО НовыйУпрКурс.Валюта			= 	&ВалютаУправленческогоУчета
		|И 	НовыйУпрКурс.НачалоПериода 	<= 	Пересечения.НачалоПериода
		|И	НовыйУпрКурс.КонецПериода  	> 	Пересечения.НачалоПериода 	
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК СтарыйУпрКурс
		|ПО СтарыйУпрКурс.Валюта		= 	&ВалютаУправленческогоУчета
		|И 	СтарыйУпрКурс.НачалоПериода <= 	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1)
		|И	СтарыйУпрКурс.КонецПериода  > 	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1)
		|
		|ГДЕ
		|	СуммаОстаток > 0	
		|
		|СГРУППИРОВАТЬ ПО
		|	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1),
		|	ОборотыНарастающие.Организация
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//30.
		|ВЫБРАТЬ
		|	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1) 	КАК Период,
		|	ОборотыНарастающие.Организация						КАК Организация,
		|  	СУММА(СуммаОстаток * СтарыйКурс.Курс / СтарыйУпрКурс.Курс
		|  - СуммаОстаток * IsNull(НовыйКурс.Курс, СтарыйКурс.Курс) / НовыйУпрКурс.Курс) КАК КурсоваяРазница
		|ПОМЕСТИТЬ Расходы_РасчетыСКлиентами  
		|ИЗ
		|	ОборотыПоПартнерамНарастающие КАК ОборотыНарастающие
		|
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ Пересечения КАК Пересечения
		|ПО ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1) >= ОборотыНарастающие.НачалоПериода
		|И	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1) <  ОборотыНарастающие.КонецПериода 	 
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК НовыйКурс
		|ПО НовыйКурс.Валюта         = 	ОборотыНарастающие.Валюта
		|И	НовыйКурс.НачалоПериода >= 	Пересечения.НачалоПериода
		|И	НовыйКурс.НачалоПериода <  	Пересечения.КонецПериода 
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК СтарыйКурс
		|ПО СтарыйКурс.Валюта 	   	 = 	ОборотыНарастающие.Валюта
		|И 	СтарыйКурс.НачалоПериода <= ОборотыНарастающие.НачалоПериода
		|И	СтарыйКурс.КонецПериода  > 	ОборотыНарастающие.НачалоПериода
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК НовыйУпрКурс
		|ПО НовыйУпрКурс.Валюта			= 	&ВалютаУправленческогоУчета
		|И 	НовыйУпрКурс.НачалоПериода 	<= 	Пересечения.НачалоПериода
		|И	НовыйУпрКурс.КонецПериода  	> 	Пересечения.НачалоПериода 	
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК СтарыйУпрКурс
		|ПО СтарыйУпрКурс.Валюта		= 	&ВалютаУправленческогоУчета
		|И 	СтарыйУпрКурс.НачалоПериода <= 	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1)
		|И	СтарыйУпрКурс.КонецПериода  > 	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1)
		|
		|ГДЕ
		|	СуммаОстаток < 0	
		|
		|СГРУППИРОВАТЬ ПО
		|	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1),
		|	ОборотыНарастающие.Организация
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//31, 32, 33, 34.
		|УНИЧТОЖИТЬ КурсыВалют;
		|УНИЧТОЖИТЬ Точки;	
		|УНИЧТОЖИТЬ ОборотыПоПартнерам;
		|УНИЧТОЖИТЬ ОборотыПоПартнерамНарастающие;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//35.
		|ВЫБРАТЬ
		|	НаличныеДС.Период						КАК Период,
		|	НаличныеДС.Организация					КАК Организация,
		|	НаличныеДС.Касса						КАК Касса,
		|	НаличныеДС.Касса.ВалютаДенежныхСредств 	КАК Валюта,
		|	СУММА(НаличныеДС.СуммаКонечныйОстаток) 	КАК СуммаОстаток
		|ПОМЕСТИТЬ ОборотыНаличные
		|ИЗ
		|	РегистрНакопления.ДенежныеСредстваНаличные.ОстаткиИОбороты(
		|															ДОБАВИТЬКДАТЕ(&ДатаНачала, ДЕНЬ, -1), 
		|															&ГраницаДатаОкончания,
		|															ДЕНЬ,
		|															, 
		|															) КАК НаличныеДС
		|
		|ГДЕ
		|	НаличныеДС.Касса.ВалютаДенежныхСредств <> &ВалютаУправленческогоУчета	
		|
		|СГРУППИРОВАТЬ ПО
		|	НаличныеДС.Период,
		|	НаличныеДС.Организация,
		|	НаличныеДС.Касса,
		|	НаличныеДС.Касса.ВалютаДенежныхСредств
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//36.
		|ВЫБРАТЬ
		|	ОборотыНаличные.Валюта			КАК Валюта,
		|	ОборотыНаличные.Организация		КАК Организация,
		|	ОборотыНаличные.СуммаОстаток	КАК СуммаОстаток,
		|	ОборотыНаличные.Период 			КАК НачалоПериода,
		|	МИНИМУМ(ISNULL(ОборотыНаличныеКопия.Период, ДАТАВРЕМЯ(3999, 1, 1))) КАК КонецПериода
		|ПОМЕСТИТЬ ОборотыНаличныеНарастающие
		|ИЗ
		|   ОборотыНаличные КАК ОборотыНаличные
		|   
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ ОборотыНаличные КАК ОборотыНаличныеКопия
		|ПО ОборотыНаличныеКопия.Касса  = ОборотыНаличные.Касса
		|И	ОборотыНаличныеКопия.Валюта = ОборотыНаличные.Валюта
		|И  ОборотыНаличныеКопия.Период > ОборотыНаличные.Период
		|
		|СГРУППИРОВАТЬ ПО
		|	ОборотыНаличные.Период,
		|	ОборотыНаличные.Валюта,
		|	ОборотыНаличные.Организация,
		|	ОборотыНаличные.СуммаОстаток
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//37.	
		|ВЫБРАТЬ
		|	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1) 	КАК Период,
		|	ОборотыНарастающие.Организация						КАК Организация,
		|  - СУММА((СуммаОстаток * СтарыйКурс.Курс / СтарыйУпрКурс.Курс
		|  - СуммаОстаток * IsNull(НовыйКурс.Курс, СтарыйКурс.Курс) / НовыйУпрКурс.Курс))	КАК КурсоваяРазница
		|ПОМЕСТИТЬ Доходы_НаличныеДенежныеСредства 
		|ИЗ
		|	ОборотыНаличныеНарастающие КАК ОборотыНарастающие
		|
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ Пересечения КАК Пересечения
		|ПО ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1) >= ОборотыНарастающие.НачалоПериода
		|И	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1) <  ОборотыНарастающие.КонецПериода 	 
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК НовыйКурс
		|ПО НовыйКурс.Валюта         = 	ОборотыНарастающие.Валюта
		|И	НовыйКурс.НачалоПериода >= 	Пересечения.НачалоПериода
		|И	НовыйКурс.НачалоПериода <  	Пересечения.КонецПериода 
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК СтарыйКурс
		|ПО СтарыйКурс.Валюта 	   	 = 	ОборотыНарастающие.Валюта
		|И 	СтарыйКурс.НачалоПериода <= ОборотыНарастающие.НачалоПериода
		|И	СтарыйКурс.КонецПериода  > 	ОборотыНарастающие.НачалоПериода
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК НовыйУпрКурс
		|ПО НовыйУпрКурс.Валюта			= 	&ВалютаУправленческогоУчета
		|И 	НовыйУпрКурс.НачалоПериода 	<= 	Пересечения.НачалоПериода
		|И	НовыйУпрКурс.КонецПериода  	> 	Пересечения.НачалоПериода 	
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК СтарыйУпрКурс
		|ПО СтарыйУпрКурс.Валюта		= 	&ВалютаУправленческогоУчета
		|И 	СтарыйУпрКурс.НачалоПериода <= 	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1)
		|И	СтарыйУпрКурс.КонецПериода  > 	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1)
		|
		|СГРУППИРОВАТЬ ПО
		|	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1),
		|	ОборотыНарастающие.Организация
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//38, 39.
		|УНИЧТОЖИТЬ ОборотыНаличные;
		|УНИЧТОЖИТЬ ОборотыНаличныеНарастающие;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//40.
		|ВЫБРАТЬ
		|	БезналичныеДС.Период								КАК Период,
		|	БезналичныеДС.Организация							КАК Организация,
		|	БезналичныеДС.БанковскийСчет						КАК БанковскийСчет,
		|	БезналичныеДС.БанковскийСчет.ВалютаДенежныхСредств 	КАК Валюта,
		|	СУММА(БезналичныеДС.СуммаКонечныйОстаток) 			КАК СуммаОстаток
		|ПОМЕСТИТЬ ОборотыБезналичные
		|ИЗ
		|	РегистрНакопления.ДенежныеСредстваБезналичные.ОстаткиИОбороты(
		|															ДОБАВИТЬКДАТЕ(&ДатаНачала, ДЕНЬ, -1), 
		|															&ГраницаДатаОкончания,
		|															ДЕНЬ,
		|															, 
		|															) КАК БезналичныеДС
		|
		|ГДЕ
		|	БезналичныеДС.БанковскийСчет.ВалютаДенежныхСредств <> &ВалютаУправленческогоУчета	
		|
		|СГРУППИРОВАТЬ ПО
		|	БезналичныеДС.Период,
		|	БезналичныеДС.Организация,
		|	БезналичныеДС.БанковскийСчет,
		|	БезналичныеДС.БанковскийСчет.ВалютаДенежныхСредств
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//41.
		|ВЫБРАТЬ
		|	ОборотыБезналичные.Валюта		КАК Валюта,
		|	ОборотыБезналичные.Организация	КАК Организация,
		|	ОборотыБезналичные.СуммаОстаток	КАК СуммаОстаток,
		|	ОборотыБезналичные.Период 		КАК НачалоПериода,
		|	МИНИМУМ(ISNULL(ОборотыБезналичныеКопия.Период, ДАТАВРЕМЯ(3999, 1, 1))) КАК КонецПериода
		|ПОМЕСТИТЬ ОборотыБезналичныеНарастающие
		|ИЗ
		|   ОборотыБезналичные КАК ОборотыБезналичные
		|   
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ ОборотыБезналичные КАК ОборотыБезналичныеКопия
		|ПО ОборотыБезналичныеКопия.Организация = ОборотыБезналичные.Организация
		|И	ОборотыБезналичныеКопия.БанковскийСчет = ОборотыБезналичные.БанковскийСчет
		|И	ОборотыБезналичныеКопия.Валюта  = ОборотыБезналичные.Валюта
		|И  ОборотыБезналичныеКопия.Период  > ОборотыБезналичные.Период
		|
		|СГРУППИРОВАТЬ ПО
		|	ОборотыБезналичные.Период,
		|	ОборотыБезналичные.Валюта,
		|	ОборотыБезналичные.Организация,
		|	ОборотыБезналичные.СуммаОстаток
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//42.	
		|ВЫБРАТЬ
		|	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1) 	КАК Период,
		|	ОборотыНарастающие.Организация						КАК Организация,
		|  - СУММА((СуммаОстаток * СтарыйКурс.Курс / СтарыйУпрКурс.Курс
		|  - СуммаОстаток * IsNull(НовыйКурс.Курс, СтарыйКурс.Курс) / НовыйУпрКурс.Курс))	КАК КурсоваяРазница
		|ПОМЕСТИТЬ Доходы_БезналичныеДенежныеСредства 
		|ИЗ
		|	ОборотыБезналичныеНарастающие КАК ОборотыНарастающие
		|
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ Пересечения КАК Пересечения
		|ПО ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1) >= ОборотыНарастающие.НачалоПериода
		|И	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1) <  ОборотыНарастающие.КонецПериода 	 
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК НовыйКурс
		|ПО НовыйКурс.Валюта         = 	ОборотыНарастающие.Валюта
		|И	НовыйКурс.НачалоПериода >= 	Пересечения.НачалоПериода
		|И	НовыйКурс.НачалоПериода <  	Пересечения.КонецПериода 
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК СтарыйКурс
		|ПО СтарыйКурс.Валюта 	   	 = 	ОборотыНарастающие.Валюта
		|И 	СтарыйКурс.НачалоПериода <= ОборотыНарастающие.НачалоПериода
		|И	СтарыйКурс.КонецПериода  > 	ОборотыНарастающие.НачалоПериода
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК НовыйУпрКурс
		|ПО НовыйУпрКурс.Валюта			= 	&ВалютаУправленческогоУчета
		|И 	НовыйУпрКурс.НачалоПериода 	<= 	Пересечения.НачалоПериода
		|И	НовыйУпрКурс.КонецПериода  	> 	Пересечения.НачалоПериода 	
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК СтарыйУпрКурс
		|ПО СтарыйУпрКурс.Валюта		= 	&ВалютаУправленческогоУчета
		|И 	СтарыйУпрКурс.НачалоПериода <= 	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1)
		|И	СтарыйУпрКурс.КонецПериода  > 	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1)
		|
		|СГРУППИРОВАТЬ ПО
		|	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1),
		|	ОборотыНарастающие.Организация
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//43, 44.
		|УНИЧТОЖИТЬ ОборотыБезналичные;
		|УНИЧТОЖИТЬ ОборотыБезналичныеНарастающие;	
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//45.
		|ВЫБРАТЬ
		|	ПодотчетДС.Период						КАК Период,
		|	ПодотчетДС.Организация              	КАК Организация,
		|	ПодотчетДС.ПодотчетноеЛицо              КАК ПодотчетноеЛицо,
		|	ПодотчетДС.Валюта						КАК Валюта,
		|	СУММА(ПодотчетДС.СуммаКонечныйОстаток) 	КАК СуммаОстаток
		|ПОМЕСТИТЬ ОборотыПодотчет
		|ИЗ
		|	РегистрНакопления.ДенежныеСредстваУПодотчетныхЛиц.ОстаткиИОбороты(
		|															ДОБАВИТЬКДАТЕ(&ДатаНачала, ДЕНЬ, -1), 
		|															&ГраницаДатаОкончания,
		|															ДЕНЬ,
		|															, 
		|															) КАК ПодотчетДС
		|
		|ГДЕ
		|	ПодотчетДС.Валюта <> &ВалютаУправленческогоУчета	
		|
		|СГРУППИРОВАТЬ ПО
		|	ПодотчетДС.Период,
		|	ПодотчетДС.Организация,
		|	ПодотчетДС.ПодотчетноеЛицо,
		|	ПодотчетДС.Валюта
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//46.
		|ВЫБРАТЬ
		|	ОборотыПодотчет.Валюта			КАК Валюта,
		|	ОборотыПодотчет.Организация		КАК Организация,
		|	ОборотыПодотчет.СуммаОстаток	КАК СуммаОстаток,
		|	ОборотыПодотчет.Период 			КАК НачалоПериода,
		|	МИНИМУМ(ISNULL(ОборотыПодотчетКопия.Период, ДАТАВРЕМЯ(3999, 1, 1))) КАК КонецПериода
		|ПОМЕСТИТЬ ОборотыПодотчетНарастающие
		|ИЗ
		|   ОборотыПодотчет КАК ОборотыПодотчет
		|   
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ ОборотыПодотчет КАК ОборотыПодотчетКопия
		|ПО ОборотыПодотчетКопия.Организация 	 = ОборотыПодотчет.Организация
		|И	ОборотыПодотчетКопия.ПодотчетноеЛицо = ОборотыПодотчет.ПодотчетноеЛицо
		|И	ОборотыПодотчетКопия.Валюта  		 = ОборотыПодотчет.Валюта
		|И  ОборотыПодотчетКопия.Период  		 > ОборотыПодотчет.Период
		|
		|СГРУППИРОВАТЬ ПО
		|	ОборотыПодотчет.Период,
		|	ОборотыПодотчет.Валюта,
		|	ОборотыПодотчет.Организация,
		|	ОборотыПодотчет.СуммаОстаток
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//47.	
		|ВЫБРАТЬ
		|	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1) 	КАК Период,
		|	ОборотыНарастающие.Организация						КАК Организация,
		|  - СУММА((СуммаОстаток * СтарыйКурс.Курс / СтарыйУпрКурс.Курс
		|  - СуммаОстаток * IsNull(НовыйКурс.Курс, СтарыйКурс.Курс) / НовыйУпрКурс.Курс))	КАК КурсоваяРазница
		|ПОМЕСТИТЬ Доходы_ДенежныеСредстваУПодотчетныхЛиц
		|ИЗ
		|	ОборотыПодотчетНарастающие КАК ОборотыНарастающие
		|
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ Пересечения КАК Пересечения
		|ПО ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1) >= ОборотыНарастающие.НачалоПериода
		|И	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1) <  ОборотыНарастающие.КонецПериода 	 
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК НовыйКурс
		|ПО НовыйКурс.Валюта         = 	ОборотыНарастающие.Валюта
		|И	НовыйКурс.НачалоПериода >= 	Пересечения.НачалоПериода
		|И	НовыйКурс.НачалоПериода <  	Пересечения.КонецПериода 
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК СтарыйКурс
		|ПО СтарыйКурс.Валюта 	   	 = 	ОборотыНарастающие.Валюта
		|И 	СтарыйКурс.НачалоПериода <= ОборотыНарастающие.НачалоПериода
		|И	СтарыйКурс.КонецПериода  > 	ОборотыНарастающие.НачалоПериода
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК НовыйУпрКурс
		|ПО НовыйУпрКурс.Валюта			= 	&ВалютаУправленческогоУчета
		|И 	НовыйУпрКурс.НачалоПериода 	<= 	Пересечения.НачалоПериода
		|И	НовыйУпрКурс.КонецПериода  	> 	Пересечения.НачалоПериода 	
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК СтарыйУпрКурс
		|ПО СтарыйУпрКурс.Валюта		= 	&ВалютаУправленческогоУчета
		|И 	СтарыйУпрКурс.НачалоПериода <= 	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1)
		|И	СтарыйУпрКурс.КонецПериода  > 	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1)
		|
		|ГДЕ
		|	СуммаОстаток > 0
		|	
		|СГРУППИРОВАТЬ ПО
		|	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1),
		|	ОборотыНарастающие.Организация
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//48.	
		|ВЫБРАТЬ
		|	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1) 	КАК Период,
		|	ОборотыНарастающие.Организация						КАК Организация,
		|	СУММА((СуммаОстаток * СтарыйКурс.Курс / СтарыйУпрКурс.Курс
		|  - СуммаОстаток * IsNull(НовыйКурс.Курс, СтарыйКурс.Курс) / НовыйУпрКурс.Курс))	КАК КурсоваяРазница
		|ПОМЕСТИТЬ Расходы_ДенежныеСредстваУПодотчетныхЛиц
		|ИЗ
		|	ОборотыПодотчетНарастающие КАК ОборотыНарастающие
		|
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ Пересечения КАК Пересечения
		|ПО ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1) >= ОборотыНарастающие.НачалоПериода
		|И	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1) <  ОборотыНарастающие.КонецПериода 	 
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК НовыйКурс
		|ПО НовыйКурс.Валюта         = 	ОборотыНарастающие.Валюта
		|И	НовыйКурс.НачалоПериода >= 	Пересечения.НачалоПериода
		|И	НовыйКурс.НачалоПериода <  	Пересечения.КонецПериода 
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК СтарыйКурс
		|ПО СтарыйКурс.Валюта 	   	 = 	ОборотыНарастающие.Валюта
		|И 	СтарыйКурс.НачалоПериода <= ОборотыНарастающие.НачалоПериода
		|И	СтарыйКурс.КонецПериода  > 	ОборотыНарастающие.НачалоПериода
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК НовыйУпрКурс
		|ПО НовыйУпрКурс.Валюта			= 	&ВалютаУправленческогоУчета
		|И 	НовыйУпрКурс.НачалоПериода 	<= 	Пересечения.НачалоПериода
		|И	НовыйУпрКурс.КонецПериода  	> 	Пересечения.НачалоПериода 	
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК СтарыйУпрКурс
		|ПО СтарыйУпрКурс.Валюта		= 	&ВалютаУправленческогоУчета
		|И 	СтарыйУпрКурс.НачалоПериода <= 	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1)
		|И	СтарыйУпрКурс.КонецПериода  > 	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1)
		|
		|ГДЕ
		|	СуммаОстаток < 0
		|	
		|СГРУППИРОВАТЬ ПО
		|	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1),
		|	ОборотыНарастающие.Организация
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//49, 50.
		|УНИЧТОЖИТЬ ОборотыПодотчет;
		|УНИЧТОЖИТЬ ОборотыПодотчетНарастающие;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//51.
		|ВЫБРАТЬ
		|	Кредиторка.Период									КАК Период,
		|	Кредиторка.АналитикаУчетаПоПартнерам.Партнер 		КАК Партнер,
		|	Кредиторка.АналитикаУчетаПоПартнерам.Организация 	КАК Организация,
		|	Кредиторка.Валюта									КАК Валюта,
		|	Кредиторка.СуммаКонечныйОстаток                		КАК СуммаОстаток
		|ПОМЕСТИТЬ ОборотыПоПартнерам
		|ИЗ
		|	РегистрНакопления.РасчетыСПоставщиками.ОстаткиИОбороты(
		|							ДОБАВИТЬКДАТЕ(&ДатаНачала, ДЕНЬ, -1), 
		|							&ГраницаДатаОкончания,
		|							ДЕНЬ,
		|							, 
		|							
		|							) КАК Кредиторка
		|
		|ГДЕ
		|	Кредиторка.Валюта <> &ВалютаУправленческогоУчета
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//52.
		|ВЫБРАТЬ
		|	ОборотыПоПартнерам.Валюта		КАК Валюта,
		|	ОборотыПоПартнерам.Организация	КАК Организация,
		|	ОборотыПоПартнерам.СуммаОстаток	КАК СуммаОстаток,
		|	ОборотыПоПартнерам.Период 		КАК НачалоПериода,
		|	МИНИМУМ(ISNULL(ОборотыПоПартнерамКопия.Период, ДАТАВРЕМЯ(3999, 1, 1))) КАК КонецПериода
		|ПОМЕСТИТЬ ОборотыПоПартнерамНарастающие
		|ИЗ
		|   ОборотыПоПартнерам КАК ОборотыПоПартнерам
		|   
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ ОборотыПоПартнерам КАК ОборотыПоПартнерамКопия
		|ПО ОборотыПоПартнерамКопия.Организация = ОборотыПоПартнерам.Организация
		|И	ОборотыПоПартнерамКопия.Партнер 	= ОборотыПоПартнерам.Партнер
		|И	ОборотыПоПартнерамКопия.Валюта 		= ОборотыПоПартнерам.Валюта
		|И  ОборотыПоПартнерамКопия.Период  	> ОборотыПоПартнерам.Период
		|
		|СГРУППИРОВАТЬ ПО
		|	ОборотыПоПартнерам.Период,
		|	ОборотыПоПартнерам.Валюта,
		|	ОборотыПоПартнерам.Организация,
		|	ОборотыПоПартнерам.СуммаОстаток
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//53.	
		|ВЫБРАТЬ
		|	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1) 	КАК Период,
		|	ОборотыНарастающие.Организация						КАК Организация,
		|  - СУММА(СуммаОстаток * СтарыйКурс.Курс / СтарыйУпрКурс.Курс
		|  - СуммаОстаток * IsNull(НовыйКурс.Курс, СтарыйКурс.Курс) / НовыйУпрКурс.Курс) КАК КурсоваяРазница
		|ПОМЕСТИТЬ Доходы_РасчетыСПоставщиками  
		|ИЗ
		|	ОборотыПоПартнерамНарастающие КАК ОборотыНарастающие
		|
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ Пересечения КАК Пересечения
		|ПО ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1) >= ОборотыНарастающие.НачалоПериода
		|И	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1) <  ОборотыНарастающие.КонецПериода 	 
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК НовыйКурс
		|ПО НовыйКурс.Валюта         = 	ОборотыНарастающие.Валюта
		|И	НовыйКурс.НачалоПериода >= 	Пересечения.НачалоПериода
		|И	НовыйКурс.НачалоПериода <  	Пересечения.КонецПериода 
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК СтарыйКурс
		|ПО СтарыйКурс.Валюта 	   	 = 	ОборотыНарастающие.Валюта
		|И 	СтарыйКурс.НачалоПериода <= ОборотыНарастающие.НачалоПериода
		|И	СтарыйКурс.КонецПериода  > 	ОборотыНарастающие.НачалоПериода
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК НовыйУпрКурс
		|ПО НовыйУпрКурс.Валюта			= 	&ВалютаУправленческогоУчета
		|И 	НовыйУпрКурс.НачалоПериода 	<= 	Пересечения.НачалоПериода
		|И	НовыйУпрКурс.КонецПериода  	> 	Пересечения.НачалоПериода 	
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК СтарыйУпрКурс
		|ПО СтарыйУпрКурс.Валюта		= 	&ВалютаУправленческогоУчета
		|И 	СтарыйУпрКурс.НачалоПериода <= 	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1)
		|И	СтарыйУпрКурс.КонецПериода  > 	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1)
		|
		|ГДЕ
		|	СуммаОстаток > 0	
		|
		|СГРУППИРОВАТЬ ПО
		|	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1),
		|	ОборотыНарастающие.Организация
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//54.	
		|ВЫБРАТЬ
		|	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1) 	КАК Период,
		|	ОборотыНарастающие.Организация						КАК Организация,
		|	СУММА(СуммаОстаток * СтарыйКурс.Курс / СтарыйУпрКурс.Курс
		|  - СуммаОстаток * IsNull(НовыйКурс.Курс, СтарыйКурс.Курс) / НовыйУпрКурс.Курс) КАК КурсоваяРазница
		|ПОМЕСТИТЬ Расходы_РасчетыСПоставщиками  
		|ИЗ
		|	ОборотыПоПартнерамНарастающие КАК ОборотыНарастающие
		|
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ Пересечения КАК Пересечения
		|ПО ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1) >= ОборотыНарастающие.НачалоПериода
		|И	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1) <  ОборотыНарастающие.КонецПериода 	 
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК НовыйКурс
		|ПО НовыйКурс.Валюта         = 	ОборотыНарастающие.Валюта
		|И	НовыйКурс.НачалоПериода >= 	Пересечения.НачалоПериода
		|И	НовыйКурс.НачалоПериода <  	Пересечения.КонецПериода 
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК СтарыйКурс
		|ПО СтарыйКурс.Валюта 	   	 = 	ОборотыНарастающие.Валюта
		|И 	СтарыйКурс.НачалоПериода <= ОборотыНарастающие.НачалоПериода
		|И	СтарыйКурс.КонецПериода  > 	ОборотыНарастающие.НачалоПериода
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК НовыйУпрКурс
		|ПО НовыйУпрКурс.Валюта			= 	&ВалютаУправленческогоУчета
		|И 	НовыйУпрКурс.НачалоПериода 	<= 	Пересечения.НачалоПериода
		|И	НовыйУпрКурс.КонецПериода  	> 	Пересечения.НачалоПериода 	
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК СтарыйУпрКурс
		|ПО СтарыйУпрКурс.Валюта		= 	&ВалютаУправленческогоУчета
		|И 	СтарыйУпрКурс.НачалоПериода <= 	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1)
		|И	СтарыйУпрКурс.КонецПериода  > 	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1)
		|
		|ГДЕ
		|	СуммаОстаток < 0	
		|
		|СГРУППИРОВАТЬ ПО
		|	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1),
		|	ОборотыНарастающие.Организация
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//55, 56.
		|УНИЧТОЖИТЬ ОборотыПоПартнерам;
		|УНИЧТОЖИТЬ ОборотыПоПартнерамНарастающие;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//57.
		|ВЫБРАТЬ
		|	Вл.Организация				КАК Организация,
		|	СУММА(Вл.КурсоваяРазница) 	КАК КурсоваяРазница
		|ИЗ	(
		|		ВЫБРАТЬ
		|			Период,
		|			Организация,
		|			КурсоваяРазница
		|		ИЗ
		|			Доходы_РасчетыСКлиентами
		|			
		|		ОБЪЕДИНИТЬ ВСЕ
		|
		|		ВЫБРАТЬ
		|			Период,
		|			Организация,
		|			КурсоваяРазница
		|		ИЗ
		|			Доходы_РасчетыСПоставщиками
		|			
		|		ОБЪЕДИНИТЬ ВСЕ
		|
		|		ВЫБРАТЬ
		|			Период,
		|			Организация,
		|			КурсоваяРазница
		|		ИЗ
		|			Доходы_НаличныеДенежныеСредства
		|			
		|		ОБЪЕДИНИТЬ ВСЕ
		|
		|		ВЫБРАТЬ
		|			Период,
		|			Организация,
		|			КурсоваяРазница
		|		ИЗ
		|			Доходы_БезналичныеДенежныеСредства
		|			
		|		ОБЪЕДИНИТЬ ВСЕ
		|
		|		ВЫБРАТЬ
		|			Период,
		|			Организация,
		|			КурсоваяРазница
		|		ИЗ
		|			Доходы_ДенежныеСредстваУПодотчетныхЛиц
		|	) КАК Вл
		|
		|СГРУППИРОВАТЬ ПО
		|	Вл.Организация
		|;	
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//58.
		|ВЫБРАТЬ
		|	Вл.Организация				КАК Организация,
		|	СУММА(Вл.КурсоваяРазница)	КАК КурсоваяРазница
		|ИЗ	(
		|		ВЫБРАТЬ
		|			Период,
		|			Организация,
		|			КурсоваяРазница
		|		ИЗ
		|			Расходы_РасчетыСКлиентами
		|			
		|		ОБЪЕДИНИТЬ ВСЕ
		|
		|		ВЫБРАТЬ
		|			Период,
		|			Организация,
		|			КурсоваяРазница
		|		ИЗ
		|			Расходы_РасчетыСПоставщиками
		|			
		|		ОБЪЕДИНИТЬ ВСЕ
		|
		|		ВЫБРАТЬ
		|			Период,
		|			Организация,
		|			КурсоваяРазница
		|		ИЗ
		|			Расходы_ДенежныеСредстваУПодотчетныхЛиц
		|	) КАК Вл
		|
		|СГРУППИРОВАТЬ ПО
		|	Вл.Организация
		|;
		///////////////////////////////////////////////////////////////////////////////
		// 59. Получаем список курсовых разниц по платежным документам 
		|ВЫБРАТЬ
		|	ДДСК.Организация,
		|		СУММА(
		|		ВЫБОР
		|			КОГДА ДДСК.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ОплатаПоставщику)
		|			 ИЛИ ДДСК.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ОплатаДенежныхСредствВДругуюОрганизацию)
		|				ТОГДА ДДСК.СуммаОплатыВВалютеВзаиморасчетов * КурсКассы.Курс / УпрКурс.Курс - СуммаОплатыВВалютеПлатежа * КурсПоДокументу.Курс / УпрКурс.Курс	
		|			КОГДА Регистратор Ссылка Документ.ПриходныйКассовыйОрдер
		|			  ИЛИ Регистратор Ссылка Документ.ПоступлениеБезналичныхДенежныхСредств
		|				ТОГДА -	(ДДСК.СуммаОплатыВВалютеВзаиморасчетов * КурсКассы.Курс / УпрКурс.Курс - СуммаОплатыВВалютеПлатежа * КурсПоДокументу.Курс / УпрКурс.Курс)
		|			ИНАЧЕ 0
		|		КОНЕЦ
		|		) КАК КурсоваяДоход,
		|	СУММА(
		|		ВЫБОР
		|			КОГДА ДДСК.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ОплатаПоставщику)
		|			 ИЛИ  ДДСК.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ОплатаДенежныхСредствВДругуюОрганизацию)
		|				ТОГДА 0
		|			КОГДА Регистратор Ссылка Документ.ПриходныйКассовыйОрдер
		|			  ИЛИ Регистратор Ссылка Документ.ПоступлениеБезналичныхДенежныхСредств
		|				ТОГДА 0
		|			КОГДА ДДСК.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПоступлениеДенежныхСредствИзДругойОрганизации)
		|				ТОГДА ДДСК.СуммаОплатыВВалютеВзаиморасчетов * КурсКассы.Курс / УпрКурс.Курс - СуммаОплатыВВалютеПлатежа * КурсПоДокументу.Курс / УпрКурс.Курс
		|			ИНАЧЕ - (ДДСК.СуммаОплатыВВалютеВзаиморасчетов * КурсКассы.Курс / УпрКурс.Курс - СуммаОплатыВВалютеПлатежа * КурсПоДокументу.Курс / УпрКурс.Курс)
		|		КОНЕЦ
		|			) КАК КурсоваяРасход
		|ИЗ
		|	РегистрНакопления.ДвиженияДенежныеСредстваКонтрагент КАК ДДСК
        |
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК КурсКассы
		|ПО КурсКассы.Валюта        = 	ДДСК.ВалютаВзаиморасчетов
		|И	КурсКассы.НачалоПериода <= 	ДДСК.Период
		|И	КурсКассы.КонецПериода 	>  	ДДСК.Период 
        |
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК КурсПоДокументу
		|ПО КурсПоДокументу.Валюта        =  ДДСК.ВалютаПлатежа
		|И	КурсПоДокументу.НачалоПериода <= ДДСК.Период
		|И	КурсПоДокументу.КонецПериода  >  ДДСК.Период 
        |
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК УпрКурс
		|ПО УпрКурс.Валюта 	   	 	=  &ВалютаУправленческогоУчета
		|И 	УпрКурс.НачалоПериода 	<= ДДСК.Период
		|И	УпрКурс.КонецПериода  	>  ДДСК.Период
		|																
		|ГДЕ
		|	ДДСК.Период 		>= &ДатаНачала
		|И	ДДСК.Период 		<= &ДатаОкончания	
		|И	ДДСК.ВалютаПлатежа 	<> ДДСК.ВалютаВзаиморасчетов
		|И	ОтложенноеПроведение = Ложь
        |
		|СГРУППИРОВАТЬ ПО
		|	ДДСК.Организация
		|;
		///////////////////////////////////////////////////////////////////////////////
		// 60. Доходы - ввод остатков наличные денежные средства
		|ВЫБРАТЬ
		|	ДенСредства.Организация	КАК Организация,
		|	СУММА(ВЫБОР ДенСредства.Касса.ВалютаДенежныхСредств
		|		КОГДА &ВалютаУправленческогоУчета
		|			ТОГДА ДенСредства.Сумма
		|		ИНАЧЕ ДенСредства.Сумма * ТаблицаКурсовДок.Курс / ТаблицаКурсовУпр.Курс
		|	КОНЕЦ) КАК Сумма
		|ИЗ
		|	РегистрНакопления.ДенежныеСредстваНаличные КАК ДенСредства
		|	
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсовДок
		|ПО ДенСредства.Касса.ВалютаДенежныхСредств = ТаблицаКурсовДок.Валюта
		|И 	ДенСредства.Период >= ТаблицаКурсовДок.НачалоПериода
		|И 	ДенСредства.Период <  ТаблицаКурсовДок.КонецПериода
		|			
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсовУпр
		|ПО ТаблицаКурсовУпр.Валюта = &ВалютаУправленческогоУчета
		|И 	ДенСредства.Период >= ТаблицаКурсовУпр.НачалоПериода
		|И 	ДенСредства.Период <  ТаблицаКурсовУпр.КонецПериода
		|
		|ГДЕ
		|	Регистратор ССЫЛКА Документ.ВводОстатков
		|И 	Период >= &ДатаНачала
		|И 	Период <= &ДатаОкончания
		|
		|СГРУППИРОВАТЬ ПО
		|	ДенСредства.Организация
		|;
		///////////////////////////////////////////////////////////////////////////////
		// 61. Доходы - ввод остатков безналичные денежные средства
		|ВЫБРАТЬ
		|	ДенСредства.Организация КАК Организация, 
		|	СУММА(ВЫБОР ДенСредства.БанковскийСчет.ВалютаДенежныхСредств
		|		КОГДА &ВалютаУправленческогоУчета
		|			ТОГДА ДенСредства.Сумма
		|		ИНАЧЕ ДенСредства.Сумма * ТаблицаКурсовДок.Курс / ТаблицаКурсовУпр.Курс
		|	КОНЕЦ) КАК Сумма
		|ИЗ
		|	РегистрНакопления.ДенежныеСредстваБезналичные КАК ДенСредства
		|	
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсовДок
		|ПО ДенСредства.БанковскийСчет.ВалютаДенежныхСредств = ТаблицаКурсовДок.Валюта
		|И 	ДенСредства.Период >= ТаблицаКурсовДок.НачалоПериода
		|И 	ДенСредства.Период <  ТаблицаКурсовДок.КонецПериода
		|			
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсовУпр
		|ПО ТаблицаКурсовУпр.Валюта = &ВалютаУправленческогоУчета
		|И 	ДенСредства.Период 	>= ТаблицаКурсовУпр.НачалоПериода
		|И 	ДенСредства.Период 	<  ТаблицаКурсовУпр.КонецПериода
		|		
		|ГДЕ
		|	ДенСредства.Регистратор ССЫЛКА Документ.ВводОстатков
		|И 	ДенСредства.Период >= &ДатаНачала
		|И 	ДенСредства.Период <= &ДатаОкончания
		|
		|СГРУППИРОВАТЬ ПО
		|	ДенСредства.Организация
		|;
		///////////////////////////////////////////////////////////////////////////////
		// 62. Доходы - собственные товары
		|ВЫБРАТЬ
		|	Организация,
		|	СУММА(Стоимость) КАК Сумма
		|ИЗ
		|	РегистрНакопления.СебестоимостьТоваров
		|ГДЕ
		|	Регистратор ССЫЛКА Документ.ВводОстатков
		|И 	Период >= &ДатаНачала
		|И 	Период <= &ДатаОкончания
		|
		|СГРУППИРОВАТЬ ПО
		|	Организация
		|;
		///////////////////////////////////////////////////////////////////////////////
		// 63. Доходы - долги подотчетных лиц по наличным расчетам
		|ВЫБРАТЬ
		|	ДенСредства.Организация,
		|	СУММА(	ВЫБОР
		|				КОГДА ДенСредства.Валюта = &ВалютаУправленческогоУчета
		|				ТОГДА ДенСредства.СуммаОборот
		|				ИНАЧЕ ДенСредства.СуммаОборот * ТаблицаКурсовДок.Курс / ТаблицаКурсовУпр.Курс
		|			КОНЕЦ) КАК Сумма
		|ИЗ
		|	РегистрНакопления.ДенежныеСредстваУПодотчетныхЛиц.Обороты(&ГраницаДатаНачала, &ГраницаДатаОкончания, Регистратор) КАК ДенСредства
		|	
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсовДок
		|ПО ДенСредства.Валюта =  ТаблицаКурсовДок.Валюта
		|И 	ДенСредства.Период >= ТаблицаКурсовДок.НачалоПериода
		|И 	ДенСредства.Период <  ТаблицаКурсовДок.КонецПериода
		|				
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсовУпр
		|ПО ТаблицаКурсовУпр.Валюта = &ВалютаУправленческогоУчета
		|И 	ДенСредства.Период >= ТаблицаКурсовУпр.НачалоПериода
		|И 	ДенСредства.Период <  ТаблицаКурсовУпр.КонецПериода
		|			
		|ГДЕ
		|	ДенСредства.Регистратор ССЫЛКА Документ.ВводОстатков
		|
		|СГРУППИРОВАТЬ ПО
		|	ДенСредства.Организация
		|;
		///////////////////////////////////////////////////////////////////////////////
		// 64. Доходы - задолженности клиентов
		|ВЫБРАТЬ
		|   Расчеты.АналитикаУчетаПоПартнерам.Организация КАК Организация,
		|		СУММА(ВЫБОР
		|			КОГДА Расчеты.Валюта = &ВалютаУправленческогоУчета
		|				ТОГДА Расчеты.СуммаОборот
		|			ИНАЧЕ Расчеты.СуммаОборот * ТаблицаКурсовДок.Курс / ТаблицаКурсовУпр.Курс
		|		КОНЕЦ) КАК Сумма
		|ИЗ
		|	РегистрНакопления.РасчетыСКлиентами.Обороты(&ГраницаДатаНачала, &ГраницаДатаОкончания, Регистратор, АналитикаУчетаПоПартнерам.Партнер <> ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)) КАК Расчеты
		|	
		|	
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсовДок
		|		ПО Расчеты.Валюта 		= 	ТаблицаКурсовДок.Валюта
		|			И Расчеты.Период 	>= 	ТаблицаКурсовДок.НачалоПериода
		|			И Расчеты.Период 	<  	ТаблицаКурсовДок.КонецПериода
		|				
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсовУпр
		|		ПО ТаблицаКурсовУпр.Валюта  = 	&ВалютаУправленческогоУчета
		|			И Расчеты.Период 		>= 	ТаблицаКурсовУпр.НачалоПериода
		|			И Расчеты.Период 		<  	ТаблицаКурсовУпр.КонецПериода
		|			
		|ГДЕ
		|	Расчеты.Регистратор ССЫЛКА Документ.ВводОстатков
		|И 	Расчеты.СуммаОборот > 0
		|
		|СГРУППИРОВАТЬ ПО
		|	Расчеты.АналитикаУчетаПоПартнерам.Организация
		|;
		///////////////////////////////////////////////////////////////////////////////
		// 65. Расходы - задолженности поставщиков
		|ВЫБРАТЬ
		|   Расчеты.АналитикаУчетаПоПартнерам.Организация КАК Организация,
		|		СУММА(ВЫБОР
		|			КОГДА Расчеты.Валюта = &ВалютаУправленческогоУчета
		|				ТОГДА Расчеты.СуммаОборот * (-1)
		|			ИНАЧЕ Расчеты.СуммаОборот * (-1) * ТаблицаКурсовДок.Курс / ТаблицаКурсовУпр.Курс
		|		КОНЕЦ) КАК Сумма
		|ИЗ
		|	РегистрНакопления.РасчетыСПоставщиками.Обороты(&ГраницаДатаНачала, &ГраницаДатаОкончания, Регистратор, АналитикаУчетаПоПартнерам.Партнер 	<> ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)) КАК Расчеты
		|	
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсовДок
		|		ПО Расчеты.Валюта 		= 	ТаблицаКурсовДок.Валюта
		|			И Расчеты.Период 	>= 	ТаблицаКурсовДок.НачалоПериода
		|			И Расчеты.Период 	<  	ТаблицаКурсовДок.КонецПериода
		|				
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсовУпр
		|		ПО ТаблицаКурсовУпр.Валюта  = 	&ВалютаУправленческогоУчета
		|			И Расчеты.Период 	>= 	ТаблицаКурсовУпр.НачалоПериода
		|			И Расчеты.Период 	<  	ТаблицаКурсовУпр.КонецПериода
		|			
		|ГДЕ
		|	Расчеты.Регистратор ССЫЛКА Документ.ВводОстатков
		|И 	Расчеты.СуммаОборот	< 0
		|
		|СГРУППИРОВАТЬ ПО
		|	Расчеты.АналитикаУчетаПоПартнерам.Организация
		|;
		///////////////////////////////////////////////////////////////////////////////
		// 66. Расходы - авансы от клиентов
		|ВЫБРАТЬ
		|   Расчеты.АналитикаУчетаПоПартнерам.Организация КАК Организация,
		|		СУММА(ВЫБОР
		|			КОГДА Расчеты.Валюта = &ВалютаУправленческогоУчета
		|				ТОГДА Расчеты.СуммаОборот * (-1)
		|			ИНАЧЕ Расчеты.СуммаОборот * (-1) * ТаблицаКурсовДок.Курс / ТаблицаКурсовУпр.Курс
		|		КОНЕЦ) КАК Сумма
		|ИЗ
		|	РегистрНакопления.РасчетыСКлиентами.Обороты(&ГраницаДатаНачала, &ГраницаДатаОкончания, Регистратор, АналитикаУчетаПоПартнерам.Партнер <> ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)) КАК Расчеты
		|	
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсовДок
		|		ПО Расчеты.Валюта 		= 	ТаблицаКурсовДок.Валюта
		|			И Расчеты.Период 	>= 	ТаблицаКурсовДок.НачалоПериода
		|			И Расчеты.Период 	<  	ТаблицаКурсовДок.КонецПериода
		|				
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсовУпр
		|		ПО ТаблицаКурсовУпр.Валюта  = 	&ВалютаУправленческогоУчета
		|			И Расчеты.Период 		>= 	ТаблицаКурсовУпр.НачалоПериода
		|			И Расчеты.Период 		<  	ТаблицаКурсовУпр.КонецПериода
		|			
		|ГДЕ
		|	Расчеты.Регистратор ССЫЛКА Документ.ВводОстатков
		|И 	Расчеты.СуммаОборот < 0
		|
		|СГРУППИРОВАТЬ ПО
		|	Расчеты.АналитикаУчетаПоПартнерам.Организация
		|;
		///////////////////////////////////////////////////////////////////////////////
		// 67. Доходы - Авансы, выданные поставщикам
		|ВЫБРАТЬ
		|   Расчеты.АналитикаУчетаПоПартнерам.Организация КАК Организация,
		|		СУММА(ВЫБОР
		|			КОГДА Расчеты.Валюта = &ВалютаУправленческогоУчета
		|				ТОГДА Расчеты.СуммаОборот
		|			ИНАЧЕ Расчеты.СуммаОборот * ТаблицаКурсовДок.Курс / ТаблицаКурсовУпр.Курс
		|		КОНЕЦ) КАК Сумма
		|ИЗ
		|	РегистрНакопления.РасчетыСПоставщиками.Обороты(&ГраницаДатаНачала, &ГраницаДатаОкончания, Регистратор, АналитикаУчетаПоПартнерам.Партнер <> ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)) КАК Расчеты
		|	
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсовДок
		|		ПО Расчеты.Валюта 		= 	ТаблицаКурсовДок.Валюта
		|			И Расчеты.Период 	>= 	ТаблицаКурсовДок.НачалоПериода
		|			И Расчеты.Период 	<  	ТаблицаКурсовДок.КонецПериода
		|				
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсовУпр
		|		ПО ТаблицаКурсовУпр.Валюта  = 	&ВалютаУправленческогоУчета
		|			И Расчеты.Период 	>= 	ТаблицаКурсовУпр.НачалоПериода
		|			И Расчеты.Период 	<  	ТаблицаКурсовУпр.КонецПериода
		|			
		|ГДЕ
		|	Расчеты.Регистратор ССЫЛКА Документ.ВводОстатков
		|И 	Расчеты.СуммаОборот	> 0
		|
		|СГРУППИРОВАТЬ ПО
		|	Расчеты.АналитикаУчетаПоПартнерам.Организация
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//68. Активы - ожидаемые поступления ДС Экваиринг
		|ВЫБРАТЬ
		|	СпрОрганизации.Организация,
		|	IsNull(СУММА(ВЫБОР
		|		КОГДА РасчетыПоЭквайрингу.Валюта = &ВалютаУправленческогоУчета
		|		ТОГДА РасчетыПоЭквайрингу.СуммаОстаток
		|		ИНАЧЕ РасчетыПоЭквайрингу.СуммаОстаток * КурсКассы.Курс / УпрКурс.Курс 
		|	КОНЕЦ), 0) КАК СуммаОстаток
		|ИЗ
		|	СпрОрганизации КАК СпрОрганизации
        |
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.РасчетыПоЭквайрингу.Остатки(&ГраницаПредПериод) КАК РасчетыПоЭквайрингу
		|ПО	РасчетыПоЭквайрингу.Организация = СпрОрганизации.Организация
        |
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК КурсКассы
		|ПО КурсКассы.Валюта         = 	РасчетыПоЭквайрингу.Валюта
		|И	КурсКассы.НачалоПериода <= 	&ПредПериод
		|И	КурсКассы.КонецПериода 	>  	&ПредПериод 
        |
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК УпрКурс
		|ПО УпрКурс.Валюта 	   =  &ВалютаУправленческогоУчета
		|И 	УпрКурс.НачалоПериода <= &ПредПериод
		|И	УпрКурс.КонецПериода  >  &ПредПериод
		|
		|СГРУППИРОВАТЬ ПО
		|	СпрОрганизации.Организация
		|;
        ///////////////////////////////////////////////////////////////////////////////
		// 69. Активы - ожидаемые поступления ДС Экваиринг
		|ВЫБРАТЬ
		|	СпрОрганизации.Организация,
		|	IsNull(СУММА(ВЫБОР
		|		КОГДА РасчетыПоЭквайрингу.Валюта = &ВалютаУправленческогоУчета
		|		ТОГДА РасчетыПоЭквайрингу.СуммаОстаток
		|		ИНАЧЕ РасчетыПоЭквайрингу.СуммаОстаток * КурсКассы.Курс / УпрКурс.Курс 
		|	КОНЕЦ), 0) КАК СуммаОстаток
		|ИЗ
		|	СпрОрганизации КАК СпрОрганизации
        |
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.РасчетыПоЭквайрингу.Остатки(&ГраницаДатаОкончания) КАК РасчетыПоЭквайрингу
		|ПО	РасчетыПоЭквайрингу.Организация = СпрОрганизации.Организация
        |
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК КурсКассы
		|ПО КурсКассы.Валюта         = 	РасчетыПоЭквайрингу.Валюта
		|И	КурсКассы.НачалоПериода <= 	&ДатаОкончания
		|И	КурсКассы.КонецПериода 	>  	&ДатаОкончания 
        |
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК УпрКурс
		|ПО УпрКурс.Валюта 	   =  &ВалютаУправленческогоУчета
		|И 	УпрКурс.НачалоПериода <= &ДатаОкончания
		|И	УпрКурс.КонецПериода  >  &ДатаОкончания
		|
		|СГРУППИРОВАТЬ ПО
		|	СпрОрганизации.Организация
		|;
		///////////////////////////////////////////////////////////////////////////////
		// 70.
		|ВЫБРАТЬ
		|	Организация     				КАК Организация,
		|	Регистратор						КАК Регистратор,
		|	СуммаОборот						КАК СуммаОстаток
		|ПОМЕСТИТЬ РБПСуммаНаНачало
		|ИЗ
		|	РегистрНакопления.ПрочиеРасходы.Обороты(, 
		|									, 
		|									Регистратор, 
		|									СтатьяРасходов.ВариантРаспределенияРасходов = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаРасходыБудущихПериодов))
		|ГДЕ
		|	Регистратор ССЫЛКА Документ.РаспределениеРасходовБудущихПериодов
		|	И ВЫРАЗИТЬ(Регистратор КАК Документ.РаспределениеРасходовБудущихПериодов).Дата >= &ДатаНачала
		|	И ВЫРАЗИТЬ(Регистратор КАК Документ.РаспределениеРасходовБудущихПериодов).Дата <= &ДатаОкончания
		|;
		|///////////////////////////////////////////////////////////////////////////////
		// 71.
		|ВЫБРАТЬ
		|	Организация     			КАК Организация,
		|	Регистратор					КАК Регистратор,
		|	СуммаОборот					КАК СуммаОстаток
		|ПОМЕСТИТЬ РБПСуммаНаКонец
		|ИЗ
		|	РегистрНакопления.ПрочиеРасходы.Обороты(&ГраницаДатаНачала, 
		|									&ГраницаДатаОкончания, 
		|									Регистратор, 
		|									СтатьяРасходов.ВариантРаспределенияРасходов <> ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаРасходыБудущихПериодов))
		|ГДЕ
		|	Регистратор ССЫЛКА Документ.РаспределениеРасходовБудущихПериодов
		|;
		///////////////////////////////////////////////////////////////////////////////
		// 72.
		|ВЫБРАТЬ
		|   ВложенныйЗапрос.Организация 		КАК Организация,
		|	СУММА(ВложенныйЗапрос.СуммаОстаток*(-1)) КАК СуммаОстаток
		|ИЗ
		|(
		|	ВЫБРАТЬ
		|		Организация,
		|		СуммаОстаток
		|	ИЗ
		|		РБПСуммаНаНачало
		|	ОБЪЕДИНИТЬ ВСЕ
		|	ВЫБРАТЬ
		|		Организация,
		|		СуммаОстаток
		|	ИЗ
		|		РБПСуммаНаКонец) КАК ВложенныйЗапрос
		|СГРУППИРОВАТЬ ПО
		|	ВложенныйЗапрос.Организация
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//73.
		|ВЫБРАТЬ 
		|	СпрОрганизации.Организация,
		|	IsNull(СУММА(ВЫБОР
		|		КОГДА ДСКПоступлениюБезналичные.БанковскийСчет.ВалютаДенежныхСредств = &ВалютаУправленческогоУчета
		|		ТОГДА ДСКПоступлениюБезналичные.СуммаОстаток
		|		ИНАЧЕ ДСКПоступлениюБезналичные.СуммаОстаток * КурсКассы.Курс / УпрКурс.Курс 
		|	КОНЕЦ), 0) КАК СуммаОстаток
		|ИЗ
		|	СпрОрганизации КАК СпрОрганизации
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ДенежныеСредстваКПоступлениюБезналичные.Остатки(&ГраницаПредПериод) КАК ДСКПоступлениюБезналичные
		|ПО	ДСКПоступлениюБезналичные.Организация = СпрОрганизации.Организация
        |
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК КурсКассы
		|ПО КурсКассы.Валюта         = 	ДСКПоступлениюБезналичные.БанковскийСчет.ВалютаДенежныхСредств
		|И	КурсКассы.НачалоПериода <= 	&ПредПериод
		|И	КурсКассы.КонецПериода 	>  	&ПредПериод 
        |
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК УпрКурс
		|ПО УпрКурс.Валюта 	   	 	=  &ВалютаУправленческогоУчета
		|И 	УпрКурс.НачалоПериода 	<= &ПредПериод
		|И	УпрКурс.КонецПериода  	>  &ПредПериод
        |
		|СГРУППИРОВАТЬ ПО
		|	СпрОрганизации.Организация
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//74.
		|ВЫБРАТЬ 
		|	СпрОрганизации.Организация,
		|	IsNull(СУММА(ВЫБОР
		|		КОГДА ДСКПоступлениюБезналичные.БанковскийСчет.ВалютаДенежныхСредств = &ВалютаУправленческогоУчета
		|		ТОГДА ДСКПоступлениюБезналичные.СуммаОстаток
		|		ИНАЧЕ ДСКПоступлениюБезналичные.СуммаОстаток * КурсКассы.Курс / УпрКурс.Курс 
		|	КОНЕЦ), 0) КАК СуммаОстаток
		|ИЗ
		|	СпрОрганизации КАК СпрОрганизации
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ДенежныеСредстваКПоступлениюБезналичные.Остатки(&ГраницаДатаОкончания) КАК ДСКПоступлениюБезналичные
		|ПО	ДСКПоступлениюБезналичные.Организация = СпрОрганизации.Организация
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК КурсКассы
		|ПО КурсКассы.Валюта         = 	ДСКПоступлениюБезналичные.БанковскийСчет.ВалютаДенежныхСредств
		|И	КурсКассы.НачалоПериода <= 	&ДатаОкончания
		|И	КурсКассы.КонецПериода 	>  	&ДатаОкончания 
        |
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК УпрКурс
		|ПО УпрКурс.Валюта 	   	 	=  &ВалютаУправленческогоУчета
		|И 	УпрКурс.НачалоПериода 	<= &ДатаОкончания
		|И	УпрКурс.КонецПериода  	>  &ДатаОкончания
        |
		|СГРУППИРОВАТЬ ПО
		|	СпрОрганизации.Организация
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//75.
		|ВЫБРАТЬ 
		|	СпрОрганизации.Организация,
		|	IsNull(СУММА(ВЫБОР
		|		КОГДА ДСКПоступлениюНаличные.Касса.ВалютаДенежныхСредств = &ВалютаУправленческогоУчета
		|		ТОГДА ДСКПоступлениюНаличные.СуммаОстаток
		|		ИНАЧЕ ДСКПоступлениюНаличные.СуммаОстаток * КурсКассы.Курс / УпрКурс.Курс 
		|	КОНЕЦ), 0) КАК СуммаОстаток
		|ИЗ
		|	СпрОрганизации КАК СпрОрганизации
        |
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ДенежныеСредстваКПоступлениюНаличные.Остатки(&ГраницаПредПериод) КАК ДСКПоступлениюНаличные
		|ПО	ДСКПоступлениюНаличные.Организация = СпрОрганизации.Организация
        |
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК КурсКассы
		|ПО КурсКассы.Валюта         = 	ДСКПоступлениюНаличные.Касса.ВалютаДенежныхСредств
		|И	КурсКассы.НачалоПериода <= 	&ПредПериод
		|И	КурсКассы.КонецПериода 	>  	&ПредПериод 
        |
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК УпрКурс
		|ПО УпрКурс.Валюта 	   	 	=  &ВалютаУправленческогоУчета
		|И 	УпрКурс.НачалоПериода 	<= &ПредПериод
		|И	УпрКурс.КонецПериода  	>  &ПредПериод
        |
		|СГРУППИРОВАТЬ ПО
		|	СпрОрганизации.Организация
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//76.
		|ВЫБРАТЬ 
		|	СпрОрганизации.Организация,
		|	IsNull(СУММА(ВЫБОР
		|		КОГДА ДСКПоступлениюНаличные.Касса.ВалютаДенежныхСредств = &ВалютаУправленческогоУчета
		|		ТОГДА ДСКПоступлениюНаличные.СуммаОстаток
		|		ИНАЧЕ ДСКПоступлениюНаличные.СуммаОстаток * КурсКассы.Курс / УпрКурс.Курс 
		|	КОНЕЦ), 0) КАК СуммаОстаток
		|ИЗ
		|	СпрОрганизации КАК СпрОрганизации
        |
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ДенежныеСредстваКПоступлениюНаличные.Остатки(&ГраницаДатаОкончания) КАК ДСКПоступлениюНаличные
		|ПО	ДСКПоступлениюНаличные.Организация = СпрОрганизации.Организация
        |
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК КурсКассы
		|ПО КурсКассы.Валюта         = 	ДСКПоступлениюНаличные.Касса.ВалютаДенежныхСредств
		|И	КурсКассы.НачалоПериода <= 	&ДатаОкончания
		|И	КурсКассы.КонецПериода 	>  	&ДатаОкончания 
        |
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК УпрКурс
		|ПО УпрКурс.Валюта 	   	 	=  &ВалютаУправленческогоУчета
		|И 	УпрКурс.НачалоПериода 	<= &ДатаОкончания
		|И	УпрКурс.КонецПериода  	>  &ДатаОкончания
        |
		|СГРУППИРОВАТЬ ПО
		|	СпрОрганизации.Организация
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//77.
		|ВЫБРАТЬ 
		|	СпрОрганизации.Организация,
		|	-IsNull(СУММА(ВЫБОР
		|		КОГДА ДСКСписаниюБезналичные.БанковскийСчет.ВалютаДенежныхСредств = &ВалютаУправленческогоУчета
		|		ТОГДА ДСКСписаниюБезналичные.СуммаОстаток
		|		ИНАЧЕ ДСКСписаниюБезналичные.СуммаОстаток * КурсКассы.Курс / УпрКурс.Курс 
		|	КОНЕЦ), 0) КАК СуммаОстаток
		|ИЗ
		|	СпрОрганизации КАК СпрОрганизации
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ДенежныеСредстваКСписаниюБезналичные.Остатки(&ГраницаПредПериод) КАК ДСКСписаниюБезналичные
		|ПО	ДСКСписаниюБезналичные.Организация = СпрОрганизации.Организация
        |
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК КурсКассы
		|ПО КурсКассы.Валюта         = 	ДСКСписаниюБезналичные.БанковскийСчет.ВалютаДенежныхСредств
		|И	КурсКассы.НачалоПериода <= 	&ПредПериод
		|И	КурсКассы.КонецПериода 	>  	&ПредПериод 
        |
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК УпрКурс
		|ПО УпрКурс.Валюта 	   	 	=  &ВалютаУправленческогоУчета
		|И 	УпрКурс.НачалоПериода 	<= &ПредПериод
		|И	УпрКурс.КонецПериода  	>  &ПредПериод
        |
		|СГРУППИРОВАТЬ ПО
		|	СпрОрганизации.Организация
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//78.
		|ВЫБРАТЬ 
		|	СпрОрганизации.Организация,
		|	-IsNull(СУММА(ВЫБОР
		|		КОГДА ДСКСписаниюБезналичные.БанковскийСчет.ВалютаДенежныхСредств = &ВалютаУправленческогоУчета
		|		ТОГДА ДСКСписаниюБезналичные.СуммаОстаток
		|		ИНАЧЕ ДСКСписаниюБезналичные.СуммаОстаток * КурсКассы.Курс / УпрКурс.Курс 
		|	КОНЕЦ), 0) КАК СуммаОстаток
		|ИЗ
		|	СпрОрганизации КАК СпрОрганизации
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ДенежныеСредстваКСписаниюБезналичные.Остатки(&ГраницаДатаОкончания) КАК ДСКСписаниюБезналичные
		|ПО	ДСКСписаниюБезналичные.Организация = СпрОрганизации.Организация
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК КурсКассы
		|ПО КурсКассы.Валюта         = 	ДСКСписаниюБезналичные.БанковскийСчет.ВалютаДенежныхСредств
		|И	КурсКассы.НачалоПериода <= 	&ДатаОкончания
		|И	КурсКассы.КонецПериода 	>  	&ДатаОкончания 
        |
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК УпрКурс
		|ПО УпрКурс.Валюта 	   	 	=  &ВалютаУправленческогоУчета
		|И 	УпрКурс.НачалоПериода 	<= &ДатаОкончания
		|И	УпрКурс.КонецПериода  	>  &ДатаОкончания
        |
		|СГРУППИРОВАТЬ ПО
		|	СпрОрганизации.Организация
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//79.
		|ВЫБРАТЬ
		|	ДСКПоступлениюБезналичные.Период								КАК Период,
		|	ДСКПоступлениюБезналичные.Организация              				КАК Организация,
		|	ДСКПоступлениюБезналичные.БанковскийСчет              			КАК БанковскийСчет,
		|	ДСКПоступлениюБезналичные.БанковскийСчет.ВалютаДенежныхСредств	КАК Валюта,
		|	СУММА(ДСКПоступлениюБезналичные.СуммаКонечныйОстаток) 			КАК СуммаОстаток
		|ПОМЕСТИТЬ ОборотыДСКПоступлениюБезналичные
		|ИЗ
		|	РегистрНакопления.ДенежныеСредстваКПоступлениюБезналичные.ОстаткиИОбороты(
		|															ДОБАВИТЬКДАТЕ(&ДатаНачала, ДЕНЬ, -1), 
		|															&ГраницаДатаОкончания,
		|															ДЕНЬ,
		|															, 
		|															) КАК ДСКПоступлениюБезналичные
		|
		|ГДЕ
		|	ДСКПоступлениюБезналичные.БанковскийСчет.ВалютаДенежныхСредств <> &ВалютаУправленческогоУчета	
		|
		|СГРУППИРОВАТЬ ПО
		|	ДСКПоступлениюБезналичные.Период,
		|	ДСКПоступлениюБезналичные.Организация,
		|	ДСКПоступлениюБезналичные.БанковскийСчет,
		|	ДСКПоступлениюБезналичные.БанковскийСчет.ВалютаДенежныхСредств
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//80.
		|ВЫБРАТЬ
		|	ОборотыДСКПоступлениюБезналичные.Валюта													КАК Валюта,
		|	ОборотыДСКПоступлениюБезналичные.Организация											КАК Организация,
		|	ОборотыДСКПоступлениюБезналичные.СуммаОстаток											КАК СуммаОстаток,
		|	ОборотыДСКПоступлениюБезналичные.Период 												КАК НачалоПериода,
		|	МИНИМУМ(ISNULL(ОборотыДСКПоступлениюБезналичныеКопия.Период, ДАТАВРЕМЯ(3999, 1, 1))) 	КАК КонецПериода
		|ПОМЕСТИТЬ ОборотыДСКПоступлениюБезналичныеНарастающие
		|ИЗ
		|   ОборотыДСКПоступлениюБезналичные КАК ОборотыДСКПоступлениюБезналичные
		|   
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ ОборотыДСКПоступлениюБезналичные КАК ОборотыДСКПоступлениюБезналичныеКопия
		|ПО ОборотыДСКПоступлениюБезналичныеКопия.Организация 	 = ОборотыДСКПоступлениюБезналичные.Организация
		|И	ОборотыДСКПоступлениюБезналичныеКопия.БанковскийСчет = ОборотыДСКПоступлениюБезналичные.БанковскийСчет
		|И	ОборотыДСКПоступлениюБезналичныеКопия.Валюта  		 = ОборотыДСКПоступлениюБезналичные.Валюта
		|И  ОборотыДСКПоступлениюБезналичныеКопия.Период  		 > ОборотыДСКПоступлениюБезналичные.Период
		|
		|СГРУППИРОВАТЬ ПО
		|	ОборотыДСКПоступлениюБезналичные.Период,
		|	ОборотыДСКПоступлениюБезналичные.Валюта,
		|	ОборотыДСКПоступлениюБезналичные.Организация,
		|	ОборотыДСКПоступлениюБезналичные.СуммаОстаток
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//81.	
		|ВЫБРАТЬ
		|	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1) 								КАК Период,
		|	ОборотыНарастающие.Организация													КАК Организация,
		|  - СУММА((СуммаОстаток * СтарыйКурс.Курс / СтарыйУпрКурс.Курс
		|  - СуммаОстаток * IsNull(НовыйКурс.Курс, СтарыйКурс.Курс) / НовыйУпрКурс.Курс))	КАК КурсоваяРазница
		|ПОМЕСТИТЬ Доходы_ДенежныеСредстваКПоступлениюБезналичные
		|ИЗ
		|	ОборотыДСКПоступлениюБезналичныеНарастающие КАК ОборотыНарастающие
		|
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ Пересечения КАК Пересечения
		|ПО ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1) >= ОборотыНарастающие.НачалоПериода
		|И	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1) <  ОборотыНарастающие.КонецПериода 	 
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК НовыйКурс
		|ПО НовыйКурс.Валюта         = 	ОборотыНарастающие.Валюта
		|И	НовыйКурс.НачалоПериода >= 	Пересечения.НачалоПериода
		|И	НовыйКурс.НачалоПериода <  	Пересечения.КонецПериода 
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК СтарыйКурс
		|ПО СтарыйКурс.Валюта 	   	 = 	ОборотыНарастающие.Валюта
		|И 	СтарыйКурс.НачалоПериода <= ОборотыНарастающие.НачалоПериода
		|И	СтарыйКурс.КонецПериода  > 	ОборотыНарастающие.НачалоПериода
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК НовыйУпрКурс
		|ПО НовыйУпрКурс.Валюта			= 	&ВалютаУправленческогоУчета
		|И 	НовыйУпрКурс.НачалоПериода 	<= 	Пересечения.НачалоПериода
		|И	НовыйУпрКурс.КонецПериода  	> 	Пересечения.НачалоПериода 	
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК СтарыйУпрКурс
		|ПО СтарыйУпрКурс.Валюта		= 	&ВалютаУправленческогоУчета
		|И 	СтарыйУпрКурс.НачалоПериода <= 	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1)
		|И	СтарыйУпрКурс.КонецПериода  > 	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1)
		|	
		|СГРУППИРОВАТЬ ПО
		|	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1),
		|	ОборотыНарастающие.Организация
		|;
        //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//82, 83.
		|УНИЧТОЖИТЬ ОборотыДСКПоступлениюБезналичные;
		|УНИЧТОЖИТЬ ОборотыДСКПоступлениюБезналичныеНарастающие;
        //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//84.
		|ВЫБРАТЬ
		|	ДСКПоступлениюНаличные.Период						КАК Период,
		|	ДСКПоступлениюНаличные.Организация              	КАК Организация,
		|	ДСКПоступлениюНаличные.Касса              			КАК БанковскийСчет,
		|	ДСКПоступлениюНаличные.Касса.ВалютаДенежныхСредств	КАК Валюта,
		|	СУММА(ДСКПоступлениюНаличные.СуммаКонечныйОстаток) 	КАК СуммаОстаток
		|ПОМЕСТИТЬ ОборотыДСКПоступлениюНаличные
		|ИЗ
		|	РегистрНакопления.ДенежныеСредстваКПоступлениюНаличные.ОстаткиИОбороты(
		|															ДОБАВИТЬКДАТЕ(&ДатаНачала, ДЕНЬ, -1), 
		|															&ГраницаДатаОкончания,
		|															ДЕНЬ,
		|															, 
		|															) КАК ДСКПоступлениюНаличные
		|
		|ГДЕ
		|	ДСКПоступлениюНаличные.Касса.ВалютаДенежныхСредств <> &ВалютаУправленческогоУчета	
		|
		|СГРУППИРОВАТЬ ПО
		|	ДСКПоступлениюНаличные.Период,
		|	ДСКПоступлениюНаличные.Организация,
		|	ДСКПоступлениюНаличные.Касса,
		|	ДСКПоступлениюНаличные.Касса.ВалютаДенежныхСредств
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//85.
		|ВЫБРАТЬ
		|	ОборотыДСКПоступлениюНаличные.Валюта												КАК Валюта,
		|	ОборотыДСКПоступлениюНаличные.Организация											КАК Организация,
		|	ОборотыДСКПоступлениюНаличные.СуммаОстаток											КАК СуммаОстаток,
		|	ОборотыДСКПоступлениюНаличные.Период 												КАК НачалоПериода,
		|	МИНИМУМ(ISNULL(ОборотыДСКПоступлениюНаличныеКопия.Период, ДАТАВРЕМЯ(3999, 1, 1))) 	КАК КонецПериода
		|ПОМЕСТИТЬ ОборотыДСКПоступлениюНаличныеНарастающие
		|ИЗ
		|   ОборотыДСКПоступлениюНаличные КАК ОборотыДСКПоступлениюНаличные
		|   
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ ОборотыДСКПоступлениюНаличные КАК ОборотыДСКПоступлениюНаличныеКопия
		|ПО ОборотыДСКПоступлениюНаличныеКопия.Организация 	 = ОборотыДСКПоступлениюНаличные.Организация
		|И	ОборотыДСКПоступлениюНаличныеКопия.БанковскийСчет = ОборотыДСКПоступлениюНаличные.БанковскийСчет
		|И	ОборотыДСКПоступлениюНаличныеКопия.Валюта  		 = ОборотыДСКПоступлениюНаличные.Валюта
		|И  ОборотыДСКПоступлениюНаличныеКопия.Период  		 > ОборотыДСКПоступлениюНаличные.Период
		|
		|СГРУППИРОВАТЬ ПО
		|	ОборотыДСКПоступлениюНаличные.Период,
		|	ОборотыДСКПоступлениюНаличные.Валюта,
		|	ОборотыДСКПоступлениюНаличные.Организация,
		|	ОборотыДСКПоступлениюНаличные.СуммаОстаток
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//86.	
		|ВЫБРАТЬ
		|	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1) 								КАК Период,
		|	ОборотыНарастающие.Организация													КАК Организация,
		|  - СУММА((СуммаОстаток * СтарыйКурс.Курс / СтарыйУпрКурс.Курс
		|  - СуммаОстаток * IsNull(НовыйКурс.Курс, СтарыйКурс.Курс) / НовыйУпрКурс.Курс))	КАК КурсоваяРазница
		|ПОМЕСТИТЬ Доходы_ДенежныеСредстваКПоступлениюНаличные
		|ИЗ
		|	ОборотыДСКПоступлениюНаличныеНарастающие КАК ОборотыНарастающие
		|
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ Пересечения КАК Пересечения
		|ПО ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1) >= ОборотыНарастающие.НачалоПериода
		|И	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1) <  ОборотыНарастающие.КонецПериода 	 
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК НовыйКурс
		|ПО НовыйКурс.Валюта         = 	ОборотыНарастающие.Валюта
		|И	НовыйКурс.НачалоПериода >= 	Пересечения.НачалоПериода
		|И	НовыйКурс.НачалоПериода <  	Пересечения.КонецПериода 
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК СтарыйКурс
		|ПО СтарыйКурс.Валюта 	   	 = 	ОборотыНарастающие.Валюта
		|И 	СтарыйКурс.НачалоПериода <= ОборотыНарастающие.НачалоПериода
		|И	СтарыйКурс.КонецПериода  > 	ОборотыНарастающие.НачалоПериода
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК НовыйУпрКурс
		|ПО НовыйУпрКурс.Валюта			= 	&ВалютаУправленческогоУчета
		|И 	НовыйУпрКурс.НачалоПериода 	<= 	Пересечения.НачалоПериода
		|И	НовыйУпрКурс.КонецПериода  	> 	Пересечения.НачалоПериода 	
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК СтарыйУпрКурс
		|ПО СтарыйУпрКурс.Валюта		= 	&ВалютаУправленческогоУчета
		|И 	СтарыйУпрКурс.НачалоПериода <= 	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1)
		|И	СтарыйУпрКурс.КонецПериода  > 	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1)
		|	
		|СГРУППИРОВАТЬ ПО
		|	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1),
		|	ОборотыНарастающие.Организация
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//87, 88.
		|УНИЧТОЖИТЬ ОборотыДСКПоступлениюНаличные;
		|УНИЧТОЖИТЬ ОборотыДСКПоступлениюНаличныеНарастающие;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//89.
		|ВЫБРАТЬ
		|	РасчетыПоЭквайрингу.Период						КАК Период,
		|	РасчетыПоЭквайрингу.Организация              	КАК Организация,
		|	РасчетыПоЭквайрингу.ЭквайринговыйТерминал       КАК ЭквайринговыйТерминал,
		|	РасчетыПоЭквайрингу.Валюта						КАК Валюта,
		|	СУММА(РасчетыПоЭквайрингу.СуммаКонечныйОстаток) КАК СуммаОстаток
		|ПОМЕСТИТЬ ОборотыРасчетыПоЭквайрингу
		|ИЗ
		|	РегистрНакопления.РасчетыПоЭквайрингу.ОстаткиИОбороты(
		|															ДОБАВИТЬКДАТЕ(&ДатаНачала, ДЕНЬ, -1), 
		|															&ГраницаДатаОкончания,
		|															ДЕНЬ,
		|															, 
		|															) КАК РасчетыПоЭквайрингу
		|
		|ГДЕ
		|	РасчетыПоЭквайрингу.Валюта <> &ВалютаУправленческогоУчета	
		|
		|СГРУППИРОВАТЬ ПО
		|	РасчетыПоЭквайрингу.Период,
		|	РасчетыПоЭквайрингу.Организация,
		|	РасчетыПоЭквайрингу.ЭквайринговыйТерминал,
		|	РасчетыПоЭквайрингу.Валюта
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//90.
		|ВЫБРАТЬ
		|	ОборотыРасчетыПоЭквайрингу.Валюта												КАК Валюта,
		|	ОборотыРасчетыПоЭквайрингу.Организация											КАК Организация,
		|	ОборотыРасчетыПоЭквайрингу.СуммаОстаток											КАК СуммаОстаток,
		|	ОборотыРасчетыПоЭквайрингу.Период 												КАК НачалоПериода,
		|	МИНИМУМ(ISNULL(ОборотыРасчетыПоЭквайрингуКопия.Период, ДАТАВРЕМЯ(3999, 1, 1))) 	КАК КонецПериода
		|ПОМЕСТИТЬ ОборотыРасчетыПоЭквайрингуНарастающие
		|ИЗ
		|   ОборотыРасчетыПоЭквайрингу КАК ОборотыРасчетыПоЭквайрингу
		|   
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ ОборотыРасчетыПоЭквайрингу КАК ОборотыРасчетыПоЭквайрингуКопия
		|ПО ОборотыРасчетыПоЭквайрингуКопия.Организация 	 = ОборотыРасчетыПоЭквайрингу.Организация
		|И	ОборотыРасчетыПоЭквайрингуКопия.ЭквайринговыйТерминал = ОборотыРасчетыПоЭквайрингу.ЭквайринговыйТерминал
		|И	ОборотыРасчетыПоЭквайрингуКопия.Валюта  		 = ОборотыРасчетыПоЭквайрингу.Валюта
		|И  ОборотыРасчетыПоЭквайрингуКопия.Период  		 > ОборотыРасчетыПоЭквайрингу.Период
		|
		|СГРУППИРОВАТЬ ПО
		|	ОборотыРасчетыПоЭквайрингу.Период,
		|	ОборотыРасчетыПоЭквайрингу.Валюта,
		|	ОборотыРасчетыПоЭквайрингу.Организация,
		|	ОборотыРасчетыПоЭквайрингу.СуммаОстаток
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//91.	
		|ВЫБРАТЬ
		|	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1) 								КАК Период,
		|	ОборотыНарастающие.Организация													КАК Организация,
		|  - СУММА((СуммаОстаток * СтарыйКурс.Курс / СтарыйУпрКурс.Курс
		|  - СуммаОстаток * IsNull(НовыйКурс.Курс, СтарыйКурс.Курс) / НовыйУпрКурс.Курс))	КАК КурсоваяРазница
		|ПОМЕСТИТЬ Доходы_РасчетыПоЭквайрингу
		|ИЗ
		|	ОборотыРасчетыПоЭквайрингуНарастающие КАК ОборотыНарастающие
		|
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ Пересечения КАК Пересечения
		|ПО ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1) >= ОборотыНарастающие.НачалоПериода
		|И	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1) <  ОборотыНарастающие.КонецПериода 	 
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК НовыйКурс
		|ПО НовыйКурс.Валюта         = 	ОборотыНарастающие.Валюта
		|И	НовыйКурс.НачалоПериода >= 	Пересечения.НачалоПериода
		|И	НовыйКурс.НачалоПериода <  	Пересечения.КонецПериода 
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК СтарыйКурс
		|ПО СтарыйКурс.Валюта 	   	 = 	ОборотыНарастающие.Валюта
		|И 	СтарыйКурс.НачалоПериода <= ОборотыНарастающие.НачалоПериода
		|И	СтарыйКурс.КонецПериода  > 	ОборотыНарастающие.НачалоПериода
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК НовыйУпрКурс
		|ПО НовыйУпрКурс.Валюта			= 	&ВалютаУправленческогоУчета
		|И 	НовыйУпрКурс.НачалоПериода 	<= 	Пересечения.НачалоПериода
		|И	НовыйУпрКурс.КонецПериода  	> 	Пересечения.НачалоПериода 	
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК СтарыйУпрКурс
		|ПО СтарыйУпрКурс.Валюта		= 	&ВалютаУправленческогоУчета
		|И 	СтарыйУпрКурс.НачалоПериода <= 	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1)
		|И	СтарыйУпрКурс.КонецПериода  > 	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1)
		|	
		|СГРУППИРОВАТЬ ПО
		|	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1),
		|	ОборотыНарастающие.Организация
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//92, 93.
		|УНИЧТОЖИТЬ ОборотыРасчетыПоЭквайрингу;
		|УНИЧТОЖИТЬ ОборотыРасчетыПоЭквайрингуНарастающие;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//94.
		|ВЫБРАТЬ
		|	ДСКСписаниюБезналичные.Период								КАК Период,
		|	ДСКСписаниюБезналичные.Организация              			КАК Организация,
		|	ДСКСписаниюБезналичные.БанковскийСчет              			КАК БанковскийСчет,
		|	ДСКСписаниюБезналичные.БанковскийСчет.ВалютаДенежныхСредств	КАК Валюта,
		|	СУММА(ДСКСписаниюБезналичные.СуммаКонечныйОстаток) 		КАК СуммаОстаток
		|ПОМЕСТИТЬ ОборотыДСКСписаниюБезналичные
		|ИЗ
		|	РегистрНакопления.ДенежныеСредстваКСписаниюБезналичные.ОстаткиИОбороты(
		|															ДОБАВИТЬКДАТЕ(&ДатаНачала, ДЕНЬ, -1), 
		|															&ГраницаДатаОкончания,
		|															ДЕНЬ,
		|															, 
		|															) КАК ДСКСписаниюБезналичные
		|
		|ГДЕ
		|	ДСКСписаниюБезналичные.БанковскийСчет.ВалютаДенежныхСредств <> &ВалютаУправленческогоУчета	
		|
		|СГРУППИРОВАТЬ ПО
		|	ДСКСписаниюБезналичные.Период,
		|	ДСКСписаниюБезналичные.Организация,
		|	ДСКСписаниюБезналичные.БанковскийСчет,
		|	ДСКСписаниюБезналичные.БанковскийСчет.ВалютаДенежныхСредств
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//95.
		|ВЫБРАТЬ
		|	ОборотыДСКСписаниюБезналичные.Валюта													КАК Валюта,
		|	ОборотыДСКСписаниюБезналичные.Организация											КАК Организация,
		|	ОборотыДСКСписаниюБезналичные.СуммаОстаток											КАК СуммаОстаток,
		|	ОборотыДСКСписаниюБезналичные.Период 												КАК НачалоПериода,
		|	МИНИМУМ(ISNULL(ОборотыДСКСписаниюБезналичныеКопия.Период, ДАТАВРЕМЯ(3999, 1, 1))) 	КАК КонецПериода
		|ПОМЕСТИТЬ ОборотыДСКСписаниюБезналичныеНарастающие
		|ИЗ
		|   ОборотыДСКСписаниюБезналичные КАК ОборотыДСКСписаниюБезналичные
		|   
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ ОборотыДСКСписаниюБезналичные КАК ОборотыДСКСписаниюБезналичныеКопия
		|ПО ОборотыДСКСписаниюБезналичныеКопия.Организация 	 = ОборотыДСКСписаниюБезналичные.Организация
		|И	ОборотыДСКСписаниюБезналичныеКопия.БанковскийСчет = ОборотыДСКСписаниюБезналичные.БанковскийСчет
		|И	ОборотыДСКСписаниюБезналичныеКопия.Валюта  		 = ОборотыДСКСписаниюБезналичные.Валюта
		|И  ОборотыДСКСписаниюБезналичныеКопия.Период  		 > ОборотыДСКСписаниюБезналичные.Период
		|
		|СГРУППИРОВАТЬ ПО
		|	ОборотыДСКСписаниюБезналичные.Период,
		|	ОборотыДСКСписаниюБезналичные.Валюта,
		|	ОборотыДСКСписаниюБезналичные.Организация,
		|	ОборотыДСКСписаниюБезналичные.СуммаОстаток
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//96.	
		|ВЫБРАТЬ
		|	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1) 								КАК Период,
		|	ОборотыНарастающие.Организация													КАК Организация,
		|  - СУММА((СуммаОстаток * СтарыйКурс.Курс / СтарыйУпрКурс.Курс
		|  - СуммаОстаток * IsNull(НовыйКурс.Курс, СтарыйКурс.Курс) / НовыйУпрКурс.Курс))	КАК КурсоваяРазница
		|ПОМЕСТИТЬ Доходы_ДенежныеСредстваКСписаниюБезналичные
		|ИЗ
		|	ОборотыДСКСписаниюБезналичныеНарастающие КАК ОборотыНарастающие
		|
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ Пересечения КАК Пересечения
		|ПО ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1) >= ОборотыНарастающие.НачалоПериода
		|И	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1) <  ОборотыНарастающие.КонецПериода 	 
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК НовыйКурс
		|ПО НовыйКурс.Валюта         = 	ОборотыНарастающие.Валюта
		|И	НовыйКурс.НачалоПериода >= 	Пересечения.НачалоПериода
		|И	НовыйКурс.НачалоПериода <  	Пересечения.КонецПериода 
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК СтарыйКурс
		|ПО СтарыйКурс.Валюта 	   	 = 	ОборотыНарастающие.Валюта
		|И 	СтарыйКурс.НачалоПериода <= ОборотыНарастающие.НачалоПериода
		|И	СтарыйКурс.КонецПериода  > 	ОборотыНарастающие.НачалоПериода
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК НовыйУпрКурс
		|ПО НовыйУпрКурс.Валюта			= 	&ВалютаУправленческогоУчета
		|И 	НовыйУпрКурс.НачалоПериода 	<= 	Пересечения.НачалоПериода
		|И	НовыйУпрКурс.КонецПериода  	> 	Пересечения.НачалоПериода 	
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК СтарыйУпрКурс
		|ПО СтарыйУпрКурс.Валюта		= 	&ВалютаУправленческогоУчета
		|И 	СтарыйУпрКурс.НачалоПериода <= 	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1)
		|И	СтарыйУпрКурс.КонецПериода  > 	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1)
		|	
		|СГРУППИРОВАТЬ ПО
		|	ДОБАВИТЬКДАТЕ(Пересечения.НачалоПериода, ДЕНЬ, -1),
		|	ОборотыНарастающие.Организация
		|;
        //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//97, 98.
		|УНИЧТОЖИТЬ ОборотыДСКСписаниюБезналичные;
		|УНИЧТОЖИТЬ ОборотыДСКСписаниюБезналичныеНарастающие;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//99.
		|ВЫБРАТЬ
		|	Вл.Организация				КАК Организация,
		|	СУММА(Вл.КурсоваяРазница) 	КАК КурсоваяРазница
		|ИЗ	(
		|		ВЫБРАТЬ
		|			Период,
		|			Организация,
		|			КурсоваяРазница
		|		ИЗ
		|			Доходы_ДенежныеСредстваКПоступлениюБезналичные
		|			
		|		ОБЪЕДИНИТЬ ВСЕ
		|
		|		ВЫБРАТЬ
		|			Период,
		|			Организация,
		|			КурсоваяРазница
		|		ИЗ
		|			Доходы_ДенежныеСредстваКПоступлениюНаличные
		|			
		|		ОБЪЕДИНИТЬ ВСЕ
		|
		|		ВЫБРАТЬ
		|			Период,
		|			Организация,
		|			КурсоваяРазница
		|		ИЗ
		|			Доходы_РасчетыПоЭквайрингу
		|						
		|		ОБЪЕДИНИТЬ ВСЕ
		|
		|		ВЫБРАТЬ
		|			Период,
		|			Организация,
		|			КурсоваяРазница
		|		ИЗ
		|			Доходы_ДенежныеСредстваКСписаниюБезналичные
		|	) КАК Вл
		|
		|СГРУППИРОВАТЬ ПО
		|	Вл.Организация
		|;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 100. Считаем корректировки по Возвратам поставщикам по задаче http://r.ktc-ua.com/issues/2386
		|ВЫБРАТЬ
		|	ВозвратПоставщика.Ссылка КАК ВозвратПоставщику,
		|	ВозвратПоставщика.Номенклатура КАК Номенклатура,
		|	СУММА(ВозвратПоставщика.КоличествоУпаковок) КАК Количество,
		|	СУММА(ВЫБОР
		|			КОГДА ВозвратПоставщика.Ссылка.Валюта = &ВалютаУправленческогоУчета
		|				ТОГДА ВозвратПоставщика.Цена
		|			ИНАЧЕ ВозвратПоставщика.Цена * КурсКассы.Курс / УпрКурс.Курс
		|		КОНЕЦ) КАК Цена,
		|	СУММА(ВЫБОР
		|			КОГДА ВозвратПоставщика.Ссылка.Валюта = &ВалютаУправленческогоУчета
		|				ТОГДА ВозвратПоставщика.Сумма
		|			ИНАЧЕ ВозвратПоставщика.Сумма * КурсКассы.Курс / УпрКурс.Курс
		|		КОНЕЦ) КАК Сумма,
		|	ВозвратПоставщика.СтавкаНДС КАК СтавкаНДС,
		|	СУММА(ВЫБОР
		|			КОГДА ВозвратПоставщика.Ссылка.Валюта = &ВалютаУправленческогоУчета
		|				ТОГДА ВозвратПоставщика.СуммаСНДС
		|			ИНАЧЕ ВозвратПоставщика.СуммаСНДС * КурсКассы.Курс / УпрКурс.Курс
		|		КОНЕЦ) КАК СуммаСНДС
		|ПОМЕСТИТЬ КешДокПо
		|ИЗ
		|	Документ.ВозвратТоваровПоставщику.Товары КАК ВозвратПоставщика
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК КурсКассы
		|		ПО (КурсКассы.Валюта = ВозвратПоставщика.Ссылка.Валюта)
		|			И (КурсКассы.НачалоПериода <= &ДатаОкончания)
		|			И (КурсКассы.КонецПериода > &ДатаОкончания)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК УпрКурс
		|		ПО (УпрКурс.Валюта = &ВалютаУправленческогоУчета)
		|			И (УпрКурс.НачалоПериода <= &ДатаОкончания)
		|			И (УпрКурс.КонецПериода > &ДатаОкончания)
		|ГДЕ
		|	ВозвратПоставщика.Ссылка.Проведен
		|	И ВозвратПоставщика.Ссылка.Дата >= &ДатаНачала
		|	И ВозвратПоставщика.Ссылка.Дата <= &ДатаОкончания

		|СГРУППИРОВАТЬ ПО
		|	ВозвратПоставщика.Ссылка,
		|	ВозвратПоставщика.Номенклатура,
		|	ВозвратПоставщика.СтавкаНДС
		|;


	    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 101.
		|ВЫБРАТЬ
		|	НАЧАЛОПЕРИОДА(ДанныеДокумента.Ссылка.Дата, МЕСЯЦ) КАК ПериодМесяц,
		|	ДанныеДокумента.Организация КАК Организация,
		|	ДанныеДокумента.Ссылка.ПредварительныйРасчет КАК ПредварительныйРасчет
		|ПОМЕСТИТЬ РасчетыСебестоимости
		|ИЗ
		|	Документ.РасчетСебестоимостиТоваров.Организации КАК ДанныеДокумента
		|ГДЕ
		|	ДанныеДокумента.Ссылка.Проведен
		|	И (ДанныеДокумента.Ссылка.Дата >= &ДатаНачала 
		|		И ДанныеДокумента.Ссылка.Дата <= &ДатаОкончания)
		|;
       	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 102.
		|ВЫБРАТЬ
		|	СебестоимостьТоваров.Организация КАК Организация,
		|	АналитикаНоменклатуры.Номенклатура КАК Номенклатура,
		|	АналитикаНоменклатуры.Склад КАК Склад,
		|	&ВалютаУправленческогоУчета КАК Валюта,
		|	ВЫБОР
		|		КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
		|			ТОГДА СебестоимостьТоваров.ХозяйственнаяОперация
		|		ИНАЧЕ NULL
		|	КОНЕЦ КАК ХозяйственнаяОперацияРасход,
		|	СебестоимостьТоваров.АналитикаРасходов КАК АналитикаРасходов,
		|	КешДокПо.Количество КАК Количество,
		|	ВЫБОР
		|		КОГДА КешДокПо.ВозвратПоставщику.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
		|			ТОГДА ВЫБОР
		|					КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
		|						ТОГДА ЕСТЬNULL(СтоимостьНоменклатуры.Стоимость, 0) * СебестоимостьТоваров.Количество
		|					ИНАЧЕ СебестоимостьТоваров.Стоимость
		|				КОНЕЦ
		|		ИНАЧЕ ВЫБОР
		|				КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
		|					ТОГДА ЕСТЬNULL(СтоимостьНоменклатуры.Стоимость, 0) * СебестоимостьТоваров.Количество
		|				ИНАЧЕ СебестоимостьТоваров.Стоимость
		|			КОНЕЦ
		|	КОНЕЦ КАК СтоимостьПоступления,
		|	ВЫБОР
		|		КОГДА КешДокПо.ВозвратПоставщику.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
		|			ТОГДА ВЫБОР
		|					КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
		|							И ЕСТЬNULL(РасчетыСебестоимости.ПредварительныйРасчет, ЛОЖЬ)
		|						ТОГДА ЕСТЬNULL(СтоимостьНоменклатуры.СтоимостьДопРасходы, 0) * СебестоимостьТоваров.Количество
		|					ИНАЧЕ СебестоимостьТоваров.СуммаДопРасходов
		|				КОНЕЦ
		|		ИНАЧЕ ВЫБОР
		|				КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
		|						И ЕСТЬNULL(РасчетыСебестоимости.ПредварительныйРасчет, ЛОЖЬ)
		|					ТОГДА ЕСТЬNULL(СтоимостьНоменклатуры.СтоимостьДопРасходыБезНДС, 0) * СебестоимостьТоваров.Количество
		|				ИНАЧЕ СебестоимостьТоваров.СуммаДопРасходовБезНДС
		|			КОНЕЦ
		|	КОНЕЦ КАК ДопРасходы
		|ПОМЕСТИТЬ КешСебестоимость
		|ИЗ
		|	РегистрНакопления.СебестоимостьТоваров КАК СебестоимостьТоваров
		|		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаНоменклатуры КАК АналитикаНоменклатуры
		|		ПО СебестоимостьТоваров.АналитикаУчетаНоменклатуры = АналитикаНоменклатуры.КлючАналитики}
		|		{ЛЕВОЕ СОЕДИНЕНИЕ РасчетыСебестоимости КАК РасчетыСебестоимости
		|		ПО СебестоимостьТоваров.Организация = РасчетыСебестоимости.Организация
		|			И (НАЧАЛОПЕРИОДА(СебестоимостьТоваров.Период, МЕСЯЦ) = РасчетыСебестоимости.ПериодМесяц)}
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СтоимостьТоваров КАК СтоимостьНоменклатуры
		|		ПО СебестоимостьТоваров.АналитикаУчетаНоменклатуры = СтоимостьНоменклатуры.АналитикаУчетаНоменклатуры
		|			И СебестоимостьТоваров.Организация = СтоимостьНоменклатуры.Организация
		|			И СебестоимостьТоваров.ВидЗапасов = СтоимостьНоменклатуры.ВидЗапасов
		|			И (НАЧАЛОПЕРИОДА(СебестоимостьТоваров.Период, МЕСЯЦ) = СтоимостьНоменклатуры.Период)
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ КешДокПо КАК КешДокПо
		|		ПО СебестоимостьТоваров.АналитикаУчетаНоменклатуры.Номенклатура = КешДокПо.Номенклатура
		|ГДЕ
		|	СебестоимостьТоваров.Период >= &ДатаНачала
		|	И СебестоимостьТоваров.Период <= &ДатаОкончания
		|	И ВЫБОР
		|			КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
		|				ТОГДА СебестоимостьТоваров.ХозяйственнаяОперация
		|			ИНАЧЕ NULL
		|		КОНЕЦ = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратТоваровПоставщику)
		|	И СебестоимостьТоваров.Количество <> 0
		|;

		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 103.
		|ВЫБРАТЬ
		|	КешСебестоимость.Организация,
		|	КешСебестоимость.Номенклатура,
		|	КешСебестоимость.Валюта,
		|	СУММА(КешСебестоимость.Количество) КАК Количество,
		|	СУММА(КешСебестоимость.СтоимостьПоступления) КАК СтоимостьПоступления,
		|	СУММА(КешСебестоимость.ДопРасходы) КАК ДопРасходы
		|ПОМЕСТИТЬ КешГрупировкаСумма
		|ИЗ
		|	КешСебестоимость КАК КешСебестоимость

		|СГРУППИРОВАТЬ ПО
		|	КешСебестоимость.Организация,
		|	КешСебестоимость.Номенклатура,
		|	КешСебестоимость.Валюта
       	|;
        //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 104.
		|ВЫБРАТЬ
		|	КешГрупировкаСумма.Организация,
		|	КешГрупировкаСумма.Номенклатура,
		|	ВЫБОР
		|		КОГДА КешГрупировкаСумма.Количество <> 0
		|			ТОГДА КешГрупировкаСумма.СтоимостьПоступления / КешГрупировкаСумма.Количество
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК ЦенаПоступления,
		|	ВЫБОР
		|		КОГДА КешГрупировкаСумма.Количество <> 0
		|			ТОГДА КешГрупировкаСумма.СтоимостьПоступления + КешГрупировкаСумма.ДопРасходы / КешГрупировкаСумма.Количество
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СредняяЦена,
		|	КешГрупировкаСумма.СтоимостьПоступления + КешГрупировкаСумма.ДопРасходы КАК Себестоимость,
		|	КешДокПо.Сумма / КешДокПо.Количество КАК ЦенаИзДокумента,
		|	КешДокПо.Количество КАК КоличествоИзДок
		|ПОМЕСТИТЬ КешСумма
		|ИЗ
		|	КешГрупировкаСумма КАК КешГрупировкаСумма
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ КешДокПо КАК КешДокПо
		|		ПО КешГрупировкаСумма.Номенклатура = КешДокПо.Номенклатура
        |;
        //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 105.
		|ВЫБРАТЬ
		|	КешСумма.Организация,
		|	КешСумма.Номенклатура,
		|	КешСумма.КоличествоИзДок * (КешСумма.ЦенаИзДокумента - КешСумма.ЦенаПоступления) КАК Разница
		|ПОМЕСТИТЬ КешРазница
		|ИЗ
		|	КешСумма КАК КешСумма
		|;
        //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 106.
		|ВЫБРАТЬ
		|	КешРазница.Организация		КАК Организация,
		|	СУММА(КешРазница.Разница) 	КАК Сумма
		|ИЗ
		|	КешРазница КАК КешРазница
		|ГДЕ
		|	КешРазница.Разница > 0
		|СГРУППИРОВАТЬ ПО
		|	КешРазница.Организация
		|;
        //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 107.
		|ВЫБРАТЬ
		|	КешРазница.Организация				КАК Организация,
		|	СУММА(КешРазница.Разница) * (-1) 	КАК Сумма
		|ИЗ
		|	КешРазница КАК КешРазница
		|ГДЕ
		|	КешРазница.Разница < 0
		|СГРУППИРОВАТЬ ПО
		|	КешРазница.Организация
		|;

		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		|УНИЧТОЖИТЬ КешДокПо;
		|УНИЧТОЖИТЬ РасчетыСебестоимости;
		|УНИЧТОЖИТЬ КешГрупировкаСумма;
		|УНИЧТОЖИТЬ КешСумма;
		|УНИЧТОЖИТЬ КешРазница;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		|УНИЧТОЖИТЬ Доходы_ДенежныеСредстваКПоступлениюНаличные;
		|УНИЧТОЖИТЬ Доходы_ДенежныеСредстваКПоступлениюБезналичные;
		|УНИЧТОЖИТЬ Доходы_РасчетыПоЭквайрингу;
		|УНИЧТОЖИТЬ Доходы_ДенежныеСредстваКСписаниюБезналичные;
        //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//
		|УНИЧТОЖИТЬ ТаблицаКурсов;
		|УНИЧТОЖИТЬ Пересечения;
		|УНИЧТОЖИТЬ Доходы_РасчетыСКлиентами;
		|УНИЧТОЖИТЬ Доходы_РасчетыСПоставщиками;
		|УНИЧТОЖИТЬ Доходы_НаличныеДенежныеСредства;
		|УНИЧТОЖИТЬ Доходы_БезналичныеДенежныеСредства;
		|УНИЧТОЖИТЬ Доходы_ДенежныеСредстваУПодотчетныхЛиц;
		|УНИЧТОЖИТЬ Расходы_РасчетыСКлиентами;
		|УНИЧТОЖИТЬ Расходы_РасчетыСПоставщиками;
		|УНИЧТОЖИТЬ Расходы_ДенежныеСредстваУПодотчетныхЛиц;	
		|";		
	Возврат ТекстЗапроса;
	
КонецФункции // ПолучитьТекстЗапросаБаланс()

// Текст запроса просроченной дебиторской задолжености.
//
// Возвращаемое значение:
//  Строка - текст запроса.
//
Функция ПолучитьТекстЗапросаПросрочки()
	
	ТекстЗапроса = "
		//////////////////////////////////////////////////////////////////////////////////////////
		//1. Курсы валют
		|ВЫБРАТЬ
		|	Валюта,
		|	Курс / Кратность КАК Курс
		|ПОМЕСТИТЬ КурсыВалют	
		|ИЗ
		|	РегистрСведений.КурсыВалют.СрезПоследних
		|	
		|ИНДЕКСИРОВАТЬ ПО
		|	Валюта
		|;
		//////////////////////////////////////////////////////////////////////////////////////////
		//2. Аналитика
		|ВЫБРАТЬ
		|	Партнер,
		|	Организация,
		|	КлючАналитики
		|ПОМЕСТИТЬ Аналитика	
		|ИЗ
		|	РегистрСведений.АналитикаУчетаПоПартнерам
		|	
		|ИНДЕКСИРОВАТЬ ПО
		|	КлючАналитики		
		|;
		//////////////////////////////////////////////////////////////////////////////////////////
		//3. Долги
		|ВЫБРАТЬ
		|	Аналитика.Партнер 		КАК Партнер,
		|	Аналитика.Организация 	КАК Организация,
		|	Сумма(	ВЫБОР ВалютаУправленческогоУчета.Значение
		|				КОГДА Долги.Валюта
		|				ТОГДА Долги.СуммаОстаток
		|				ИНАЧЕ Долги.СуммаОстаток / КурсыВалютУПР.Курс * КурсыВалют.Курс
		|			КОНЕЦ
		|		  ) КАК Долг	

		|ПОМЕСТИТЬ Долги
		|ИЗ
		|	(
		|		ВЫБРАТЬ
		|			АналитикаУчетаПоПартнерам,
		|			Валюта,
		|			СуммаОстаток
		|		ИЗ
		|			РегистрНакопления.РасчетыСКлиентами.Остатки(&ГраницаТекущаяДата, АналитикаУчетаПоПартнерам В (ВЫБРАТЬ КлючАналитики ИЗ Аналитика)) КАК РасчетыСКлиентами
		|			
		|		ОБЪЕДИНИТЬ ВСЕ
		|								
		|		ВЫБРАТЬ
		|			АналитикаУчетаПоПартнерам,
		|			Валюта,
		|			СуммаОстаток 				
		|		ИЗ
		|			РегистрНакопления.РасчетыСПоставщиками.Остатки(&ГраницаТекущаяДата, АналитикаУчетаПоПартнерам В (ВЫБРАТЬ КлючАналитики ИЗ Аналитика)) КАК РасчетыСПоставщиками 
		|	) КАК Долги
		|	
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ Аналитика КАК Аналитика
		|ПО 	Аналитика.КлючАналитики = Долги.АналитикаУчетаПоПартнерам

		|ЛЕВОЕ СОЕДИНЕНИЕ Константа.ВалютаУправленческогоУчета КАК ВалютаУправленческогоУчета
		|ПО  Истина

		|ЛЕВОЕ СОЕДИНЕНИЕ КурсыВалют КАК КурсыВалютУПР
		|ПО	КурсыВалютУПР.Валюта = ВалютаУправленческогоУчета.Значение

		|ЛЕВОЕ СОЕДИНЕНИЕ КурсыВалют КАК КурсыВалют
		|ПО	КурсыВалют.Валюта = Долги.Валюта						

		|СГРУППИРОВАТЬ ПО
		|	Аналитика.Партнер,
		|	Аналитика.Организация
		|;
		//////////////////////////////////////////////////////////////////////////////////////////
		//4. ГрафикОплат
		|ВЫБРАТЬ
		|	Ссылка,
		|	МИНИМУМ(ДатаПлатежа) КАК ДатаПлатежа
		|	
		|ПОМЕСТИТЬ ГрафикОплат
		|ИЗ
		|	Документ.ЗаказКлиента.ЭтапыГрафикаОплаты

		|СГРУППИРОВАТЬ ПО 
		|	Ссылка
		|;
		//////////////////////////////////////////////////////////////////////////////////////////
		//5. Возвраты товаров клиентов
		|ВЫБРАТЬ
		|	АналитикаУчетаПоПартнерам												КАК КлючАналитики,
		|	ВЫРАЗИТЬ(Регистратор КАК Документ.ВозвратТоваровОтКлиента)				КАК Регистратор,
		|	ВЫРАЗИТЬ(Регистратор КАК Документ.ВозвратТоваровОтКлиента).Валюта		КАК Валюта
		|ПОМЕСТИТЬ ПервыйКеш_Возвраты        
		|ИЗ
		|	РегистрНакопления.РасчетыСКлиентами.ОстаткиИОбороты(, &ГраницаТекущаяДата, Регистратор, , АналитикаУчетаПоПартнерам В (ВЫБРАТЬ КлючАналитики ИЗ Аналитика))
		|ГДЕ
		|	Регистратор Ссылка Документ.ВозвратТоваровОтКлиента
		|И	СуммаОборот <> 0

		|ИНДЕКСИРОВАТЬ ПО
		|	Регистратор,
		|	КлючАналитики
		|;
		//////////////////////////////////////////////////////////////////////////////////////////
		//6. Возвраты товаров клиентов привязаные к реализациям
		|ВЫБРАТЬ
		|	Возвраты.КлючАналитики,
		|	Возвраты.Валюта,										
		|   	ВозвратыТовары.ДокументРеализации,
		|   	Сумма(ВозвратыТовары.СуммаСНДС) КАК СуммаРасход
		|ПОМЕСТИТЬ ВторойКеш_Возвраты        
		|ИЗ
		|	ПервыйКеш_Возвраты КАК Возвраты
		|	
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ВозвратТоваровОтКлиента.Товары КАК ВозвратыТовары
		|ПО	ВозвратыТовары.Ссылка = Возвраты.Регистратор

		|СГРУППИРОВАТЬ ПО 
		|	Возвраты.КлючАналитики,
		|	Возвраты.Валюта,										
		|   	ВозвратыТовары.ДокументРеализации	
		|;
		//////////////////////////////////////////////////////////////////////////////////////////
		//7. Обороты клиентов cache
		|ВЫБРАТЬ
		|	АналитикаУчетаПоПартнерам												КАК КлючАналитики,
		|	ВЫРАЗИТЬ(Регистратор КАК Документ.РеализацияТоваровУслуг)				КАК Регистратор,
		|	Регистратор.МоментВремени КАК МоментВремени,
		|	ВЫРАЗИТЬ(Регистратор КАК Документ.РеализацияТоваровУслуг).ЗаказКлиента 	КАК ЗаказКлиента,	
		|	ВЫРАЗИТЬ(Регистратор КАК Документ.РеализацияТоваровУслуг).ДатаПлатежа  	КАК ДатаПлатежа,
		|	Период,
		|	Валюта,
		|	СуммаПриход,
		|	СуммаОборот
		|		
		|ПОМЕСТИТЬ Cache_Обороты
		|ИЗ
		|	РегистрНакопления.РасчетыСКлиентами.ОстаткиИОбороты(, &ГраницаТекущаяДата, Регистратор, , АналитикаУчетаПоПартнерам В (ВЫБРАТЬ КлючАналитики ИЗ Аналитика))
		|ГДЕ
		|	Регистратор Ссылка Документ.РеализацияТоваровУслуг
		|И	СуммаОборот <> 0			
		|;
		//////////////////////////////////////////////////////////////////////////////////////////
		//8. Обороты клиентов
		|ВЫБРАТЬ
		|	Аналитика.Партнер		КАК Партнер,
		| 	Аналитика.Организация 	КАК Организация,
		|	Обороты.Регистратор,
		|	Обороты.Период,
		|	ВЫБОР
		|		КОГДА Обороты.ЗаказКлиента = Значение(Документ.ЗаказКлиента.ПустаяСсылка) 
		|		  ИЛИ Обороты.ЗаказКлиента = Неопределено
		|		  ИЛИ Обороты.ЗаказКлиента = NULL
		|		ТОГДА Обороты.ДатаПлатежа
		|		ИНАЧЕ ГрафикОплат.ДатаПлатежа
		|	КОНЕЦ КАК ДатаПлатежа,
		|   	Обороты.МоментВремени,
		|	ВЫБОР 
		|		КОГДА ВалютаУправленческогоУчета.Значение = Обороты.Валюта
		|		ТОГДА Обороты.СуммаПриход 		
		|		ИНАЧЕ Обороты.СуммаПриход / КурсыВалютУПР.Курс * КурсыВалют.Курс
		|	КОНЕЦ -	ВЫБОР
		|			  	КОГДА IsNull(Возвраты.СуммаРасход, 0) = 0 
		|			  	ТОГДА 0
		|				КОГДА ВалютаУправленческогоУчета.Значение = Возвраты.Валюта
		|				ТОГДА Возвраты.СуммаРасход
		|				ИНАЧЕ Возвраты.СуммаРасход / КурсыВалютУПР.Курс * КурсыВозвраты.Курс
		|			КОНЕЦ КАК Сумма,
		|	ВЫБОР 
		|		КОГДА ВалютаУправленческогоУчета.Значение = Обороты.Валюта
		|		ТОГДА Обороты.СуммаОборот
		|		ИНАЧЕ Обороты.СуммаОборот / КурсыВалютУПР.Курс * КурсыВалют.Курс
		|	КОНЕЦ -	ВЫБОР
		|			  	КОГДА IsNull(Возвраты.СуммаРасход, 0) = 0 
		|			  	ТОГДА 0
		|				КОГДА ВалютаУправленческогоУчета.Значение = Возвраты.Валюта
		|				ТОГДА Возвраты.СуммаРасход
		|				ИНАЧЕ Возвраты.СуммаРасход / КурсыВалютУПР.Курс * КурсыВозвраты.Курс
		|			КОНЕЦ КАК СуммаОборот
		|   
		|ПОМЕСТИТЬ ОборотыПоКлиенту
		|ИЗ
		|	Cache_Обороты КАК Обороты
		|						
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ Аналитика КАК Аналитика
		|ПО Аналитика.КлючАналитики = Обороты.КлючАналитики 						

		|ЛЕВОЕ СОЕДИНЕНИЕ ВторойКеш_Возвраты КАК Возвраты
		|ПО  Возвраты.КлючАналитики 		= Обороты.КлючАналитики
		|И	Возвраты.ДокументРеализации = Обороты.Регистратор

		|ЛЕВОЕ СОЕДИНЕНИЕ КурсыВалют КАК КурсыВозвраты
		|ПО	КурсыВозвраты.Валюта = Возвраты.Валюта

		|ЛЕВОЕ СОЕДИНЕНИЕ ГрафикОплат КАК ГрафикОплат
		|ПО ГрафикОплат.Ссылка = Обороты.ЗаказКлиента

		|ЛЕВОЕ СОЕДИНЕНИЕ Константа.ВалютаУправленческогоУчета КАК ВалютаУправленческогоУчета
		|ПО  Истина

		|ЛЕВОЕ СОЕДИНЕНИЕ КурсыВалют КАК КурсыВалютУПР
		|ПО	КурсыВалютУПР.Валюта = ВалютаУправленческогоУчета.Значение

		|ЛЕВОЕ СОЕДИНЕНИЕ КурсыВалют КАК КурсыВалют
		|ПО	КурсыВалют.Валюта = Обороты.Валюта
		|;
		//////////////////////////////////////////////////////////////////////////////////////////
		|УНИЧТОЖИТЬ Аналитика;
		|УНИЧТОЖИТЬ КурсыВалют;
		|УНИЧТОЖИТЬ ГрафикОплат;
		|УНИЧТОЖИТЬ Cache_Обороты;	
		//////////////////////////////////////////////////////////////////////////////////////////
		//9. Обороты по месяцам
		|ВЫБРАТЬ
		|	Партнер     КАК Партнер,
		|	Организация КАК Организация,
		|	НАЧАЛОПЕРИОДА(ДатаПлатежа, МЕСЯЦ) КАК НачПериода,
		|	КОНЕЦПЕРИОДА(ДатаПлатежа, МЕСЯЦ) КАК КонПериода,
		|	СУММА(СуммаОборот) КАК Сумма
		|	
		|ПОМЕСТИТЬ ОборотыПоМесяцам	
		|ИЗ
		|	ОборотыПоКлиенту 
		|															
		|СГРУППИРОВАТЬ ПО
		|	Партнер,	
		|	Организация,
		|	НАЧАЛОПЕРИОДА(ДатаПлатежа, МЕСЯЦ),
		|   	КОНЕЦПЕРИОДА(ДатаПлатежа, МЕСЯЦ)
		|;
		//////////////////////////////////////////////////////////////////////////////////////////
		//10. По месяцам наростающие
		|ВЫБРАТЬ
		|	ОборотыПоМесяцам.Партнер,
		|		ОборотыПоМесяцам.Организация,
		|		ОборотыПоМесяцам.НачПериода,
		|		ОборотыПоМесяцам.КонПериода,
		|		ОборотыПоМесяцам.Сумма,
		|		СУММА(ОборотыПоМесяцамКопия.Сумма) КАК СуммаПосле,
		|		СУММА(ОборотыПоМесяцамКопия.Сумма) - ОборотыПоМесяцам.Сумма КАК СуммаДо
		|ПОМЕСТИТЬ ОборотыПоМесяцамНарастающие
		|ИЗ
		|   ОборотыПоМесяцам КАК ОборотыПоМесяцам
		|   
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ ОборотыПоМесяцам КАК ОборотыПоМесяцамКопия
		|ПО 	ОборотыПоМесяцам.Партнер 	= ОборотыПоМесяцамКопия.Партнер
		|И	ОборотыПоМесяцам.Организация = ОборотыПоМесяцамКопия.Организация
		|И  	ОборотыПоМесяцам.НачПериода <= ОборотыПоМесяцамКопия.НачПериода

		|СГРУППИРОВАТЬ ПО
		|		ОборотыПоМесяцам.НачПериода,
		|		ОборотыПоМесяцам.КонПериода,
		|		ОборотыПоМесяцам.Партнер,
		|		ОборотыПоМесяцам.Организация,
		|		ОборотыПоМесяцам.Сумма
		|;
		//////////////////////////////////////////////////////////////////////////////////////////
		//11. Долги по выбранным месяцам
		|ВЫБРАТЬ
		|	Долги.Партнер,
		|	Долги.Организация,
		|	Долги.Долг,
		|	ОборотыПоМесНарастающие.НачПериода,
		|	ОборотыПоМесНарастающие.КонПериода,
		|	Долги.Долг - ОборотыПоМесНарастающие.СуммаДо КАК ОстатокДолга
		|ПОМЕСТИТЬ ДолгиПоВыбраннымМесяцам
		|ИЗ
		|		Долги КАК Долги
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ ОборотыПоМесяцамНарастающие КАК ОборотыПоМесНарастающие
		|ПО  Долги.Партнер = ОборотыПоМесНарастающие.Партнер
		|И	Долги.Организация = ОборотыПоМесНарастающие.Организация
		|И 	Долги.Долг > ОборотыПоМесНарастающие.СуммаДо
		|И 	Долги.Долг <= ОборотыПоМесНарастающие.СуммаПосле
		|;
		//////////////////////////////////////////////////////////////////////////////////////////
		//12. Движения по выбранным месяцам
		|ВЫБРАТЬ
		|	Обороты.Партнер,
		|	Обороты.Организация,
		|		Обороты.МоментВремени,
		|		Обороты.Регистратор,
		|		Обороты.Период,
		|		ДолгиПоВыбМесяцам.Долг,
		|		ДолгиПоВыбМесяцам.ОстатокДолга,
		|		Обороты.Сумма,
		|		Обороты.ДатаПлатежа КАК ДатаОтсрочки
		|	
		|ПОМЕСТИТЬ ДвиженияПоВыбраннымМесяцам
		|ИЗ
		|	ОборотыПоКлиенту КАК Обороты
		|						
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ ДолгиПоВыбраннымМесяцам КАК ДолгиПоВыбМесяцам
		|ПО  Обороты.Партнер = ДолгиПоВыбМесяцам.Партнер
		|И	Обороты.Организация = ДолгиПоВыбМесяцам.Организация
		|И  	Обороты.ДатаПлатежа >= ДолгиПоВыбМесяцам.НачПериода
		|И  	Обороты.ДатаПлатежа <= ДолгиПоВыбМесяцам.КонПериода
		|;
		//////////////////////////////////////////////////////////////////////////////////////////
		//13. Движения по выбранным месяцам наростающие
		|ВЫБРАТЬ
		|	ДвиженияПоВыбМесяцам.Партнер,
		|	   ДвиженияПоВыбМесяцам.Организация,
		|	   ДвиженияПоВыбМесяцам.Регистратор,
		|	   ДвиженияПоВыбМесяцам.Период,
		|	   ДвиженияПоВыбМесяцам.МоментВремени,
		|	   ДвиженияПоВыбМесяцам.Сумма,
		|	   СУММА(ДвиженияПоВыбМесяцамКопия.Сумма) КАК СуммаПосле,
		|	   СУММА(ДвиженияПоВыбМесяцамКопия.Сумма) - ДвиженияПоВыбМесяцам.Сумма КАК СуммаДо,
		|	   ДвиженияПоВыбМесяцам.ОстатокДолга,
		|	   ДвиженияПоВыбМесяцам.ДатаОтсрочки
		|ПОМЕСТИТЬ ДвиженияПредварительные
		|ИЗ
		|	   ДвиженияПоВыбраннымМесяцам КАК ДвиженияПоВыбМесяцам
		|	   
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ ДвиженияПоВыбраннымМесяцам КАК ДвиженияПоВыбМесяцамКопия
		|ПО 	ДвиженияПоВыбМесяцам.Партнер 		= ДвиженияПоВыбМесяцамКопия.Партнер
		|И	ДвиженияПоВыбМесяцам.Организация 	= ДвиженияПоВыбМесяцамКопия.Организация
		|И  	ДвиженияПоВыбМесяцам.ДатаОтсрочки  <= ДвиженияПоВыбМесяцамКопия.ДатаОтсрочки
		|И	ВЫБОР
		|		КОГДА ДвиженияПоВыбМесяцам.ДатаОтсрочки   = ДвиженияПоВыбМесяцамКопия.ДатаОтсрочки
		|		ТОГДА ДвиженияПоВыбМесяцам.МоментВремени <= ДвиженияПоВыбМесяцамКопия.МоментВремени
		|		ИНАЧЕ ИСТИНА
		|	КОНЕЦ
		|	   
		|СГРУППИРОВАТЬ ПО
		|	ДвиженияПоВыбМесяцам.Партнер,
		|	   ДвиженияПоВыбМесяцам.Организация,
		|	   ДвиженияПоВыбМесяцам.Регистратор,
		|	   ДвиженияПоВыбМесяцам.Период,
		|	   ДвиженияПоВыбМесяцам.МоментВремени,
		|	   ДвиженияПоВыбМесяцам.Сумма,
		|	   ДвиженияПоВыбМесяцам.ОстатокДолга,
		|	   ДвиженияПоВыбМесяцам.ДатаОтсрочки
		|;
		/////////////////////////////////////////////////////////////////////////////////////////////
		|УНИЧТОЖИТЬ ПервыйКеш_Возвраты;
		|УНИЧТОЖИТЬ ВторойКеш_Возвраты;
		|УНИЧТОЖИТЬ ОборотыПоМесяцам;
		|УНИЧТОЖИТЬ ОборотыПоМесяцамНарастающие;
		|УНИЧТОЖИТЬ Долги;
		|УНИЧТОЖИТЬ ДолгиПоВыбраннымМесяцам;
		|УНИЧТОЖИТЬ ДвиженияПоВыбраннымМесяцам;
		/////////////////////////////////////////////////////////////////////////////////////////////
		//14.       
		|ВЫБРАТЬ
		|	 ДвиженияПредв.Партнер,
		|	   ДвиженияПредв.Организация,
		|	   ДвиженияПредв.Регистратор,
		|	   ДвиженияПредв.Период,
		|	   ДвиженияПредв.МоментВремени,
		|	   ДвиженияПредв.ОстатокДолга - ДвиженияПредв.СуммаДо КАК СуммаДолга,
		|	   ДвиженияПредв.Сумма,
		|	   ДвиженияПредв.ДатаОтсрочки
		|ПОМЕСТИТЬ ДвиженияОкончательные
		|ИЗ
		|	   ДвиженияПредварительные КАК ДвиженияПредв
		|ГДЕ
		|	ДвиженияПредв.ОстатокДолга > ДвиженияПредв.СуммаДо
		|И 	ДвиженияПредв.ОстатокДолга <= ДвиженияПредв.СуммаПосле
		|;
		/////////////////////////////////////////////////////////////////////////////////////////////
		//15. 
		|ВЫБРАТЬ
		|	Обороты.Организация КАК Организация,
		|	СУММА(    ВЫБОР
		|			КОГДА Обороты.ДатаПлатежа < &ТекущаяДата
		|			ТОГДА 	ВЫБОР
		|	   					КОГДА Обороты.Регистратор = ДвиженияОконч.Регистратор
		|						ТОГДА ДвиженияОконч.СуммаДолга
		|						ИНАЧЕ Обороты.Сумма
		|	   				КОНЕЦ
		|			ИНАЧЕ 0
		|		КОНЕЦ) КАК СуммаПросроченныхОплат

		|ИЗ
		|	   ОборотыПоКлиенту  КАК Обороты

		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ ДвиженияОкончательные КАК ДвиженияОконч
		|ПО  ДвиженияОконч.Партнер 		= Обороты.Партнер
		|И	ДвиженияОконч.Организация 	= Обороты.Организация
		|И  	ДвиженияОконч.ДатаОтсрочки  <= Обороты.ДатаПлатежа 
		|И	ВЫБОР
		|		КОГДА ДвиженияОконч.ДатаОтсрочки = Обороты.ДатаПлатежа 
		|		ТОГДА ДвиженияОконч.МоментВремени <= Обороты.МоментВремени
		|		ИНАЧЕ ИСТИНА
		|	КОНЕЦ
		| 
		|ГДЕ
		|	Обороты.ДатаПлатежа < &ТекущаяДата

		|СГРУППИРОВАТЬ ПО
		|	Обороты.Организация
		|		  
		|;
		/////////////////////////////////////////////////////////////////////////////////////////////
		|УНИЧТОЖИТЬ ОборотыПоКлиенту;
		|УНИЧТОЖИТЬ ДвиженияПредварительные;
		|УНИЧТОЖИТЬ ДвиженияОкончательные;
		|";
	Возврат ТекстЗапроса;
			        		
КонецФункции

// Текст запроса который получает из таблицы ТаблицаДокументыПоступления
// список документов которые пользователь указал для перепроведения.
//
// Возвращаемое значение:
//  Строка - текст запроса.
//
Функция ПолучитьТекстЗапросаИсправлениеПоступленияТоваров()

	ТекстЗапроса = "ВЫБРАТЬ
	               |	ТаблицаПоступлений.Ссылка	КАК Ссылка,
	               |	ТаблицаПоступлений.Флаг		КАК Флаг
	               |ПОМЕСТИТЬ ТаблицаПоступлений
	               |ИЗ
	               |	&ТаблицаПоступлений КАК ТаблицаПоступлений
	               |;
				   |
				   |////////////////////////////////////////////////////////////////////////////////
				   |ВЫБРАТЬ
				   |	Расхождения.Ссылка 				КАК Ссылка,
				   |	КОЛИЧЕСТВО(Расхождения.Ссылка) 	КАК КоличествоРасхождения
				   |ПОМЕСТИТЬ СписокРасхождений
				   |ИЗ
				   |	Документ.ПоступлениеТоваровУслуг.Расхождения КАК Расхождения
				   |		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ТаблицаПоступлений КАК ТаблицаПоступлений
				   |		ПО Расхождения.Ссылка = ТаблицаПоступлений.Ссылка
				   |СГРУППИРОВАТЬ ПО
				   |	Расхождения.Ссылка
				   |;
	               |
	               |////////////////////////////////////////////////////////////////////////////////
	               |ВЫБРАТЬ
	               |	ТаблицаПоступлений.Ссылка КАК Ссылка,
				   |	ВЫБОР
				   |		КОГДА ЕСТЬNULL(СписокРасхождений.КоличествоРасхождения, 0) = 0
				   |			ТОГДА ЛОЖЬ
				   |		ИНАЧЕ ИСТИНА
				   |	КОНЕЦ КАК ЕстьРасхождения
	               |ИЗ
	               |	ТаблицаПоступлений КАК ТаблицаПоступлений
				   |		ЛЕВОЕ СОЕДИНЕНИЕ СписокРасхождений КАК СписокРасхождений
				   |		ПО ТаблицаПоступлений.Ссылка = СписокРасхождений.Ссылка
	               |ГДЕ
	               |	Флаг";
	
	Возврат ТекстЗапроса;

КонецФункции // ПолучитьТекстЗапросаИсправлениеПоступленияТоваров()

// Текст запроса который получает из таблицы ТаблицаДокументыВнутреннегоПотребления
// список документов которые пользователь указал для перепроведения.
//
// Возвращаемое значение:
//  Строка - текст запроса.
//
Функция ПолучитьТекстЗапросаИсправлениеВнутреннегоПотребленияТоваров()
	
	ТекстЗапроса = "ВЫБРАТЬ
	               |	ТаблицаВнутреннегоПотребления.Ссылка	КАК Ссылка,
	               |	ТаблицаВнутреннегоПотребления.Флаг 		КАК Флаг
	               |ПОМЕСТИТЬ ТаблицаВнутреннегоПотребления
	               |ИЗ
	               |	&ТаблицаВнутреннегоПотребления КАК ТаблицаВнутреннегоПотребления
	               |;
	               |
	               |////////////////////////////////////////////////////////////////////////////////
	               |ВЫБРАТЬ
	               |	Ссылка КАК Ссылка
	               |ИЗ
	               |	ТаблицаВнутреннегоПотребления 
				   |ГДЕ
	               |	Флаг";
	Возврат ТекстЗапроса;

КонецФункции

Функция ПолучитьТекстЗапросаИсправлениеФинДокументов()
	
	ТекстЗапроса = "ВЫБРАТЬ
                |	ТаблицаФинДокументы.Документ КАК Ссылка,
                |	ТаблицаФинДокументы.Флаг КАК Флаг,
                |	ТаблицаФинДокументы.КурсВзаиморасчетов КАК КурсВзаиморасчетов
                |ПОМЕСТИТЬ ТаблицаФинДокументы
                |ИЗ
                |	&ТаблицаФинДокументы КАК ТаблицаФинДокументы
                |;
                |
                |////////////////////////////////////////////////////////////////////////////////
                |ВЫБРАТЬ
                |	ТаблицаФинДокументы.Ссылка КАК Ссылка,
                |	ТаблицаФинДокументы.КурсВзаиморасчетов
                |ИЗ
                |	ТаблицаФинДокументы КАК ТаблицаФинДокументы
                |ГДЕ
                |	ТаблицаФинДокументы.Флаг";
	
	Возврат ТекстЗапроса;

КонецФункции // ПолучитьТекстЗапросаИсправлениеФинДокументов()

// Текст запроса который получает из таблицы ТаблицаКурсовДвиженийДокументов
// список документов которые пользователь указал для перепроведения.
//
// Возвращаемое значение:
//  Строка - текст запроса.
//
Функция ПолучитьТекстЗапросаИсправленияКурсаДвиженийДокументов()

	ТекстЗапроса = "ВЫБРАТЬ
	               |	ТаблицаКурсовДвиженийДокументов.Ссылка	КАК Ссылка,
	               |	ТаблицаКурсовДвиженийДокументов.Флаг 		КАК Флаг
	               |ПОМЕСТИТЬ ТаблицаКурсовДвиженийДокументов
	               |ИЗ
	               |	&ТаблицаКурсовДвиженийДокументов КАК ТаблицаКурсовДвиженийДокументов
	               |;
	               |
	               |////////////////////////////////////////////////////////////////////////////////
	               |ВЫБРАТЬ
	               |	Ссылка КАК Ссылка
	               |ИЗ
	               |	ТаблицаКурсовДвиженийДокументов 
				   |ГДЕ
	               |	Флаг";
	
	Возврат ТекстЗапроса;

КонецФункции // ПолучитьТекстЗапросаИсправленияКурсаДвиженийДокументов()

// Текст запроса который получает остатки товаров организаций на складах 
//
// Возвращаемое значение:
//  Строка - текст запроса.
//
Функция	ПолучитьТекстЗапросаСоздатьДокументыПередачиТоваров()
	
	ТекстЗапроса =
		// Получаем список товаров по остатках на доступных складах организаций по задаче  http://r.ktc-ua.com/issues/2472";
		"ВЫБРАТЬ
		|	Склад 																				КАК Склад,
		|	Организация 																		КАК Организация
		|ПОМЕСТИТЬ КешДоступныеСклады
		|ИЗ
		|	РегистрСведений.Модуль_ДоступныеСклады
		|ГДЕ
		|	НЕ Склад.ПометкаУдаления
		|	И НЕ Организация.ПометкаУдаления
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Склад,
		|	Организация
		|;
		|
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	Номенклатура 																		КАК Номенклатура
		|ПОМЕСТИТЬ КешНоменклатуры
		|ИЗ
		|	РегистрНакопления.ТоварыОрганизаций.Остатки(&ТекущаяДата, )
		|ГДЕ
		|	КоличествоОстаток > 0
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Номенклатура
		|;
		|
		|ВЫБРАТЬ
		|	Цена 																				КАК Цена,
		|	Номенклатура 																		КАК Номенклатура,
		|	Упаковка 																			КАК Упаковка,
		|	Упаковка.Коэффициент																КАК Коэффициент
		|ПОМЕСТИТЬ КешЦены
		|ИЗ
		|	РегистрСведений.ЦеныНоменклатуры.СрезПоследних(
		|			&ТекущаяДата,
		|			Номенклатура В
		|					(ВЫБРАТЬ
		|						КешНоменклатуры.Номенклатура
		|					 ИЗ
		|						КешНоменклатуры)
		|			И ВидЦены = &ВидЦены)
		|ГДЕ
		|	Валюта = &Валюта
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Номенклатура
		|;
		|
		|ВЫБРАТЬ
		|	КешДоступныеСклады.Склад 															КАК Склад,
		|	КешДоступныеСклады.Организация 														КАК ОрганизацияПолучатель,
		|	ТоварыОрганизацийОстатки.Организация 												КАК Организация,
		|	ТоварыОрганизацийОстатки.Номенклатура 												КАК Номенклатура,
		|	ТоварыОрганизацийОстатки.КоличествоОстаток											КАК КоличествоУпаковок,
		|	ТоварыОрганизацийОстатки.Номенклатура.ЕдиницаИзмерения 								КАК ЕдиницаИзмерения,
		|	&ВидЦены 																			КАК ВидЦены,
		|	ЕСТЬNULL(КешЦены.Цена, 0) 															КАК Цена,
		|	ЕСТЬNULL(КешЦены.Упаковка, ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка))	КАК Упаковка,
		|	ЕСТЬNULL(КешЦены.Коэффициент, 1) 													КАК Коэффициент
		|ИЗ
		|	РегистрНакопления.ТоварыОрганизаций.Остатки(
		|			&ТекущаяДата,
		|			Номенклатура В
		|				(ВЫБРАТЬ
		|					КешНоменклатуры.Номенклатура
		|				ИЗ
		|					КешНоменклатуры КАК КешНоменклатуры)) КАК ТоварыОрганизацийОстатки
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ КешДоступныеСклады КАК КешДоступныеСклады
		|		ПО ТоварыОрганизацийОстатки.Склад = КешДоступныеСклады.Склад
		|			И ТоварыОрганизацийОстатки.Организация <> КешДоступныеСклады.Организация
		|		ЛЕВОЕ СОЕДИНЕНИЕ КешЦены КАК КешЦены
		|		ПО ТоварыОрганизацийОстатки.Номенклатура = КешЦены.Номенклатура
		|
		|УПОРЯДОЧИТЬ ПО
		|	Склад
		|ИТОГИ ПО
		|	Склад,
		|	ОрганизацияПолучатель,
		|	Организация";
		
	Возврат ТекстЗапроса;
		
КонецФункции

// Текст запроса который получает из таблицы ТаблицаДокументыПередачи
// список не проведенных документов.
//
// Возвращаемое значение:
//  Строка - текст запроса.
//
Функция ПолучитьТекстЗапросаНеПроведенныеДокументыПередачиТоваров()
	ТекстЗапроса=
		"ВЫБРАТЬ
		|	ТаблицаДокументыПередачи.Ссылка 						КАК Ссылка,
		|	ТаблицаДокументыПередачи.Представление 					КАК Представление,
		|	ТаблицаДокументыПередачи.ОрганизацияПредставление		КАК ОрганизацияПредставление,
		|	ТаблицаДокументыПередачи.ПолучательПредставление		КАК ПолучательПредставление,
		|	ТаблицаДокументыПередачи.СуммаДокумента					КАК СуммаДокумента,
		|	ТаблицаДокументыПередачи.ВалютаПредставления 			КАК ВалютаПредставления,
		|	ТаблицаДокументыПередачи.ДокументПроведен 				КАК ДокументПроведен
		|ПОМЕСТИТЬ ТаблицаДокументыПередачи
		|ИЗ
		|	&ТаблицаДокументыПередачи КАК ТаблицаДокументыПередачи
		|;
		|
		|ВЫБРАТЬ
		|	ТаблицаДокументыПередачи.Ссылка 						КАК Ссылка,
		|	ТаблицаДокументыПередачи.Представление 					КАК Представление,
		|	ТаблицаДокументыПередачи.ОрганизацияПредставление		КАК ОрганизацияПредставление,
		|	ТаблицаДокументыПередачи.ПолучательПредставление		КАК ПолучательПредставление,
		|	ТаблицаДокументыПередачи.СуммаДокумента					КАК СуммаДокумента,
		|	ТаблицаДокументыПередачи.ВалютаПредставления 			КАК ВалютаПредставления
		|ИЗ
		|	ТаблицаДокументыПередачи КАК ТаблицаДокументыПередачи
		|ГДЕ
		|	НЕ ТаблицаДокументыПередачи.ДокументПроведен";
	Возврат ТекстЗапроса;
КонецФункции

// Текст запроса который получает из таблицы ТаблицаСебестоимостьПередач
// список документов которые пользователь указал для перепроведения.
//
// Возвращаемое значение:
//  Строка - текст запроса.
//
Функция ПолучитьТекстЗапросаИсправитьСебестоимостьПередач()

	ТекстЗапроса = 
		"ВЫБРАТЬ
		|	ТаблицаПередач.Ссылка 							КАК Ссылка,
		|	ТаблицаПередач.Флаг 							КАК Флаг
		|ПОМЕСТИТЬ ТаблицаПередач
		|ИЗ
		|	&ТаблицаПередач КАК ТаблицаПередач
		|ГДЕ
		|	ТаблицаПередач.Флаг
		|;
		|
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	НАЧАЛОПЕРИОДА(Продажи.Период, ДЕНЬ) 												КАК Дата,
		|	Продажи.АналитикаУчетаНоменклатуры.Номенклатура 									КАК Номенклатура,
		|	Продажи.АналитикаУчетаПоПартнерам.Организация 										КАК ОрганизацияОтправитель,
		|	Продажи.КоличествоОборот 															КАК Количество,
		|	ВЫРАЗИТЬ(Продажи.СебестоимостьОборот / Продажи.КоличествоОборот КАК ЧИСЛО(15, 2))	КАК Себестоимость,
		|	Продажи.АналитикаУчетаНоменклатуры,
		|	Продажи.АналитикаУчетаПоПартнерам
		|ПОМЕСТИТЬ КешЦеныНоменклатуры
		|ИЗ
		|	РегистрНакопления.ВыручкаИСебестоимостьПродаж.Обороты(&ДатаНачала, &ДатаОкончания, ДЕНЬ, АналитикаУчетаПоПартнерам.Партнер = ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)) КАК Продажи
		|ГДЕ
		|	Продажи.КоличествоОборот <> 0
		| 	И Продажи.СебестоимостьОборот <> 0
		|	И Продажи.СебестоимостьОборот <> Продажи.СуммаВыручкиОборот
		|;
		|
		|ВЫБРАТЬ
		|	Продажи.Регистратор 											КАК Ссылка,
		|	Продажи.НомерСтроки												КАК НомерСтроки,
		|	КешЦеныНоменклатуры.Себестоимость 								КАК Цена,
		|	КешЦеныНоменклатуры.Номенклатура								КАК Номенклатура,
		|	Продажи.КоличествоОборот * КешЦеныНоменклатуры.Себестоимость	КАК Сумма,
		|	Продажи.КоличествоОборот * КешЦеныНоменклатуры.Себестоимость	КАК СуммаСНДС,
		|	Продажи.КоличествоОборот * КешЦеныНоменклатуры.Себестоимость	КАК СуммаВзаиморасчетов,
		|	ЗНАЧЕНИЕ(Справочник.ВидыЦен.ПустаяСсылка) КАК ВидЦены
		|ИЗ
		|	РегистрНакопления.ВыручкаИСебестоимостьПродаж.Обороты(
		|			&ДатаНачала,
		|			&ДатаОкончания,
		|			АВТО,
		|			АналитикаУчетаПоПартнерам.Партнер = ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)
		|				И (АналитикаУчетаНоменклатуры, АналитикаУчетаПоПартнерам) В
		|					(ВЫБРАТЬ
		|						КешЦеныНоменклатуры.АналитикаУчетаНоменклатуры,
		|						КешЦеныНоменклатуры.АналитикаУчетаПоПартнерам
		|					ИЗ
		|						КешЦеныНоменклатуры КАК КешЦеныНоменклатуры)) КАК Продажи
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ КешЦеныНоменклатуры КАК КешЦеныНоменклатуры
		|		ПО Продажи.АналитикаУчетаНоменклатуры = КешЦеныНоменклатуры.АналитикаУчетаНоменклатуры
		|			И (НАЧАЛОПЕРИОДА(ВЫРАЗИТЬ(Продажи.Регистратор КАК Документ.ПередачаТоваровМеждуОрганизациями).Дата, ДЕНЬ) = КешЦеныНоменклатуры.Дата)
		|			И Продажи.АналитикаУчетаПоПартнерам.Организация = КешЦеныНоменклатуры.ОрганизацияОтправитель
		|ГДЕ
		|	Продажи.КоличествоОборот <> 0
		|	И Продажи.СебестоимостьОборот <> Продажи.СуммаВыручкиОборот
		|	И Продажи.Регистратор В
		|			(ВЫБРАТЬ
		|				ТаблицаПередач.Ссылка
		|			ИЗ
		|				ТаблицаПередач)
		|ИТОГИ ПО
		|	Ссылка";
	Возврат ТекстЗапроса; 

КонецФункции // ПолучитьТекстЗапросаИсправлениеПоступленияТоваров()
#КонецОбласти



Функция СведенияОВнешнейОбработке() Экспорт
	
	//Версия
	Версия = "1.1.54";            
	
	// Объявим переменную, в которой мы сохраним и вернем "наружу" необходимые данные
    ПараметрыРегистрации = Новый Структура;

    // Объявим еще одну переменную, которая нам потребуется ниже
    МассивНазначений = Новый Массив;
    
    // Первый параметр, который мы должны указать - это какой вид обработки системе должна зарегистрировать. 
    // Допустимые типы: ДополнительнаяОбработка, ДополнительныйОтчет, ЗаполнениеОбъекта, Отчет, ПечатнаяФорма, СозданиеСвязанныхОбъектов
    ПараметрыРегистрации.Вставить("Вид", "ДополнительнаяОбработка");	
	ПараметрыРегистрации.Вставить("Назначение", Новый Массив);
    
    // Теперь зададим имя, под которым ВПФ будет зарегистрирована в справочнике внешних обработок
    ПараметрыРегистрации.Вставить("Наименование", "Эспрессо");
    
    // Зададим право обработке на использование безопасного режима. Более подробно можно узнать в справке к платформе (метод УстановитьБезопасныйРежим)
    ПараметрыРегистрации.Вставить("БезопасныйРежим", Ложь);

    // Следующие два параметра играют больше информационную роль, т.е. это то, что будет видеть пользователь в информации к обработке
    ПараметрыРегистрации.Вставить("Версия", Версия);    
    ПараметрыРегистрации.Вставить("Информация", "Эспрессо [" + Версия + "]");
    
    // Создадим таблицу команд (подробнее смотрим ниже)
    ТаблицаКоманд = ПолучитьТаблицуКоманд();
    
    // Добавим команду в таблицу
    ДобавитьКоманду(ТаблицаКоманд, "Эспрессо [" + Версия + "]", "Эспрессо", "ОткрытиеФормы", Ложь, "Эспрессо");
    
    // Сохраним таблицу команд в параметры регистрации обработки
    ПараметрыРегистрации.Вставить("Команды", ТаблицаКоманд);
    
    // Теперь вернем системе наши параметры
    Возврат ПараметрыРегистрации;
	
КонецФункции

Функция ПолучитьТаблицуКоманд()

   // Создадим пустую таблицу команд и колонки в ней
   Команды = Новый ТаблицаЗначений;

   // Как будет выглядеть описание печатной формы для пользователя
   Команды.Колонки.Добавить("Представление", Новый ОписаниеТипов("Строка")); 

   // Имя нашего макета, что бы могли отличить вызванную команду в обработке печати
   Команды.Колонки.Добавить("Идентификатор", Новый ОписаниеТипов("Строка"));

   // Тут задается, как должна вызваться команда обработки
   // Возможные варианты:
   // - ОткрытиеФормы - в этом случае в колонке идентификатор должно быть указано имя формы, которое должна будет открыть система
   // - ВызовКлиентскогоМетода - вызвать клиентскую экспортную процедуру из модуля формы обработки
   // - ВызовСерверногоМетода - вызвать серверную экспортную процедуру из модуля объекта обработки
   Команды.Колонки.Добавить("Использование", Новый ОписаниеТипов("Строка"));

   // Следующий параметр указывает, необходимо ли показывать оповещение при начале и завершению работы обработки. Не имеет смысла при открытии формы
   Команды.Колонки.Добавить("ПоказыватьОповещение", Новый ОписаниеТипов("Булево"));

   // Для печатной формы должен содержать строку ПечатьMXL 
   Команды.Колонки.Добавить("Модификатор", Новый ОписаниеТипов("Строка"));
   
   Возврат Команды;
   
КонецФункции

Процедура ДобавитьКоманду(ТаблицаКоманд, Представление, Идентификатор, Использование, ПоказыватьОповещение = Ложь, Модификатор = "")
  // Добавляем команду в таблицу команд по переданному описанию.
  // Параметры и их значения можно посмотреть в функции ПолучитьТаблицуКоманд
  НоваяКоманда = ТаблицаКоманд.Добавить();
  НоваяКоманда.Представление = Представление;
  НоваяКоманда.Идентификатор = Идентификатор;
  НоваяКоманда.Использование = Использование;
  НоваяКоманда.ПоказыватьОповещение = ПоказыватьОповещение;
  НоваяКоманда.Модификатор = Модификатор;

КонецПроцедуры
