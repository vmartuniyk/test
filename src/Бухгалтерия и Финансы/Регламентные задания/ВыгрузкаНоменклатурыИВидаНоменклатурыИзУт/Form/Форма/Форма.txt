
&НаКлиенте
Процедура Выгрузить(Команда)
	ВыгрузитьНаСервере();
КонецПроцедуры

&НаКлиенте
Процедура ВыгрузкаВсего(Команда)
	ВыгрузкаВсегоНаСервере();
КонецПроцедуры

&НаКлиенте
Процедура ПроверитьПодключение(Команда)
	ПроверитьПодключениеНаСервере();
КонецПроцедуры

&НаСервере
Процедура ВыгрузитьНаСервере()
	РеквизитФормыВЗначение("Объект").ВыгрузитьСписокНоменклатурыИзУТ();
	РеквизитФормыВЗначение("Объект").ВыгрузитьСписокВидаНоменклатурыИзУТ(); 	
КонецПроцедуры


&НаСервере
Процедура ВыгрузкаВсегоНаСервере()
	РеквизитФормыВЗначение("Объект").ВыгрузитьВсегоСпискаВидаНоменклатурыИзУТ(); 
	РеквизитФормыВЗначение("Объект").ВыгрузитьВесьСписокНоменклатурыИВидаИзУТ();
КонецПроцедуры


&НаСервере
Процедура ПроверитьПодключениеНаСервере()
	
	ИмяПользователя 	= ктс_ПредопределенныеЗначенияПовтИсп.ИмяПользователяБух();   	
	Пароль 				= ктс_ПредопределенныеЗначенияПовтИсп.ПарольПользователяБух();   	
	МестоположениеWSDL	= ктс_ПредопределенныеЗначенияПовтИсп.МестоположениеWSDLДляСинхронизации();	

	Прокси = РеквизитФормыВЗначение("Объект").ПолучитьСсылкуWS(МестоположениеWSDL,ИмяПользователя,Пароль);
	Если ТипЗнч(Прокси) = Тип("WSПрокси") Тогда
		ОбщегоНазначенияКлиентСервер.СообщитьПользователю("Работает");
	Иначе
		ОбщегоНазначенияКлиентСервер.СообщитьПользователю("Не Работает"); 
	КонецЕсли;
КонецПроцедуры
