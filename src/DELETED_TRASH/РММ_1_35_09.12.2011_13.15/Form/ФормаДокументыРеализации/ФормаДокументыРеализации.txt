
&НаКлиенте
Процедура МенеджерПриИзменении(Элемент)
	
	ОтборыСписковКлиентСервер.ИзменитьЭлементОтбораСписка(СписокДокументов, "Менеджер", Менеджер, ЗначениеЗаполнено(Менеджер));
	
КонецПроцедуры

&НаКлиенте
Процедура ПриОткрытии(Отказ)
	
	ОтборыСписковКлиентСервер.ИзменитьЭлементОтбораСписка(СписокДокументов, "Менеджер", Менеджер, ЗначениеЗаполнено(Менеджер));
	ПериодВыборкиДокументов.Вариант = ВариантСтандартногоПериода.Сегодня;
	//ДокументыПоТекущемуПользователю();
	
КонецПроцедуры

&НаСервере
Процедура ДокументыПоТекущемуПользователю()
	
	ТаблицаДокументов.Очистить();
	
	Запрос = Новый Запрос;
	ТекстЗапроса = "
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ 
	|ТаблицаШапки.Ссылка              КАК Документ,
	|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.СуммаДокумента )  КАК СуммаДокумента,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Валюта )  КАК Валюта,
|NULL  КАК Склад,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Организация )  КАК Организация,
|	ТаблицаШапки.Номер               КАК Номер,
|NULL КАК Менеджер,
|	ТаблицаШапки.Дата                КАК Дата,
|	ТИПЗНАЧЕНИЯ(ТаблицаШапки.Ссылка) КАК ТипДокумента,
|	ВЫБОР
|		КОГДА ТаблицаШапки.Проведен ТОГДА
|			0
|		КОГДА ТаблицаШапки.ПометкаУдаления ТОГДА
|			1
|		ИНАЧЕ 2
|	КОНЕЦ                        КАК ИдентификаторКартинки
|ИЗ
|	Документ.ВзаимозачетЗадолженности КАК ТаблицаШапки
|ГДЕ
|	ТаблицаШапки.Дата >= НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
|	И (ТаблицаШапки.Дата <= КОНЕЦПЕРИОДА(&ОкончаниеПериода, ДЕНЬ) ИЛИ &ОкончаниеПериода = ДатаВремя(1,1,1))
|	И ( 1 В
|	(ВЫБРАТЬ ПЕРВЫЕ 1
|			1
|	ИЗ
|		Документ.ВзаимозачетЗадолженности.ДебиторскаяЗадолженность КАК ТаблицаСтрок
|	ГДЕ
|		ТаблицаСтрок.Ссылка = ТаблицаШапки.Ссылка
|		И (  ТаблицаСтрок.Партнер = &Параметр  )
|	) ИЛИ  1 В
|	(ВЫБРАТЬ ПЕРВЫЕ 1
|			1
|	ИЗ
|		Документ.ВзаимозачетЗадолженности.КредиторскаяЗадолженность КАК ТаблицаСтрок
|	ГДЕ
|		ТаблицаСтрок.Ссылка = ТаблицаШапки.Ссылка
|		И (  ТаблицаСтрок.Партнер = &Параметр  )
|	))
| ОБЪЕДИНИТЬ ВСЕ ВЫБРАТЬ
|	ТаблицаШапки.Ссылка              КАК Документ,
|	ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.СуммаДокумента )  КАК СуммаДокумента,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Валюта )  КАК Валюта,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Склад )  КАК Склад,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Организация )  КАК Организация,
|	ТаблицаШапки.Номер               КАК Номер,
|	ТаблицаШапки.Менеджер КАК Менеджер,
|	ТаблицаШапки.Дата                КАК Дата,
|	ТИПЗНАЧЕНИЯ(ТаблицаШапки.Ссылка) КАК ТипДокумента,
|	ВЫБОР
|		КОГДА ТаблицаШапки.Проведен ТОГДА
|			0
|		КОГДА ТаблицаШапки.ПометкаУдаления ТОГДА
|			1
|		ИНАЧЕ 2
|	КОНЕЦ                        КАК ИдентификаторКартинки
|ИЗ
|	Документ.ВозвратТоваровОтКлиента КАК ТаблицаШапки
|ГДЕ
|	ТаблицаШапки.Дата >= НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
|	И (ТаблицаШапки.Дата <= КОНЕЦПЕРИОДА(&ОкончаниеПериода, ДЕНЬ) ИЛИ &ОкончаниеПериода = ДатаВремя(1,1,1))
|	И ( ТаблицаШапки.Партнер = &Параметр )
| ОБЪЕДИНИТЬ ВСЕ ВЫБРАТЬ
|	ТаблицаШапки.Ссылка              КАК Документ,
|	ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.СуммаДокумента )  КАК СуммаДокумента,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Валюта )  КАК Валюта,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Склад )  КАК Склад,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Организация )  КАК Организация,
|	ТаблицаШапки.Номер               КАК Номер,
|	ТаблицаШапки.Менеджер КАК Менеджер,
|	ТаблицаШапки.Дата                КАК Дата,
|	ТИПЗНАЧЕНИЯ(ТаблицаШапки.Ссылка) КАК ТипДокумента,
|	ВЫБОР
|		КОГДА ТаблицаШапки.Проведен ТОГДА
|			0
|		КОГДА ТаблицаШапки.ПометкаУдаления ТОГДА
|			1
|		ИНАЧЕ 2
|	КОНЕЦ                        КАК ИдентификаторКартинки
|ИЗ
|	Документ.ВозвратТоваровПоставщику КАК ТаблицаШапки
|ГДЕ
|	ТаблицаШапки.Дата >= НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
|	И (ТаблицаШапки.Дата <= КОНЕЦПЕРИОДА(&ОкончаниеПериода, ДЕНЬ) ИЛИ &ОкончаниеПериода = ДатаВремя(1,1,1))
|	И ( ТаблицаШапки.Партнер = &Параметр )
| ОБЪЕДИНИТЬ ВСЕ ВЫБРАТЬ
|	ТаблицаШапки.Ссылка              КАК Документ,
|	ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.СуммаДокумента )  КАК СуммаДокумента,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Валюта )  КАК Валюта,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Склад )  КАК Склад,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Организация )  КАК Организация,
|	ТаблицаШапки.Номер               КАК Номер,
|	ТаблицаШапки.Куратор КАК Менеджер,
|	ТаблицаШапки.Дата                КАК Дата,
|	ТИПЗНАЧЕНИЯ(ТаблицаШапки.Ссылка) КАК ТипДокумента,
|	ВЫБОР
|		КОГДА ТаблицаШапки.Проведен ТОГДА
|			0
|		КОГДА ТаблицаШапки.ПометкаУдаления ТОГДА
|			1
|		ИНАЧЕ 2
|	КОНЕЦ                        КАК ИдентификаторКартинки
|ИЗ
|	Документ.ЗаданиеТорговомуПредставителю КАК ТаблицаШапки
|ГДЕ
|	ТаблицаШапки.Дата >= НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
|	И (ТаблицаШапки.Дата <= КОНЕЦПЕРИОДА(&ОкончаниеПериода, ДЕНЬ) ИЛИ &ОкончаниеПериода = ДатаВремя(1,1,1))
|	И ( ТаблицаШапки.Партнер = &Параметр )
| ОБЪЕДИНИТЬ ВСЕ ВЫБРАТЬ
|	ТаблицаШапки.Ссылка              КАК Документ,
|	ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.СуммаДокумента )  КАК СуммаДокумента,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Валюта )  КАК Валюта,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Склад )  КАК Склад,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Организация )  КАК Организация,
|	ТаблицаШапки.Номер               КАК Номер,
|	ТаблицаШапки.Менеджер КАК Менеджер,
|	ТаблицаШапки.Дата                КАК Дата,
|	ТИПЗНАЧЕНИЯ(ТаблицаШапки.Ссылка) КАК ТипДокумента,
|	ВЫБОР
|		КОГДА ТаблицаШапки.Проведен ТОГДА
|			0
|		КОГДА ТаблицаШапки.ПометкаУдаления ТОГДА
|			1
|		ИНАЧЕ 2
|	КОНЕЦ                        КАК ИдентификаторКартинки
|ИЗ
|	Документ.ЗаказКлиента КАК ТаблицаШапки
|ГДЕ
|	ТаблицаШапки.Дата >= НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
|	И (ТаблицаШапки.Дата <= КОНЕЦПЕРИОДА(&ОкончаниеПериода, ДЕНЬ) ИЛИ &ОкончаниеПериода = ДатаВремя(1,1,1))
|	И ( ТаблицаШапки.Партнер = &Параметр )
| ОБЪЕДИНИТЬ ВСЕ ВЫБРАТЬ
|	ТаблицаШапки.Ссылка              КАК Документ,
|	ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.СуммаДокумента )  КАК СуммаДокумента,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Валюта )  КАК Валюта,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Склад )  КАК Склад,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Организация )  КАК Организация,
|	ТаблицаШапки.Номер               КАК Номер,
|	ТаблицаШапки.Менеджер КАК Менеджер,
|	ТаблицаШапки.Дата                КАК Дата,
|	ТИПЗНАЧЕНИЯ(ТаблицаШапки.Ссылка) КАК ТипДокумента,
|	ВЫБОР
|		КОГДА ТаблицаШапки.Проведен ТОГДА
|			0
|		КОГДА ТаблицаШапки.ПометкаУдаления ТОГДА
|			1
|		ИНАЧЕ 2
|	КОНЕЦ                        КАК ИдентификаторКартинки
|ИЗ
|	Документ.ЗаказПоставщику КАК ТаблицаШапки
|ГДЕ
|	ТаблицаШапки.Дата >= НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
|	И (ТаблицаШапки.Дата <= КОНЕЦПЕРИОДА(&ОкончаниеПериода, ДЕНЬ) ИЛИ &ОкончаниеПериода = ДатаВремя(1,1,1))
|	И ( ТаблицаШапки.Партнер = &Параметр )
| ОБЪЕДИНИТЬ ВСЕ ВЫБРАТЬ
|	ТаблицаШапки.Ссылка              КАК Документ,
|	ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.СуммаДокумента )  КАК СуммаДокумента,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Валюта )  КАК Валюта,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Склад )  КАК Склад,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Организация )  КАК Организация,
|	ТаблицаШапки.Номер               КАК Номер,
|	ТаблицаШапки.Менеджер КАК Менеджер,
|	ТаблицаШапки.Дата                КАК Дата,
|	ТИПЗНАЧЕНИЯ(ТаблицаШапки.Ссылка) КАК ТипДокумента,
|	ВЫБОР
|		КОГДА ТаблицаШапки.Проведен ТОГДА
|			0
|		КОГДА ТаблицаШапки.ПометкаУдаления ТОГДА
|			1
|		ИНАЧЕ 2
|	КОНЕЦ                        КАК ИдентификаторКартинки
|ИЗ
|	Документ.ЗаявкаНаВозвратТоваровОтКлиента КАК ТаблицаШапки
|ГДЕ
|	ТаблицаШапки.Дата >= НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
|	И (ТаблицаШапки.Дата <= КОНЕЦПЕРИОДА(&ОкончаниеПериода, ДЕНЬ) ИЛИ &ОкончаниеПериода = ДатаВремя(1,1,1))
|	И ( ТаблицаШапки.Партнер = &Параметр )
| ОБЪЕДИНИТЬ ВСЕ ВЫБРАТЬ
|	ТаблицаШапки.Ссылка              КАК Документ,
|	ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.СуммаДокумента )  КАК СуммаДокумента,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Валюта )  КАК Валюта,
| NULL  КАК Склад,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Организация )  КАК Организация,
|	ТаблицаШапки.Номер               КАК Номер,
|	NULL КАК Менеджер,
|	ТаблицаШапки.Дата                КАК Дата,
|	ТИПЗНАЧЕНИЯ(ТаблицаШапки.Ссылка) КАК ТипДокумента,
|	ВЫБОР
|		КОГДА ТаблицаШапки.Проведен ТОГДА
|			0
|		КОГДА ТаблицаШапки.ПометкаУдаления ТОГДА
|			1
|		ИНАЧЕ 2
|	КОНЕЦ                        КАК ИдентификаторКартинки
|ИЗ
|	Документ.ЗаявкаНаРасходованиеДенежныхСредств КАК ТаблицаШапки
|ГДЕ
|	ТаблицаШапки.Дата >= НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
|	И (ТаблицаШапки.Дата <= КОНЕЦПЕРИОДА(&ОкончаниеПериода, ДЕНЬ) ИЛИ &ОкончаниеПериода = ДатаВремя(1,1,1))
|	И ( ТаблицаШапки.Партнер = &Параметр )
| ОБЪЕДИНИТЬ ВСЕ ВЫБРАТЬ
|	ТаблицаШапки.Ссылка              КАК Документ,
|	ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.СуммаДокумента )  КАК СуммаДокумента,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Валюта )  КАК Валюта,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Склад )  КАК Склад,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Организация )  КАК Организация,
|	ТаблицаШапки.Номер               КАК Номер,
|	ТаблицаШапки.Менеджер КАК Менеджер,
|	ТаблицаШапки.Дата                КАК Дата,
|	ТИПЗНАЧЕНИЯ(ТаблицаШапки.Ссылка) КАК ТипДокумента,
|	ВЫБОР
|		КОГДА ТаблицаШапки.Проведен ТОГДА
|			0
|		КОГДА ТаблицаШапки.ПометкаУдаления ТОГДА
|			1
|		ИНАЧЕ 2
|	КОНЕЦ                        КАК ИдентификаторКартинки
|ИЗ
|	Документ.КоммерческоеПредложениеКлиенту КАК ТаблицаШапки
|ГДЕ
|	ТаблицаШапки.Дата >= НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
|	И (ТаблицаШапки.Дата <= КОНЕЦПЕРИОДА(&ОкончаниеПериода, ДЕНЬ) ИЛИ &ОкончаниеПериода = ДатаВремя(1,1,1))
|	И ( ТаблицаШапки.Партнер = &Параметр )
| ОБЪЕДИНИТЬ ВСЕ ВЫБРАТЬ
|	ТаблицаШапки.Ссылка              КАК Документ,
|	ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.СуммаДокумента )  КАК СуммаДокумента,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Валюта )  КАК Валюта,
| NULL  КАК Склад,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Организация )  КАК Организация,
|	ТаблицаШапки.Номер               КАК Номер,
|	NULL КАК Менеджер,
|	ТаблицаШапки.Дата                КАК Дата,
|	ТИПЗНАЧЕНИЯ(ТаблицаШапки.Ссылка) КАК ТипДокумента,
|	ВЫБОР
|		КОГДА ТаблицаШапки.Проведен ТОГДА
|			0
|		КОГДА ТаблицаШапки.ПометкаУдаления ТОГДА
|			1
|		ИНАЧЕ 2
|	КОНЕЦ                        КАК ИдентификаторКартинки
|ИЗ
|	Документ.ОперацияПоПлатежнойКарте КАК ТаблицаШапки
|ГДЕ
|	ТаблицаШапки.Дата >= НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
|	И (ТаблицаШапки.Дата <= КОНЕЦПЕРИОДА(&ОкончаниеПериода, ДЕНЬ) ИЛИ &ОкончаниеПериода = ДатаВремя(1,1,1))
|	И ( ТаблицаШапки.Партнер = &Параметр )
| ОБЪЕДИНИТЬ ВСЕ ВЫБРАТЬ
|	ТаблицаШапки.Ссылка              КАК Документ,
|	ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.СуммаДокумента )  КАК СуммаДокумента,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Валюта )  КАК Валюта,
| NULL  КАК Склад,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Организация )  КАК Организация,
|	ТаблицаШапки.Номер               КАК Номер,
|	ТаблицаШапки.Менеджер КАК Менеджер,
|	ТаблицаШапки.Дата                КАК Дата,
|	ТИПЗНАЧЕНИЯ(ТаблицаШапки.Ссылка) КАК ТипДокумента,
|	ВЫБОР
|		КОГДА ТаблицаШапки.Проведен ТОГДА
|			0
|		КОГДА ТаблицаШапки.ПометкаУдаления ТОГДА
|			1
|		ИНАЧЕ 2
|	КОНЕЦ                        КАК ИдентификаторКартинки
|ИЗ
|	Документ.ОтчетКомиссионера КАК ТаблицаШапки
|ГДЕ
|	ТаблицаШапки.Дата >= НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
|	И (ТаблицаШапки.Дата <= КОНЕЦПЕРИОДА(&ОкончаниеПериода, ДЕНЬ) ИЛИ &ОкончаниеПериода = ДатаВремя(1,1,1))
|	И ( ТаблицаШапки.Партнер = &Параметр )
| ОБЪЕДИНИТЬ ВСЕ ВЫБРАТЬ
|	ТаблицаШапки.Ссылка              КАК Документ,
|	ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.СуммаДокумента )  КАК СуммаДокумента,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Валюта )  КАК Валюта,
| NULL  КАК Склад,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Организация )  КАК Организация,
|	ТаблицаШапки.Номер               КАК Номер,
|	ТаблицаШапки.Менеджер КАК Менеджер,
|	ТаблицаШапки.Дата                КАК Дата,
|	ТИПЗНАЧЕНИЯ(ТаблицаШапки.Ссылка) КАК ТипДокумента,
|	ВЫБОР
|		КОГДА ТаблицаШапки.Проведен ТОГДА
|			0
|		КОГДА ТаблицаШапки.ПометкаУдаления ТОГДА
|			1
|		ИНАЧЕ 2
|	КОНЕЦ                        КАК ИдентификаторКартинки
|ИЗ
|	Документ.ОтчетКомитенту КАК ТаблицаШапки
|ГДЕ
|	ТаблицаШапки.Дата >= НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
|	И (ТаблицаШапки.Дата <= КОНЕЦПЕРИОДА(&ОкончаниеПериода, ДЕНЬ) ИЛИ &ОкончаниеПериода = ДатаВремя(1,1,1))
|	И ( ТаблицаШапки.Партнер = &Параметр )
| ОБЪЕДИНИТЬ ВСЕ ВЫБРАТЬ
|	ТаблицаШапки.Ссылка              КАК Документ,
|	ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.СуммаДокумента )  КАК СуммаДокумента,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Валюта )  КАК Валюта,
| NULL  КАК Склад,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Организация )  КАК Организация,
|	ТаблицаШапки.Номер               КАК Номер,
|	NULL КАК Менеджер,
|	ТаблицаШапки.Дата                КАК Дата,
|	ТИПЗНАЧЕНИЯ(ТаблицаШапки.Ссылка) КАК ТипДокумента,
|	ВЫБОР
|		КОГДА ТаблицаШапки.Проведен ТОГДА
|			0
|		КОГДА ТаблицаШапки.ПометкаУдаления ТОГДА
|			1
|		ИНАЧЕ 2
|	КОНЕЦ                        КАК ИдентификаторКартинки
|ИЗ
|	Документ.ПоступлениеБезналичныхДенежныхСредств КАК ТаблицаШапки
|ГДЕ
|	ТаблицаШапки.Дата >= НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
|	И (ТаблицаШапки.Дата <= КОНЕЦПЕРИОДА(&ОкончаниеПериода, ДЕНЬ) ИЛИ &ОкончаниеПериода = ДатаВремя(1,1,1))
|	И ( ТаблицаШапки.Партнер = &Параметр )
| ОБЪЕДИНИТЬ ВСЕ ВЫБРАТЬ
|	ТаблицаШапки.Ссылка              КАК Документ,
|	ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.СуммаДокумента )  КАК СуммаДокумента,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Валюта )  КАК Валюта,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Склад )  КАК Склад,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Организация )  КАК Организация,
|	ТаблицаШапки.Номер               КАК Номер,
|	ТаблицаШапки.Менеджер КАК Менеджер,
|	ТаблицаШапки.Дата                КАК Дата,
|	ТИПЗНАЧЕНИЯ(ТаблицаШапки.Ссылка) КАК ТипДокумента,
|	ВЫБОР
|		КОГДА ТаблицаШапки.Проведен ТОГДА
|			0
|		КОГДА ТаблицаШапки.ПометкаУдаления ТОГДА
|			1
|		ИНАЧЕ 2
|	КОНЕЦ                        КАК ИдентификаторКартинки
|ИЗ
|	Документ.ПоступлениеТоваровУслуг КАК ТаблицаШапки
|ГДЕ
|	ТаблицаШапки.Дата >= НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
|	И (ТаблицаШапки.Дата <= КОНЕЦПЕРИОДА(&ОкончаниеПериода, ДЕНЬ) ИЛИ &ОкончаниеПериода = ДатаВремя(1,1,1))
|	И ( ТаблицаШапки.Партнер = &Параметр )
| ОБЪЕДИНИТЬ ВСЕ ВЫБРАТЬ
|	ТаблицаШапки.Ссылка              КАК Документ,
|	ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.СуммаДокумента )  КАК СуммаДокумента,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Валюта )  КАК Валюта,
| NULL  КАК Склад,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Организация )  КАК Организация,
|	ТаблицаШапки.Номер               КАК Номер,
|	ТаблицаШапки.Кассир КАК Менеджер,
|	ТаблицаШапки.Дата                КАК Дата,
|	ТИПЗНАЧЕНИЯ(ТаблицаШапки.Ссылка) КАК ТипДокумента,
|	ВЫБОР
|		КОГДА ТаблицаШапки.Проведен ТОГДА
|			0
|		КОГДА ТаблицаШапки.ПометкаУдаления ТОГДА
|			1
|		ИНАЧЕ 2
|	КОНЕЦ                        КАК ИдентификаторКартинки
|ИЗ
|	Документ.ПриходныйКассовыйОрдер КАК ТаблицаШапки
|ГДЕ
|	ТаблицаШапки.Дата >= НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
|	И (ТаблицаШапки.Дата <= КОНЕЦПЕРИОДА(&ОкончаниеПериода, ДЕНЬ) ИЛИ &ОкончаниеПериода = ДатаВремя(1,1,1))
|	И ( ТаблицаШапки.Партнер = &Параметр )
| ОБЪЕДИНИТЬ ВСЕ ВЫБРАТЬ
|	ТаблицаШапки.Ссылка              КАК Документ,
|	ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.СуммаДокумента )  КАК СуммаДокумента,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Валюта )  КАК Валюта,
| NULL  КАК Склад,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Организация )  КАК Организация,
|	ТаблицаШапки.Номер               КАК Номер,
|	ТаблицаШапки.Кассир КАК Менеджер,
|	ТаблицаШапки.Дата                КАК Дата,
|	ТИПЗНАЧЕНИЯ(ТаблицаШапки.Ссылка) КАК ТипДокумента,
|	ВЫБОР
|		КОГДА ТаблицаШапки.Проведен ТОГДА
|			0
|		КОГДА ТаблицаШапки.ПометкаУдаления ТОГДА
|			1
|		ИНАЧЕ 2
|	КОНЕЦ                        КАК ИдентификаторКартинки
|ИЗ
|	Документ.РасходныйКассовыйОрдер КАК ТаблицаШапки
|ГДЕ
|	ТаблицаШапки.Дата >= НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
|	И (ТаблицаШапки.Дата <= КОНЕЦПЕРИОДА(&ОкончаниеПериода, ДЕНЬ) ИЛИ &ОкончаниеПериода = ДатаВремя(1,1,1))
|	И ( ТаблицаШапки.Партнер = &Параметр )
| ОБЪЕДИНИТЬ ВСЕ ВЫБРАТЬ
|	ТаблицаШапки.Ссылка              КАК Документ,
|	ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.СуммаДокумента )  КАК СуммаДокумента,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Валюта )  КАК Валюта,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Склад )  КАК Склад,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Организация )  КАК Организация,
|	ТаблицаШапки.Номер               КАК Номер,
|	ТаблицаШапки.Менеджер КАК Менеджер,
|	ТаблицаШапки.Дата                КАК Дата,
|	ТИПЗНАЧЕНИЯ(ТаблицаШапки.Ссылка) КАК ТипДокумента,
|	ВЫБОР
|		КОГДА ТаблицаШапки.Проведен ТОГДА
|			0
|		КОГДА ТаблицаШапки.ПометкаУдаления ТОГДА
|			1
|		ИНАЧЕ 2
|	КОНЕЦ                        КАК ИдентификаторКартинки
|ИЗ
|	Документ.РеализацияТоваровУслуг КАК ТаблицаШапки
|ГДЕ
|	ТаблицаШапки.Дата >= НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
|	И (ТаблицаШапки.Дата <= КОНЕЦПЕРИОДА(&ОкончаниеПериода, ДЕНЬ) ИЛИ &ОкончаниеПериода = ДатаВремя(1,1,1))
|	И ( ТаблицаШапки.Партнер = &Параметр )
| ОБЪЕДИНИТЬ ВСЕ ВЫБРАТЬ
|	ТаблицаШапки.Ссылка              КАК Документ,
|	 NULL  КАК СуммаДокумента,
| NULL  КАК Валюта,
| NULL  КАК Склад,
| NULL  КАК Организация,
|	ТаблицаШапки.Номер               КАК Номер,
|	ТаблицаШапки.Ответственный КАК Менеджер,
|	ТаблицаШапки.Дата                КАК Дата,
|	ТИПЗНАЧЕНИЯ(ТаблицаШапки.Ссылка) КАК ТипДокумента,
|	ВЫБОР
|		КОГДА ТаблицаШапки.Проведен ТОГДА
|			0
|		КОГДА ТаблицаШапки.ПометкаУдаления ТОГДА
|			1
|		ИНАЧЕ 2
|	КОНЕЦ                        КАК ИдентификаторКартинки
|ИЗ
|	Документ.РегистрацияЦенНоменклатурыПоставщика КАК ТаблицаШапки
|ГДЕ
|	ТаблицаШапки.Дата >= НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
|	И (ТаблицаШапки.Дата <= КОНЕЦПЕРИОДА(&ОкончаниеПериода, ДЕНЬ) ИЛИ &ОкончаниеПериода = ДатаВремя(1,1,1))
|	И ( ТаблицаШапки.Партнер = &Параметр )
| ОБЪЕДИНИТЬ ВСЕ ВЫБРАТЬ
|	ТаблицаШапки.Ссылка              КАК Документ,
|	ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.СуммаДокумента )  КАК СуммаДокумента,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Валюта )  КАК Валюта,
| NULL  КАК Склад,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Организация )  КАК Организация,
|	ТаблицаШапки.Номер               КАК Номер,
|	NULL КАК Менеджер,
|	ТаблицаШапки.Дата                КАК Дата,
|	ТИПЗНАЧЕНИЯ(ТаблицаШапки.Ссылка) КАК ТипДокумента,
|	ВЫБОР
|		КОГДА ТаблицаШапки.Проведен ТОГДА
|			0
|		КОГДА ТаблицаШапки.ПометкаУдаления ТОГДА
|			1
|		ИНАЧЕ 2
|	КОНЕЦ                        КАК ИдентификаторКартинки
|ИЗ
|	Документ.СписаниеБезналичныхДенежныхСредств КАК ТаблицаШапки
|ГДЕ
|	ТаблицаШапки.Дата >= НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
|	И (ТаблицаШапки.Дата <= КОНЕЦПЕРИОДА(&ОкончаниеПериода, ДЕНЬ) ИЛИ &ОкончаниеПериода = ДатаВремя(1,1,1))
|	И ( ТаблицаШапки.Партнер = &Параметр )
| ОБЪЕДИНИТЬ ВСЕ ВЫБРАТЬ
|	ТаблицаШапки.Ссылка              КАК Документ,
|	 NULL  КАК СуммаДокумента,
| NULL  КАК Валюта,
| NULL  КАК Склад,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Организация )  КАК Организация,
|	ТаблицаШапки.Номер               КАК Номер,
|	NULL КАК Менеджер,
|	ТаблицаШапки.Дата                КАК Дата,
|	ТИПЗНАЧЕНИЯ(ТаблицаШапки.Ссылка) КАК ТипДокумента,
|	ВЫБОР
|		КОГДА ТаблицаШапки.Проведен ТОГДА
|			0
|		КОГДА ТаблицаШапки.ПометкаУдаления ТОГДА
|			1
|		ИНАЧЕ 2
|	КОНЕЦ                        КАК ИдентификаторКартинки
|ИЗ
|	Документ.СписаниеЗадолженности КАК ТаблицаШапки
|ГДЕ
|	ТаблицаШапки.Дата >= НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
|	И (ТаблицаШапки.Дата <= КОНЕЦПЕРИОДА(&ОкончаниеПериода, ДЕНЬ) ИЛИ &ОкончаниеПериода = ДатаВремя(1,1,1))
|	И ( 1 В
|	(ВЫБРАТЬ ПЕРВЫЕ 1
|			1
|	ИЗ
|		Документ.СписаниеЗадолженности.Задолженность КАК ТаблицаСтрок
|	ГДЕ
|		ТаблицаСтрок.Ссылка = ТаблицаШапки.Ссылка
|		И (  ТаблицаСтрок.Партнер = &Параметр  )
|	))
| ОБЪЕДИНИТЬ ВСЕ ВЫБРАТЬ
|	ТаблицаШапки.Ссылка              КАК Документ,
|	 NULL  КАК СуммаДокумента,
| NULL  КАК Валюта,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Склад )  КАК Склад,
| NULL  КАК Организация,
|	ТаблицаШапки.Номер               КАК Номер,
|	ТаблицаШапки.Ответственный КАК Менеджер,
|	ТаблицаШапки.Дата                КАК Дата,
|	ТИПЗНАЧЕНИЯ(ТаблицаШапки.Ссылка) КАК ТипДокумента,
|	ВЫБОР
|		КОГДА ТаблицаШапки.Проведен ТОГДА
|			0
|		КОГДА ТаблицаШапки.ПометкаУдаления ТОГДА
|			1
|		ИНАЧЕ 2
|	КОНЕЦ                        КАК ИдентификаторКартинки
|ИЗ
|	Документ.РасходныйОрдерНаТовары КАК ТаблицаШапки
|ГДЕ
|	ТаблицаШапки.Дата >= НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
|	И (ТаблицаШапки.Дата <= КОНЕЦПЕРИОДА(&ОкончаниеПериода, ДЕНЬ) ИЛИ &ОкончаниеПериода = ДатаВремя(1,1,1))
|	И ( ВЫРАЗИТЬ(ТаблицаШапки.Распоряжение КАК Документ.ВозвратТоваровПоставщику).Партнер = &Параметр  ИЛИ  ВЫРАЗИТЬ(ТаблицаШапки.Распоряжение КАК Документ.РеализацияТоваровУслуг).Партнер = &Параметр )
| ОБЪЕДИНИТЬ ВСЕ ВЫБРАТЬ
|	ТаблицаШапки.Ссылка              КАК Документ,
|	 NULL  КАК СуммаДокумента,
| NULL  КАК Валюта,
|ПРЕДСТАВЛЕНИЕССЫЛКИ(ТаблицаШапки.Склад )  КАК Склад,
|NULL  КАК Организация,
|	ТаблицаШапки.Номер               КАК Номер,
|	ТаблицаШапки.Ответственный КАК Менеджер,
|	ТаблицаШапки.Дата                КАК Дата,
|	ТИПЗНАЧЕНИЯ(ТаблицаШапки.Ссылка) КАК ТипДокумента,
|	ВЫБОР
|		КОГДА ТаблицаШапки.Проведен ТОГДА
|			0
|		КОГДА ТаблицаШапки.ПометкаУдаления ТОГДА
|			1
|		ИНАЧЕ 2
|	КОНЕЦ                        КАК ИдентификаторКартинки
|ИЗ
|	Документ.ПриходныйОрдерНаТовары КАК ТаблицаШапки
|ГДЕ
|	ТаблицаШапки.Дата >= НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
|	И (ТаблицаШапки.Дата <= КОНЕЦПЕРИОДА(&ОкончаниеПериода, ДЕНЬ) ИЛИ &ОкончаниеПериода = ДатаВремя(1,1,1))
|	И ( ВЫРАЗИТЬ(ТаблицаШапки.Распоряжение КАК Документ.ВозвратТоваровОтКлиента).Партнер = &Параметр  ИЛИ  ВЫРАЗИТЬ(ТаблицаШапки.Распоряжение КАК Документ.ЗаказПоставщику).Партнер = &Параметр  ИЛИ  ВЫРАЗИТЬ(ТаблицаШапки.Распоряжение КАК Документ.ЗаявкаНаВозвратТоваровОтКлиента).Партнер = &Параметр  ИЛИ  ВЫРАЗИТЬ(ТаблицаШапки.Распоряжение КАК Документ.ПоступлениеТоваровУслуг).Партнер = &Параметр )
|УПОРЯДОЧИТЬ ПО
|	Дата,
|	Документ";

	Запрос.УстановитьПараметр("Параметр", Партнер);
	Запрос.УстановитьПараметр("НачалоПериода", ПериодВыборкиДокументов.ДатаНачала);
	Запрос.УстановитьПараметр("ОкончаниеПериода", ПериодВыборкиДокументов.ДатаОкончания);
	
	Запрос.Текст = ТекстЗапроса;

	ЗначениеВРеквизитФормы(Запрос.Выполнить().Выгрузить(), "ТаблицаДокументов");
	
КонецПроцедуры

&НаКлиенте
Процедура ПериодВыборкиДокументовПриИзменении(Элемент)
	
	ДокументыПоТекущемуПользователю();
	
КонецПроцедуры

&НаКлиенте
Процедура ПартнерПриИзменении(Элемент)
	
	ДокументыПоТекущемуПользователю();
	
КонецПроцедуры

&НаКлиенте
Процедура ПериодВыборкиДокументовОчистка(Элемент, СтандартнаяОбработка)
	
	СтандартнаяОбработка = Ложь;
	
КонецПроцедуры

&НаКлиенте
Процедура ПартнерОчистка(Элемент, СтандартнаяОбработка)
	
	СтандартнаяОбработка = Ложь;
	
КонецПроцедуры

&НаКлиенте
Процедура Сформировать(Команда)
	
	ДокументыПоТекущемуПользователю();
	
КонецПроцедуры

&НаКлиенте
Процедура ТаблицаДокументовВыбор(Элемент, ВыбраннаяСтрока, Поле, СтандартнаяОбработка)
	
	ОткрытьЗначение(Элемент.ТекущиеДанные.Документ);
	
КонецПроцедуры

&НаСервере
Функция СфомироватьСписокДокументовПоНоменклатуре()
				
	Запрос = Новый Запрос;
	ТекстЗапроса = "
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ДокументРеализации.Ссылка КАК Документ
	|ИЗ
	|	Документ.РеализацияТоваровУслуг КАК ДокументРеализации
	|
	|ЛЕВОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг.Товары КАК ДокументРеализацииТовары
	|ПО
	|	ДокументРеализацииТовары.Ссылка = ДокументРеализации.Ссылка
	|
	|ГДЕ
	|	ВЫБОР
	|		КОГДА &Менеджер = ЗНАЧЕНИЕ(Справочник.Пользователи.ПустаяСсылка)
	|		ТОГДА ИСТИНА
	|		ИНАЧЕ ДокументРеализации.Менеджер = &Менеджер
	|	КОНЕЦ
	|И
	|	ВЫБОР
	|		КОГДА &Номенклатура = ЗНАЧЕНИЕ(Справочник.Номенклатура.ПустаяСсылка)
	|		ТОГДА ИСТИНА
	|		ИНАЧЕ ДокументРеализацииТовары.Номенклатура = &Номенклатура
	|	КОНЕЦ";
	
	Запрос.УстановитьПараметр("Менеджер", Менеджер);
	Запрос.УстановитьПараметр("Номенклатура", Номенклатура);
	Запрос.Текст = ТекстЗапроса;
	
	РезультатЗапроса = Запрос.Выполнить();
	МассивДокументов = РезультатЗапроса.Выгрузить().ВыгрузитьКолонку("Документ");
	
	Возврат МассивДокументов;
	
КонецФункции

&НаКлиенте
Процедура НоменклатураПриИзменении(Элемент)
	
	МассивДокументов = СфомироватьСписокДокументовПоНоменклатуре();
	
	ОтборыСписковКлиентСервер.ИзменитьЭлементОтбораСписка(
		СписокДокументов,
		"Ссылка",
		МассивДокументов,
		Истина, ВидСравненияКомпоновкиДанных.ВСписке
	);
	
КонецПроцедуры
