
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	НаименованиеЗакладки = Параметры.НаименованиеЗакладки;
	Номенклатура = Параметры.Номенклатура;
	
КонецПроцедуры

&НаКлиенте
Процедура Добавить(Команда)
	
	Если ПустаяСтрока(НаименованиеЗакладки) Тогда
	
		Сообщение = Новый СообщениеПользователю;
		Сообщение.Текст = "Наименование не может быть пустым!";
		Сообщение.Поле = "НаименованиеЗакладки";
		Сообщение.Сообщить(); 
		
		Возврат;
	                                              
	КонецЕсли; 
	
	МассивЗакладок = КлючУникальности.МассивЗакладок;
	НоваяЗакладка = Новый Структура;
	НоваяЗакладка.Вставить("Наименование", НаименованиеЗакладки);
	НоваяЗакладка.Вставить("НаименованиеНоменклатуры", Номенклатура);
	
	Для каждого Закладка Из МассивЗакладок Цикл
	
		Если Закладка.Наименование = НаименованиеЗакладки Тогда
	
			Сообщение = Новый СообщениеПользователю;
			Сообщение.Текст = "Наименование должно быть уникальным!";
			Сообщение.Поле = "НаименованиеЗакладки";
			Сообщение.Сообщить(); 
			
			Возврат;
		
		КонецЕсли;
	
	КонецЦикла;  
	
	Закрыть(НоваяЗакладка);
	
КонецПроцедуры
