{2,
{36,0,0,0,0,1,0,0,00000000-0000-0000-0000-000000000000,1,
{1,0},0,0,1,1,1,0,0,19,5,
{"#",11cfd3e0-86f8-4480-aaa5-dc6a6ccac689,
{1,
{3},""}
},6,
{"#",11cfd3e0-86f8-4480-aaa5-dc6a6ccac689,
{1,
{4},""}
},7,
{"#",acbc2eeb-2efb-48e4-b78a-661fd09fcf80,0},8,
{"S","urn:form:ext:14:ff885b26-852d-41f7-b523-ac009a3392ff@v='a5dc5250-cfa3-4a08-ac99-f9541cb87b53'"},9,
{"S","urn:form:ext:13:ff885b26-852d-41f7-b523-ac009a3392ff@v='a5dc5250-cfa3-4a08-ac99-f9541cb87b53'"},10,
{"S","urn:form:ext:16:ff885b26-852d-41f7-b523-ac009a3392ff@v='a5dc5250-cfa3-4a08-ac99-f9541cb87b53'"},11,
{"S","urn:form:ext:15:ff885b26-852d-41f7-b523-ac009a3392ff@v='a5dc5250-cfa3-4a08-ac99-f9541cb87b53'"},12,
{"S","ВнешнийОтчет.ВнешнийОтчет1"},13,
{"S","Основной"},14,
{"B",0},15,
{"U"},16,
{"B",0},17,
{"#",4772b3b4-f4a3-49c0-a1a5-8cb5961511a3,
{6,1e512aab-1b41-4ef6-9375-f0137be9dd91,0,0,
{1,
{1e512aab-1b41-4ef6-9375-f0137be9dd91,
{"Основной",0,
{"S","Основной"},
{3,0,
{0},"",-1,-1,0,0},0,0,""}
}
},
{"Pattern"},0,0}
},18,
{"S","Основной"},19,
{"S",""},20,
{"#",11cfd3e0-86f8-4480-aaa5-dc6a6ccac689,
{1,
{2},""}
},21,
{"#",f26c3706-a6ca-45cb-869a-e6ad38cd5f78,0},22,
{"S","00000000-0000-0000-0000-000000000000"},23,
{"N",0},
{1,3ccc650e-f631-4cae-8e33-3eaac610b5f9,"ПриОткрытии"},
{0},1,
{19,
{-1,02023637-7868-4a5f-8576-835a76e0c9ba},0,0,1,
{0,
{0,
{"B",1},0}
},9,"ФормаКоманднаяПанель",
{1,0},
{1,0},0,1,0,0,0,2,2,
{3,4,
{0}
},
{7,3,0,1,100},
{0,0,0},1,
{0,0,0},0,1,0,0},3,cd5394d0-7dda-4b56-8927-93ccbe967a01,
{19,
{17,02023637-7868-4a5f-8576-835a76e0c9ba},0,0,1,
{0,
{0,
{"B",1},0}
},5,"ГруппаПериода",
{1,1,
{"ru","Группа периода"}
},
{1,1,
{"ru","Группа периода"}
},0,1,0,0,0,2,2,
{3,4,
{0}
},
{7,3,0,1,100},
{0,0,0},1,
{17,1,0,0,0,
{0},
{1,0},
{"Pattern"},"",
{3,4,
{0}
},0,0,0,1,
{1,0}
},3,a9f3b1ac-f51b-431e-b102-55a69acdecad,
{22,
{18,02023637-7868-4a5f-8576-835a76e0c9ba},0,1,
{0,
{0,
{"B",1},0}
},1,"ФормаСформировать",
{1,0},1,
{1,409b9a53-7f7e-4178-86c1-33176c7c7a7a},
{0},3,0,0,0,2,2,0,0,0,
{3,4,
{0}
},
{3,4,
{0}
},
{3,4,
{0}
},
{7,3,0,1,100},
{0,0,0},0,
{3,0,
{0},"",-1,-1,1,0},1,
{"Pattern"},"",2,0,1,
{8,
{22,02023637-7868-4a5f-8576-835a76e0c9ba},0,0,1,
{0,
{0,
{"B",1},0}
},0,"ФормаСформироватьExtendedTooltip",
{1,0},
{1,0},1,0,0,2,2,
{3,4,
{0}
},
{7,3,0,1,100},
{0,0,0},1,
{5,0,0,3,0,
{0},
{3,4,
{0}
},
{3,4,
{0}
},
{3,0,
{0},0,1,0,48312c09-257f-4b29-b280-284dd89efc1e}
},0,1,2,
{1,
{1,0},0},0,0},
{"U"}
},77ffcc29-7f2d-4223-b22f-19666e7250ba,
{32,
{15,02023637-7868-4a5f-8576-835a76e0c9ba},0,0,1,
{0,
{0,
{"B",1},0}
},2,"ВидПериода",1,0,
{1,1,
{"ru","Вывод"}
},
{1,0},
{1,
{7}
},
{0},1,0,2,0,2,
{1,0},
{1,0},1,1,0,3,0,3,1,3,0,
{3,0,
{0},"",-1,-1,1,0},
{3,0,
{0},"",-1,-1,1,0},
{3,4,
{0}
},
{7,3,0,1,100},
{3,4,
{0}
},
{3,4,
{0}
},
{3,4,
{0}
},
{7,3,0,1,100},
{0,0,0},1,
{30,
{1,2,"",
{"#",0e704aa2-07bd-48b9-8223-a0212c4d5fc2,
{0,0,
{"U"},6a00a492-3e0f-4533-a8f1-00a8d8ba1b69,35f62549-eb6a-4284-a6e3-406b0d9df0cf,
{1,1,
{"ru","По неделях"}
}
}
},"",
{"#",0e704aa2-07bd-48b9-8223-a0212c4d5fc2,
{0,0,
{"U"},6a00a492-3e0f-4533-a8f1-00a8d8ba1b69,fd66995b-ee76-41d3-983f-33d84bdcbbd4,
{1,1,
{"ru","По месяцах"}
}
}
}
},0,0,2,2,1,2,2,2,2,2,2,2,2,2,
{"U"},
{"U"},"",1,
{3,0,
{0},"",-1,-1,1,0},0,0,2,3,00000000-0000-0000-0000-000000000000,
{5004,0},
{0,0},2,
{1,0},
{1,0},2,1,0,
{"Pattern"},1,
{0},
{3,4,
{0}
},
{3,4,
{0}
},
{3,4,
{0}
},
{7,3,0,1,100},1,
{3,0,0},0,
{1,0},2,0,2,0},
{0},1,
{19,
{16,02023637-7868-4a5f-8576-835a76e0c9ba},0,0,1,
{0,
{0,
{"B",1},0}
},8,"ВидПериодаКонтекстноеМеню",
{1,0},
{1,0},0,1,0,0,0,2,2,
{3,4,
{0}
},
{7,3,0,1,100},
{0,0,0},1,
{1,1},0,1,0,0},1,
{"Pattern"},
{"Pattern"},"","",
{0},0,0,1,
{8,
{25,02023637-7868-4a5f-8576-835a76e0c9ba},0,0,1,
{0,
{0,
{"B",1},0}
},0,"ВидПериодаExtendedTooltip",
{1,0},
{1,0},1,0,0,2,2,
{3,4,
{0}
},
{7,3,0,1,100},
{0,0,0},1,
{5,0,0,3,0,
{0},
{3,4,
{0}
},
{3,4,
{0}
},
{3,0,
{0},0,1,0,48312c09-257f-4b29-b280-284dd89efc1e}
},0,1,2,
{1,
{1,0},0},0,0}
},77ffcc29-7f2d-4223-b22f-19666e7250ba,
{32,
{28,02023637-7868-4a5f-8576-835a76e0c9ba},0,0,1,
{0,
{0,
{"B",1},0}
},2,"Период",1,0,
{1,0},
{1,0},
{1,
{10}
},
{0},1,0,2,0,2,
{1,0},
{1,0},1,1,0,3,0,3,1,3,0,
{3,0,
{0},"",-1,-1,1,0},
{3,0,
{0},"",-1,-1,1,0},
{3,4,
{0}
},
{7,3,0,1,100},
{3,4,
{0}
},
{3,4,
{0}
},
{3,4,
{0}
},
{7,3,0,1,100},
{0,0,0},1,
{30,
{1,0},0,0,2,2,1,2,2,2,2,2,2,2,2,2,
{"U"},
{"U"},"",0,
{3,0,
{0},"",-1,-1,1,0},0,0,2,3,00000000-0000-0000-0000-000000000000,
{5004,0},
{0,0},2,
{1,0},
{1,0},2,1,0,
{"Pattern"},1,
{0},
{3,4,
{0}
},
{3,4,
{0}
},
{3,4,
{0}
},
{7,3,0,1,100},1,
{3,0,0},0,
{1,0},2,0,2,0},
{1,fe115cc8-9e33-4684-a166-bd5136fe7a9f,"ПериодПриИзменении"},1,
{19,
{29,02023637-7868-4a5f-8576-835a76e0c9ba},0,0,1,
{0,
{0,
{"B",1},0}
},8,"ПериодКонтекстноеМеню",
{1,0},
{1,0},0,1,0,0,0,2,2,
{3,4,
{0}
},
{7,3,0,1,100},
{0,0,0},1,
{1,1},0,1,0,0},1,
{"Pattern"},
{"Pattern"},"","",
{0},0,0,1,
{8,
{30,02023637-7868-4a5f-8576-835a76e0c9ba},0,0,1,
{0,
{0,
{"B",1},0}
},0,"ПериодРасширеннаяПодсказка",
{1,0},
{1,0},1,0,0,2,2,
{3,4,
{0}
},
{7,3,0,1,100},
{0,0,0},1,
{5,0,0,3,0,
{0},
{3,4,
{0}
},
{3,4,
{0}
},
{3,0,
{0},0,1,0,48312c09-257f-4b29-b280-284dd89efc1e}
},0,1,2,
{1,
{1,0},0},0,0}
},1,0,1,
{8,
{21,02023637-7868-4a5f-8576-835a76e0c9ba},0,0,1,
{0,
{0,
{"B",1},0}
},0,"ГруппаПериодаExtendedTooltip",
{1,0},
{1,0},1,0,0,2,2,
{3,4,
{0}
},
{7,3,0,1,100},
{0,0,0},1,
{5,0,0,3,0,
{0},
{3,4,
{0}
},
{3,4,
{0}
},
{3,0,
{0},0,1,0,48312c09-257f-4b29-b280-284dd89efc1e}
},0,1,2,
{1,
{1,0},0},0,0}
},cd5394d0-7dda-4b56-8927-93ccbe967a01,
{19,
{5,02023637-7868-4a5f-8576-835a76e0c9ba},0,0,1,
{0,
{0,
{"B",1},0}
},0,"ОсновнаяКоманднаяПанель",
{1,1,
{"ru","Основная командная панель"}
},
{1,0},0,1,0,0,0,2,2,
{3,4,
{0}
},
{7,3,0,1,100},
{0,0,0},1,
{1,0,
{0,02023637-7868-4a5f-8576-835a76e0c9ba}
},0,0,0,1,
{8,
{26,02023637-7868-4a5f-8576-835a76e0c9ba},0,0,1,
{0,
{0,
{"B",1},0}
},0,"ОсновнаяКоманднаяПанельExtendedTooltip",
{1,0},
{1,0},1,0,0,2,2,
{3,4,
{0}
},
{7,3,0,1,100},
{0,0,0},1,
{5,0,0,3,0,
{0},
{3,4,
{0}
},
{3,4,
{0}
},
{3,0,
{0},0,1,0,48312c09-257f-4b29-b280-284dd89efc1e}
},0,1,2,
{1,
{1,0},0},0,0}
},77ffcc29-7f2d-4223-b22f-19666e7250ba,
{32,
{19,02023637-7868-4a5f-8576-835a76e0c9ba},0,0,1,
{0,
{0,
{"B",1},0}
},6,"ДокументРезультат",0,0,
{1,0},
{1,0},
{1,
{8}
},
{0},1,0,2,0,2,
{1,0},
{1,0},1,1,0,3,0,3,1,3,0,
{3,0,
{0},"",-1,-1,1,0},
{3,0,
{0},"",-1,-1,1,0},
{3,4,
{0}
},
{7,3,0,1,100},
{3,4,
{0}
},
{3,4,
{0}
},
{3,4,
{0}
},
{7,3,0,1,100},
{0,0,0},1,
{8,50,10,1,1,0,0,1,1,0,0,1,0,0,1,
{3,4,
{0}
},1,1,
{0},0},
{0},1,
{19,
{20,02023637-7868-4a5f-8576-835a76e0c9ba},0,0,1,
{0,
{0,
{"B",1},0}
},8,"ДокументРезультатКонтекстноеМеню",
{1,0},
{1,0},0,1,0,0,0,2,2,
{3,4,
{0}
},
{7,3,0,1,100},
{0,0,0},1,
{1,1},0,1,0,0},1,
{"Pattern"},
{"Pattern"},"","",
{0},0,0,1,
{8,
{27,02023637-7868-4a5f-8576-835a76e0c9ba},0,0,1,
{0,
{0,
{"B",1},0}
},0,"ДокументРезультатExtendedTooltip",
{1,0},
{1,0},1,0,0,2,2,
{3,4,
{0}
},
{7,3,0,1,100},
{0,0,0},1,
{5,0,0,3,0,
{0},
{3,4,
{0}
},
{3,4,
{0}
},
{3,0,
{0},0,1,0,48312c09-257f-4b29-b280-284dd89efc1e}
},0,1,2,
{1,
{1,0},0},0,0}
},"","",1,
{19,
{0},0,0,0,7,"Navigator",
{1,0},
{1,0},0,1,0,0,0,2,2,
{3,4,
{0}
},
{7,3,0,1,100},
{0,0,0},0,0,1,0,1,
{8,
{0},0,0,0,0,"NavigatorExtendedTooltip",
{1,0},
{1,0},1,0,0,2,2,
{3,4,
{0}
},
{7,3,0,1,100},
{0,0,0},1,
{5,0,0,3,0,
{0},
{3,4,
{0}
},
{3,4,
{0}
},
{3,0,
{0},0,1,0,48312c09-257f-4b29-b280-284dd89efc1e}
},0,1,2,
{1,
{1,0},0},0,0}
},1,"",2,0},"////////////////////////////////////////////////////////////////////////////////
// ПРОГРАММНЫЙ ИНТЕРФЕЙС


////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ ФОРМЫ

&НаКлиенте
Процедура ПриОткрытии(Отказ)
	ВидПериода				= ПолучитьВидПериода();
	Период.Вариант 			= ВариантСтандартногоПериода.ПроизвольныйПериод;
	Период.ДатаНачала		= НачалоНедели(ТекущаяДата() - 24*60*60*28);
	Период.ДатаОкончания	= КонецДня(ТекущаяДата());
	
	ДатаНачала 				= Период.ДатаНачала;
	ДатаОкончания 			= КонецДня(Период.ДатаОкончания);
	
КонецПроцедуры


////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ ЭЛЕМЕНТОВ ШАПКИ ФОРМЫ

&НаКлиенте
Процедура ПериодПриИзменении(Элемент)
	ДатаНачала = Период.ДатаНачала;
	ДатаОкончания = КонецДня(Период.ДатаОкончания);
КонецПроцедуры


////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ КОМАНД ФОРМЫ

&НаКлиенте
Процедура Сформировать(Команда)
	СформироватьНаСервере();
КонецПроцедуры



////////////////////////////////////////////////////////////////////////////////
// СЛУЖЕБНЫЕ ПРОЦЕДУРЫ И ФУНКЦИИ

&НаСервере
Процедура СформироватьНаСервере()
	УстановитьПривилегированныйРежим(Истина);
	Календарь = Справочники.Календари.ПолучитьСсылку(Новый УникальныйИдентификатор(""a56702cc-3ffc-11e0-9f98-001517115d85""));
	
 	Запрос = Новый Запрос(ПолучитьТекстЗапроса());
	Запрос.УстановитьПараметр(""НачалоПериода""				, ДатаНачала);
	Запрос.УстановитьПараметр(""КонецПериода""				, КонецДня(ДатаОкончания));
	Запрос.УстановитьПараметр(""ГраницаНачалоПериода""		, Новый Граница(ДатаНачала					,ВидГраницы.Включая));
	Запрос.УстановитьПараметр(""ГраницаКонецПериода""			, Новый Граница(КонецДня(ДатаОкончания)		,ВидГраницы.Включая));
    Запрос.УстановитьПараметр(""ВалютаУправленческогоУчета""	, Константы.ВалютаУправленческогоУчета.Получить());
	Запрос.УстановитьПараметр(""ВидПериода""					, ВидПериода);
	Запрос.УстановитьПараметр(""Календарь""					, Календарь);

	РезультатЗапроса = Запрос.Выполнить().Выгрузить();
	
	СхемаКомпоновкиДанных = РеквизитФормыВЗначение(""Отчет"").ПолучитьМакет(""Макет"");
	Настройки =  РеквизитФормыВЗначение(""Отчет"").ПолучитьМакет(""Макет"").НастройкиПоУмолчанию;

	Параметр = Настройки.ПараметрыДанных.НайтиЗначениеПараметра(Новый ПараметрКомпоновкиДанных(""Параметр""));
	   
	Параметр.Использование = Истина;
	Параметр.Значение = КонецДня(ДатаОкончания)+2;
	
	
	
	ДанныеРасшифровки = Неопределено;
	
	
	КомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных;
	МакетКомпоновки = КомпоновщикМакета.Выполнить(СхемаКомпоновкиДанных, Настройки , ДанныеРасшифровки);
	
	ДокументРезультат.Очистить();

	ПроцессорКомпоновки = Новый ПроцессорКомпоновкиДанных;
	ПроцессорКомпоновки.Инициализировать(МакетКомпоновки, Новый Структура(""Данные"", РезультатЗапроса));
	
	ПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВТабличныйДокумент;
	ПроцессорВывода.УстановитьДокумент(ДокументРезультат);   
	
	ПроцессорВывода.НачатьВывод();
	
	ЭлементРезультата = ПроцессорКомпоновки.Следующий();
	Пока ЭлементРезультата <> Неопределено Цикл
		ПроцессорВывода.ВывестиЭлемент(ЭлементРезультата);
		ЭлементРезультата = ПроцессорКомпоновки.Следующий();
	КонецЦикла;
	
	ПроцессорВывода.ЗакончитьВывод();
	
КонецПроцедуры


&НаСервере
Функция ПолучитьТекстЗапроса()   
	ТекстЗапроса =
		///////////////////////////////////////////////////////////////////////////////////
		//1. Находим розничные организации
		""ВЫБРАТЬ
		|	Лояльность_Настройки.Организация КАК Организация
		|ПОМЕСТИТЬ КешОрганизацииРозница
		|ИЗ
		|	РегистрСведений.Лояльность_Настройки КАК Лояльность_Настройки
		|ГДЕ
		|	НЕ Лояльность_Настройки.Организация.ПометкаУдаления
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Организация
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	Организации.Ссылка КАК Организация
		|ПОМЕСТИТЬ КешОрганизацииОпт
		|ИЗ
		|	Справочник.Организации КАК Организации
		|ГДЕ
		|	НЕ Организации.ПометкаУдаления
		|	И НЕ Организации.Ссылка В
		|				(ВЫБРАТЬ
		|					КешОрганизацииРозница.Организация
		|				ИЗ
		|					КешОрганизацииРозница)
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Организация
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ВЫРАЗИТЬ(КурсыВалют.Курс / КурсыВалют.Кратность КАК ЧИСЛО(15, 4)) КАК Курс,
		|	КурсыВалют.Валюта КАК Валюта,
		|	КурсыВалют.Период КАК Период
		|ПОМЕСТИТЬ КурсыВалют
		|ИЗ
		|	РегистрСведений.КурсыВалют КАК КурсыВалют
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Валюта,
		|	Период
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	КурсыВалют.Курс КАК Курс,
		|	КурсыВалют.Валюта КАК Валюта,
		|	КурсыВалют.Период КАК НачалоПериода,
		|	МИНИМУМ(ЕСТЬNULL(КурсыВалютКопия.Период, ДАТАВРЕМЯ(3999, 1, 1))) КАК КонецПериода
		|ПОМЕСТИТЬ ТаблицаКурсов
		|ИЗ
		|	КурсыВалют КАК КурсыВалют
		|		ЛЕВОЕ СОЕДИНЕНИЕ КурсыВалют КАК КурсыВалютКопия
		|		ПО (КурсыВалютКопия.Период > КурсыВалют.Период)
		|			И (КурсыВалютКопия.Валюта = КурсыВалют.Валюта)
		|
		|СГРУППИРОВАТЬ ПО
		|	КурсыВалют.Период,
		|	КурсыВалют.Курс,
		|	КурсыВалют.Валюта
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Валюта,
		|	НачалоПериода,
		|	КонецПериода
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ВЫБОР
		|		КОГДА &ВидПериода = ЗНАЧЕНИЕ(Перечисление.ДоступныеПериодыОтчета.Неделя)
		|			ТОГДА КОНЕЦПЕРИОДА(КалендарныеГрафики.ДатаГрафика, НЕДЕЛЯ)
		|		ИНАЧЕ КОНЕЦПЕРИОДА(КалендарныеГрафики.ДатаГрафика, МЕСЯЦ)
		|	КОНЕЦ КАК Дата
		|ПОМЕСТИТЬ КешКалендаря
		|ИЗ
		|	РегистрСведений.КалендарныеГрафики КАК КалендарныеГрафики
		|ГДЕ
		|	КалендарныеГрафики.Календарь = &Календарь
		|	И КалендарныеГрафики.ДатаГрафика > &НачалоПериода
		|	И ВЫБОР
		|			КОГДА &ВидПериода = ЗНАЧЕНИЕ(Перечисление.ДоступныеПериодыОтчета.Неделя)
		|				ТОГДА КОНЕЦПЕРИОДА(КалендарныеГрафики.ДатаГрафика, НЕДЕЛЯ)
		|			ИНАЧЕ КОНЕЦПЕРИОДА(КалендарныеГрафики.ДатаГрафика, МЕСЯЦ)
		|		КОНЕЦ < &КонецПериода
		|
		|ОБЪЕДИНИТЬ
		|
		|ВЫБРАТЬ
		|	НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ)
		|
		|ОБЪЕДИНИТЬ
		|
		|ВЫБРАТЬ
		|	КОНЕЦПЕРИОДА(&КонецПериода, ДЕНЬ)
		|
		|ОБЪЕДИНИТЬ
		|
		|ВЫБРАТЬ
		|	КОНЕЦПЕРИОДА(&НачалоПериода, ДЕНЬ)
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Дата
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	Календарь.Дата КАК НачалоПериода,
		|	МИНИМУМ(КалендарьКопия.Дата) КАК КонецПериода
		|ПОМЕСТИТЬ НаростающийКалендарь
		|ИЗ
		|	КешКалендаря КАК Календарь
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ КешКалендаря КАК КалендарьКопия
		|		ПО (КалендарьКопия.Дата > Календарь.Дата)
		|
		|СГРУППИРОВАТЬ ПО
		|	Календарь.Дата
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	НачалоПериода,
		|	КонецПериода
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ВыручкаИСебестоимостьПродажОбороты.Период КАК Период,
		|	ВыручкаИСебестоимостьПродажОбороты.СуммаВыручкиОборот КАК Сумма
		|ПОМЕСТИТЬ ОборотыВыручка
		|ИЗ
		|	РегистрНакопления.ВыручкаИСебестоимостьПродаж.Обороты(&ГраницаНачалоПериода, &ГраницаКонецПериода, День, АналитикаУчетаПоПартнерам.Партнер <> ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)) КАК ВыручкаИСебестоимостьПродажОбороты
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Период
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	КОНЕЦПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ) КАК НачалоПериода,
		|	Пересечения.КонецПериода КАК Дата,
		|	СУММА(ЕСТЬNULL(ОборотыВыручка.Сумма, 0)) КАК Сумма
		|ПОМЕСТИТЬ ОборотыВыручкаНаростающие
		|ИЗ
		|	НаростающийКалендарь КАК Пересечения
		|		ЛЕВОЕ СОЕДИНЕНИЕ ОборотыВыручка КАК ОборотыВыручка
		|		ПО (ВЫБОР
		|				КОГДА НАЧАЛОПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ) = &НачалоПериода
		|						И НАЧАЛОПЕРИОДА(Пересечения.КонецПериода, ДЕНЬ) <> &НачалоПериода
		|					ТОГДА Пересечения.КонецПериода > ОборотыВыручка.Период
		|							И НАЧАЛОПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ) <= ОборотыВыручка.Период
		|				КОГДА НАЧАЛОПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ) <> &НачалоПериода
		|					ТОГДА Пересечения.КонецПериода > ОборотыВыручка.Период
		|							И Пересечения.НачалоПериода <= ОборотыВыручка.Период
		|			КОНЕЦ)
		|
		|СГРУППИРОВАТЬ ПО
		|	Пересечения.КонецПериода,
		|	КОНЕЦПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ)
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Дата,
		|	Пересечения.КонецПериода
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	КешВыручки.Дата КАК Дата,
		|	ЕСТЬNULL(ОборотыВыручкаНаростающие.Дата, КешВыручки.Дата) КАК КонецПериода,
		|	ЕСТЬNULL(ОборотыВыручкаНаростающие.Сумма, 0) КАК Сумма
		|ПОМЕСТИТЬ КешВыручка
		|ИЗ
		|	ОборотыВыручкаНаростающие КАК КешВыручки
		|		ЛЕВОЕ СОЕДИНЕНИЕ ОборотыВыручкаНаростающие КАК КешВыручкиКопия
		|		ПО КешВыручки.Дата < КешВыручкиКопия.Дата
		|			И (ВЫБОР
		|				КОГДА &ВидПериода = ЗНАЧЕНИЕ(Перечисление.ДоступныеПериодыОтчета.Неделя)
		|					ТОГДА РАЗНОСТЬДАТ(КешВыручки.Дата, КешВыручкиКопия.Дата, ДЕНЬ) <= РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(КешВыручки.Дата, НЕДЕЛЯ), КОНЕЦПЕРИОДА(КешВыручки.Дата, НЕДЕЛЯ), ДЕНЬ) + 1
		|				ИНАЧЕ РАЗНОСТЬДАТ(КешВыручки.Дата, КешВыручкиКопия.Дата, ДЕНЬ) <= РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(КешВыручки.Дата, МЕСЯЦ), КОНЕЦПЕРИОДА(КешВыручки.Дата, МЕСЯЦ), ДЕНЬ) + 1
		|			КОНЕЦ)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ОборотыВыручкаНаростающие КАК ОборотыВыручкаНаростающие
		|		ПО КешВыручки.Дата = ОборотыВыручкаНаростающие.НачалоПериода
		|			И КешВыручки.Дата < ОборотыВыручкаНаростающие.Дата
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Дата,
		|	КонецПериода
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ВыручкаИСебестоимостьПродажОбороты.Период КАК Период,
		|	РегистрАналитикаУчетаПоПартнерам.Организация КАК Организация,
		|	СУММА(ВыручкаИСебестоимостьПродажОбороты.СуммаВыручкиОборот) КАК Сумма
		|ПОМЕСТИТЬ ОборотыВыручкаРозница
		|ИЗ
		|	РегистрНакопления.ВыручкаИСебестоимостьПродаж.Обороты(
		|			&ГраницаНачалоПериода,
		|			&ГраницаКонецПериода,
		|			День,
		|			АналитикаУчетаПоПартнерам.Организация В
		|					(ВЫБРАТЬ
		|						КешОрганизацииРозница.Организация
		|					ИЗ
		|						КешОрганизацииРозница)
		|				И АналитикаУчетаПоПартнерам.Партнер <> ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)) КАК ВыручкаИСебестоимостьПродажОбороты
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаПоПартнерам КАК РегистрАналитикаУчетаПоПартнерам
		|		ПО ВыручкаИСебестоимостьПродажОбороты.АналитикаУчетаПоПартнерам = РегистрАналитикаУчетаПоПартнерам.КлючАналитики
		|
		|СГРУППИРОВАТЬ ПО
		|	ВыручкаИСебестоимостьПродажОбороты.Период,
		|	ВыручкаИСебестоимостьПродажОбороты.АналитикаУчетаПоПартнерам.Организация,
		|	РегистрАналитикаУчетаПоПартнерам.Организация
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Период,
		|	Организация
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	КОНЕЦПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ) КАК Дата,
		|	Пересечения.КонецПериода КАК КонецПериода,
		|	СУММА(ЕСТЬNULL(ОборотыВыручкаРозница.Сумма, 0)) КАК Сумма,
		|	ОборотыВыручкаРозница.Организация КАК Организация
		|ПОМЕСТИТЬ ОборотыВыручкаРозницаНаростающие
		|ИЗ
		|	НаростающийКалендарь КАК Пересечения
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ОборотыВыручкаРозница КАК ОборотыВыручкаРозница
		|		ПО (ВЫБОР
		|				КОГДА НАЧАЛОПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ) = &НачалоПериода
		|						И НАЧАЛОПЕРИОДА(Пересечения.КонецПериода, ДЕНЬ) <> &НачалоПериода
		|					ТОГДА Пересечения.КонецПериода > ОборотыВыручкаРозница.Период
		|							И НАЧАЛОПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ) <= ОборотыВыручкаРозница.Период
		|				КОГДА НАЧАЛОПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ) <> &НачалоПериода
		|					ТОГДА Пересечения.КонецПериода > ОборотыВыручкаРозница.Период
		|							И Пересечения.НачалоПериода <= ОборотыВыручкаРозница.Период
		|			КОНЕЦ)
		|
		|СГРУППИРОВАТЬ ПО
		|	Пересечения.КонецПериода,
		|	КОНЕЦПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ),
		|	ОборотыВыручкаРозница.Организация
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Дата,
		|	Пересечения.КонецПериода,
		|	Организация
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ВыручкаИСебестоимостьПродажОбороты.Период КАК Период,
		|	РегистрАналитикаУчетаПоПартнерам.Организация КАК Организация,
		|	СУММА(ВыручкаИСебестоимостьПродажОбороты.СуммаВыручкиОборот) КАК Сумма
		|ПОМЕСТИТЬ ОборотыВыручкаОпт
		|ИЗ
		|	РегистрНакопления.ВыручкаИСебестоимостьПродаж.Обороты(
		|			&ГраницаНачалоПериода,
		|			&ГраницаКонецПериода,
		|			День,
		|			НЕ АналитикаУчетаПоПартнерам.Организация В
		|						(ВЫБРАТЬ
		|							КешОрганизацииРозница.Организация
		|						ИЗ
		|							КешОрганизацииРозница)
		|				И АналитикаУчетаПоПартнерам.Партнер <> ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)) КАК ВыручкаИСебестоимостьПродажОбороты
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаПоПартнерам КАК РегистрАналитикаУчетаПоПартнерам
		|		ПО ВыручкаИСебестоимостьПродажОбороты.АналитикаУчетаПоПартнерам = РегистрАналитикаУчетаПоПартнерам.КлючАналитики
		|
		|СГРУППИРОВАТЬ ПО
		|	ВыручкаИСебестоимостьПродажОбороты.Период,
		|	ВыручкаИСебестоимостьПродажОбороты.АналитикаУчетаПоПартнерам.Организация,
		|	РегистрАналитикаУчетаПоПартнерам.Организация
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Период,
		|	Организация
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	КОНЕЦПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ) КАК Дата,
		|	Пересечения.КонецПериода КАК КонецПериода,
		|	СУММА(ЕСТЬNULL(ОборотыВыручкаОпт.Сумма, 0)) КАК Сумма,
		|	ОборотыВыручкаОпт.Организация КАК Организация
		|ПОМЕСТИТЬ ОборотыВыручкаОптНаростающие
		|ИЗ
		|	НаростающийКалендарь КАК Пересечения
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ОборотыВыручкаОпт КАК ОборотыВыручкаОпт
		|		ПО (ВЫБОР
		|				КОГДА НАЧАЛОПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ) = &НачалоПериода
		|						И НАЧАЛОПЕРИОДА(Пересечения.КонецПериода, ДЕНЬ) <> &НачалоПериода
		|					ТОГДА Пересечения.КонецПериода > ОборотыВыручкаОпт.Период
		|							И НАЧАЛОПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ) <= ОборотыВыручкаОпт.Период
		|				КОГДА НАЧАЛОПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ) <> &НачалоПериода
		|					ТОГДА Пересечения.КонецПериода > ОборотыВыручкаОпт.Период
		|							И Пересечения.НачалоПериода <= ОборотыВыручкаОпт.Период
		|			КОНЕЦ)
		|
		|СГРУППИРОВАТЬ ПО
		|	Пересечения.КонецПериода,
		|	КОНЕЦПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ),
		|	ОборотыВыручкаОпт.Организация
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Дата,
		|	Пересечения.КонецПериода,
		|	Организация
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	НаростающийКалендарь.КонецПериода КАК Дата,
		|	КешОрганизацииОпт.Организация КАК Организация
		|ПОМЕСТИТЬ РозподелПоКалендарюОпт
		|ИЗ
		|	НаростающийКалендарь КАК НаростающийКалендарь,
		|	КешОрганизацииОпт КАК КешОрганизацииОпт
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Дата,
		|	Организация
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	НаростающийКалендарь.КонецПериода КАК Дата,
		|	КешОрганизацииРозница.Организация КАК Организация
		|ПОМЕСТИТЬ РозподелПоКалендарюРозница
		|ИЗ
		|	НаростающийКалендарь КАК НаростающийКалендарь,
		|	КешОрганизацииРозница КАК КешОрганизацииРозница
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Дата,
		|	Организация
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	КешОпт.Дата КАК Дата,
		|	КешОпт.Организация КАК Организация,
		|	ЕСТЬNULL(ОборотыВыручкаОптНаростающие.Сумма, 0) КАК Сумма
		|ПОМЕСТИТЬ КешВыручкаОпт
		|ИЗ
		|	РозподелПоКалендарюОпт КАК КешОпт
		|		ЛЕВОЕ СОЕДИНЕНИЕ ОборотыВыручкаОптНаростающие КАК ОборотыВыручкаОптНаростающие
		|		ПО КешОпт.Организация = ОборотыВыручкаОптНаростающие.Организация
		|			И КешОпт.Дата >= ОборотыВыручкаОптНаростающие.Дата
		|			И КешОпт.Дата < ОборотыВыручкаОптНаростающие.КонецПериода
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Дата,
		|	Организация
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	РозподелПоКалендарюРозница.Дата КАК Дата,
		|	РозподелПоКалендарюРозница.Организация КАК Организация,
		|	ЕСТЬNULL(ОборотыВыручкаРозницаНаростающие.Сумма, 0) КАК Сумма
		|ПОМЕСТИТЬ КешВыручкаРозница
		|ИЗ
		|	РозподелПоКалендарюРозница КАК РозподелПоКалендарюРозница
		|		ЛЕВОЕ СОЕДИНЕНИЕ ОборотыВыручкаРозницаНаростающие КАК ОборотыВыручкаРозницаНаростающие
		|		ПО РозподелПоКалендарюРозница.Организация = ОборотыВыручкаРозницаНаростающие.Организация
		|			И РозподелПоКалендарюРозница.Дата >= ОборотыВыручкаРозницаНаростающие.Дата
		|			И РозподелПоКалендарюРозница.Дата < ОборотыВыручкаРозницаНаростающие.КонецПериода
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Дата,
		|	Организация
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	СебестоимостьТоваровОбороты.Период КАК Период,
		|	РегистраторАналитикаУчетаНоменклатуры.Номенклатура.ВидНоменклатуры КАК ВидНоменклатуры,
		|	СУММА(СебестоимостьТоваровОбороты.СтоимостьОборот) КАК Сумма
		|ПОМЕСТИТЬ ОборотыЗакупкиВидНоменклатуры
		|ИЗ
		|	РегистрНакопления.СебестоимостьТоваров.Обороты(&ГраницаНачалоПериода, &ГраницаКонецПериода, Регистратор, ) КАК СебестоимостьТоваровОбороты
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаНоменклатуры КАК РегистраторАналитикаУчетаНоменклатуры
		|		ПО СебестоимостьТоваровОбороты.АналитикаУчетаНоменклатуры = РегистраторАналитикаУчетаНоменклатуры.КлючАналитики
		|ГДЕ
		|	СебестоимостьТоваровОбороты.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
		|
		|СГРУППИРОВАТЬ ПО
		|	СебестоимостьТоваровОбороты.Период,
		|	РегистраторАналитикаУчетаНоменклатуры.Номенклатура.ВидНоменклатуры
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Период,
		|	ВидНоменклатуры
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	КОНЕЦПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ) КАК Дата,
		|	Пересечения.КонецПериода КАК КонецПериода,
		|	СУММА(ЕСТЬNULL(Обороты.Сумма, 0)) КАК Сумма,
		|	Обороты.ВидНоменклатуры КАК ВидНоменклатуры
		|ПОМЕСТИТЬ ЗакупкиВидНоменклатурыНаростающие
		|ИЗ
		|	НаростающийКалендарь КАК Пересечения
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ОборотыЗакупкиВидНоменклатуры КАК Обороты
		|		ПО (ВЫБОР
		|				КОГДА НАЧАЛОПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ) = &НачалоПериода
		|						И НАЧАЛОПЕРИОДА(Пересечения.КонецПериода, ДЕНЬ) <> &НачалоПериода
		|					ТОГДА Пересечения.КонецПериода > Обороты.Период
		|							И НАЧАЛОПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ) <= Обороты.Период
		|				КОГДА НАЧАЛОПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ) <> &НачалоПериода
		|					ТОГДА Пересечения.КонецПериода > Обороты.Период
		|							И Пересечения.НачалоПериода <= Обороты.Период
		|			КОНЕЦ)
		|
		|СГРУППИРОВАТЬ ПО
		|	Пересечения.КонецПериода,
		|	КОНЕЦПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ),
		|	Обороты.ВидНоменклатуры
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Дата,
		|	Пересечения.КонецПериода,
		|	ВидНоменклатуры
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	НаростающийКалендарь.КонецПериода КАК Дата,
		|	ВидыНоменклатуры.Ссылка КАК ВидНоменклатуры
		|ПОМЕСТИТЬ РозподелПоКалендарюВидыНоменклатуры
		|ИЗ
		|	НаростающийКалендарь КАК НаростающийКалендарь,
		|	Справочник.ВидыНоменклатуры КАК ВидыНоменклатуры
		|ГДЕ
		|	НЕ ВидыНоменклатуры.ПометкаУдаления
		|	И НЕ ВидыНоменклатуры.ЭтоГруппа
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Дата,
		|	ВидНоменклатуры
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	РозподелПоКалендарю.Дата КАК Дата,
		|	РозподелПоКалендарю.ВидНоменклатуры КАК ВидНоменклатуры,
		|	ЕСТЬNULL(ОборотыНаростающие.Сумма, 0) КАК Сумма
		|ПОМЕСТИТЬ КешЗакупкиВидНоменклатуры
		|ИЗ
		|	РозподелПоКалендарюВидыНоменклатуры КАК РозподелПоКалендарю
		|		ЛЕВОЕ СОЕДИНЕНИЕ ЗакупкиВидНоменклатурыНаростающие КАК ОборотыНаростающие
		|		ПО РозподелПоКалендарю.ВидНоменклатуры = ОборотыНаростающие.ВидНоменклатуры
		|			И РозподелПоКалендарю.Дата >= ОборотыНаростающие.Дата
		|			И РозподелПоКалендарю.Дата < ОборотыНаростающие.КонецПериода
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Дата,
		|	ВидНоменклатуры
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ВыручкаИСебестоимостьПродажОбороты.Период КАК Период,
		|	ВЫРАЗИТЬ(ВыручкаИСебестоимостьПродажОбороты.Регистратор КАК Документ.ПоступлениеТоваровУслуг).Партнер КАК Партнер,
		|	СУММА(ВыручкаИСебестоимостьПродажОбороты.СтоимостьОборот) КАК Сумма
		|ПОМЕСТИТЬ ОборотыЗакупкиПартнеры
		|ИЗ
		|	РегистрНакопления.СебестоимостьТоваров.Обороты(&ГраницаНачалоПериода, &ГраницаКонецПериода, Регистратор, ) КАК ВыручкаИСебестоимостьПродажОбороты
		|ГДЕ
		|	ВыручкаИСебестоимостьПродажОбороты.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
		|
		|СГРУППИРОВАТЬ ПО
		|	ВыручкаИСебестоимостьПродажОбороты.Период,
		|	ВЫРАЗИТЬ(ВыручкаИСебестоимостьПродажОбороты.Регистратор КАК Документ.ПоступлениеТоваровУслуг).Партнер
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Период,
		|	Партнер
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	ВЫРАЗИТЬ(ВыручкаИСебестоимостьПродажОбороты.Регистратор КАК Документ.ПоступлениеТоваровУслуг).Партнер КАК Партнер
		|ПОМЕСТИТЬ ЗакупкиПартнеры
		|ИЗ
		|	РегистрНакопления.СебестоимостьТоваров.Обороты(&ГраницаНачалоПериода, &ГраницаКонецПериода, Регистратор, ) КАК ВыручкаИСебестоимостьПродажОбороты
		|ГДЕ
		|	ВыручкаИСебестоимостьПродажОбороты.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
		|
		|СГРУППИРОВАТЬ ПО
		|	ВЫРАЗИТЬ(ВыручкаИСебестоимостьПродажОбороты.Регистратор КАК Документ.ПоступлениеТоваровУслуг).Партнер
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Партнер
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	КОНЕЦПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ) КАК Дата,
		|	Пересечения.КонецПериода КАК КонецПериода,
		|	СУММА(ЕСТЬNULL(Обороты.Сумма, 0)) КАК Сумма,
		|	Обороты.Партнер КАК Партнер
		|ПОМЕСТИТЬ ЗакупкиПартнерыНаростающие
		|ИЗ
		|	НаростающийКалендарь КАК Пересечения
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ОборотыЗакупкиПартнеры КАК Обороты
		|		ПО (ВЫБОР
		|				КОГДА НАЧАЛОПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ) = &НачалоПериода
		|						И НАЧАЛОПЕРИОДА(Пересечения.КонецПериода, ДЕНЬ) <> &НачалоПериода
		|					ТОГДА Пересечения.КонецПериода > Обороты.Период
		|							И НАЧАЛОПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ) <= Обороты.Период
		|				КОГДА НАЧАЛОПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ) <> &НачалоПериода
		|					ТОГДА Пересечения.КонецПериода > Обороты.Период
		|							И Пересечения.НачалоПериода <= Обороты.Период
		|			КОНЕЦ)
		|
		|СГРУППИРОВАТЬ ПО
		|	Пересечения.КонецПериода,
		|	КОНЕЦПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ),
		|	Обороты.Партнер
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Дата,
		|	Пересечения.КонецПериода,
		|	Партнер
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	НаростающийКалендарь.КонецПериода КАК Дата,
		|	ЗакупкиПартнеры.Партнер КАК Партнер
		|ПОМЕСТИТЬ РозподелПоКалендарюПартнеры
		|ИЗ
		|	НаростающийКалендарь КАК НаростающийКалендарь,
		|	ЗакупкиПартнеры КАК ЗакупкиПартнеры
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Дата,
		|	Партнер
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	РозподелПоКалендарю.Дата КАК Дата,
		|	РозподелПоКалендарю.Партнер КАК Партнер,
		|	ЕСТЬNULL(ОборотыНаростающие.Сумма, 0) КАК Сумма
		|ПОМЕСТИТЬ КешЗакупкиПартнеры
		|ИЗ
		|	РозподелПоКалендарюПартнеры КАК РозподелПоКалендарю
		|		ЛЕВОЕ СОЕДИНЕНИЕ ЗакупкиПартнерыНаростающие КАК ОборотыНаростающие
		|		ПО РозподелПоКалендарю.Партнер = ОборотыНаростающие.Партнер
		|			И РозподелПоКалендарю.Дата >= ОборотыНаростающие.Дата
		|			И РозподелПоКалендарю.Дата < ОборотыНаростающие.КонецПериода
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Дата,
		|	Партнер
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ВыручкаИСебестоимостьПродажОбороты.Период КАК Период,
		|	РегистраторАналитикаУчетаНоменклатуры.Номенклатура.ВидНоменклатуры КАК ВидНоменклатуры,
		|	СУММА(ВыручкаИСебестоимостьПродажОбороты.СебестоимостьОборот) КАК Сумма
		|ПОМЕСТИТЬ ОборотыПродажиВидНоменклатуры
		|ИЗ
		|	РегистрНакопления.ВыручкаИСебестоимостьПродаж.Обороты(&ГраницаНачалоПериода, &ГраницаКонецПериода, День, АналитикаУчетаПоПартнерам.Партнер <> ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)) КАК ВыручкаИСебестоимостьПродажОбороты
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаНоменклатуры КАК РегистраторАналитикаУчетаНоменклатуры
		|		ПО ВыручкаИСебестоимостьПродажОбороты.АналитикаУчетаНоменклатуры = РегистраторАналитикаУчетаНоменклатуры.КлючАналитики
		|
		|СГРУППИРОВАТЬ ПО
		|	ВыручкаИСебестоимостьПродажОбороты.Период,
		|	РегистраторАналитикаУчетаНоменклатуры.Номенклатура.ВидНоменклатуры
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Период,
		|	ВидНоменклатуры
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	КОНЕЦПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ) КАК Дата,
		|	Пересечения.КонецПериода КАК КонецПериода,
		|	СУММА(ЕСТЬNULL(Обороты.Сумма, 0)) КАК Сумма,
		|	Обороты.ВидНоменклатуры КАК ВидНоменклатуры
		|ПОМЕСТИТЬ ПродажиВидНоменклатурыНаростающие
		|ИЗ
		|	НаростающийКалендарь КАК Пересечения
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ОборотыПродажиВидНоменклатуры КАК Обороты
		|		ПО (ВЫБОР
		|				КОГДА НАЧАЛОПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ) = &НачалоПериода
		|						И НАЧАЛОПЕРИОДА(Пересечения.КонецПериода, ДЕНЬ) <> &НачалоПериода
		|					ТОГДА Пересечения.КонецПериода > Обороты.Период
		|							И НАЧАЛОПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ) <= Обороты.Период
		|				КОГДА НАЧАЛОПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ) <> &НачалоПериода
		|					ТОГДА Пересечения.КонецПериода > Обороты.Период
		|							И Пересечения.НачалоПериода <= Обороты.Период
		|			КОНЕЦ)
		|
		|СГРУППИРОВАТЬ ПО
		|	Пересечения.КонецПериода,
		|	КОНЕЦПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ),
		|	Обороты.ВидНоменклатуры
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Дата,
		|	Пересечения.КонецПериода,
		|	ВидНоменклатуры
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	РозподелПоКалендарю.Дата КАК Дата,
		|	РозподелПоКалендарю.ВидНоменклатуры КАК ВидНоменклатуры,
		|	ЕСТЬNULL(ОборотыНаростающие.Сумма, 0) КАК Сумма
		|ПОМЕСТИТЬ КешПродажиВидНоменклатуры
		|ИЗ
		|	РозподелПоКалендарюВидыНоменклатуры КАК РозподелПоКалендарю
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПродажиВидНоменклатурыНаростающие КАК ОборотыНаростающие
		|		ПО РозподелПоКалендарю.ВидНоменклатуры = ОборотыНаростающие.ВидНоменклатуры
		|			И РозподелПоКалендарю.Дата >= ОборотыНаростающие.Дата
		|			И РозподелПоКалендарю.Дата < ОборотыНаростающие.КонецПериода
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Дата,
		|	ВидНоменклатуры
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ВыручкаИСебестоимостьПродажОбороты.Период КАК Период,
		|	РегистрАналитикаУчетаПоПартнерам.Организация КАК Организация,
		|	СУММА(ВыручкаИСебестоимостьПродажОбороты.СебестоимостьОборот) КАК Сумма
		|ПОМЕСТИТЬ ОборотыПродажиОрганизации
		|ИЗ
		|	РегистрНакопления.ВыручкаИСебестоимостьПродаж.Обороты(&ГраницаНачалоПериода, &ГраницаКонецПериода, ДЕНЬ, АналитикаУчетаПоПартнерам.Партнер <> ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)) КАК ВыручкаИСебестоимостьПродажОбороты
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаПоПартнерам КАК РегистрАналитикаУчетаПоПартнерам
		|		ПО ВыручкаИСебестоимостьПродажОбороты.АналитикаУчетаПоПартнерам = РегистрАналитикаУчетаПоПартнерам.КлючАналитики
		|
		|СГРУППИРОВАТЬ ПО
		|	ВыручкаИСебестоимостьПродажОбороты.Период,
		|	РегистрАналитикаУчетаПоПартнерам.Организация
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Период,
		|	Организация
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	РегистрАналитикаУчетаПоПартнерам.Организация КАК Организация
		|ПОМЕСТИТЬ ПродажиОрганизации
		|ИЗ
		|	РегистрНакопления.ВыручкаИСебестоимостьПродаж.Обороты(&ГраницаНачалоПериода, &ГраницаКонецПериода, ДЕНЬ, АналитикаУчетаПоПартнерам.Партнер <> ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)) КАК ВыручкаИСебестоимостьПродажОбороты
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаПоПартнерам КАК РегистрАналитикаУчетаПоПартнерам
		|		ПО ВыручкаИСебестоимостьПродажОбороты.АналитикаУчетаПоПартнерам = РегистрАналитикаУчетаПоПартнерам.КлючАналитики
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Организация
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	КОНЕЦПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ) КАК Дата,
		|	Пересечения.КонецПериода КАК КонецПериода,
		|	СУММА(ЕСТЬNULL(Обороты.Сумма, 0)) КАК Сумма,
		|	Обороты.Организация КАК Организация
		|ПОМЕСТИТЬ ПродажиОрганизацииНаростающие
		|ИЗ
		|	НаростающийКалендарь КАК Пересечения
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ОборотыПродажиОрганизации КАК Обороты
		|		ПО (ВЫБОР
		|				КОГДА НАЧАЛОПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ) = &НачалоПериода
		|						И НАЧАЛОПЕРИОДА(Пересечения.КонецПериода, ДЕНЬ) <> &НачалоПериода
		|					ТОГДА Пересечения.КонецПериода > Обороты.Период
		|							И НАЧАЛОПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ) <= Обороты.Период
		|				КОГДА НАЧАЛОПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ) <> &НачалоПериода
		|					ТОГДА Пересечения.КонецПериода > Обороты.Период
		|							И Пересечения.НачалоПериода <= Обороты.Период
		|			КОНЕЦ)
		|
		|СГРУППИРОВАТЬ ПО
		|	Пересечения.КонецПериода,
		|	КОНЕЦПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ),
		|	Обороты.Организация
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Дата,
		|	Пересечения.КонецПериода,
		|	Организация
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	НаростающийКалендарь.КонецПериода КАК Дата,
		|	ЗакупкиПартнеры.Организация КАК Организация
		|ПОМЕСТИТЬ РозподелПоКалендарюОрганизации
		|ИЗ
		|	НаростающийКалендарь КАК НаростающийКалендарь,
		|	ПродажиОрганизации КАК ЗакупкиПартнеры
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Дата,
		|	Организация
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	РозподелПоКалендарю.Дата КАК Дата,
		|	РозподелПоКалендарю.Организация КАК Организация,
		|	ЕСТЬNULL(ОборотыНаростающие.Сумма, 0) КАК Сумма
		|ПОМЕСТИТЬ КешПродажиОрганизации
		|ИЗ
		|	РозподелПоКалендарюОрганизации КАК РозподелПоКалендарю
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПродажиОрганизацииНаростающие КАК ОборотыНаростающие
		|		ПО РозподелПоКалендарю.Дата >= ОборотыНаростающие.Дата
		|			И РозподелПоКалендарю.Дата < ОборотыНаростающие.КонецПериода
		|			И РозподелПоКалендарю.Организация = ОборотыНаростающие.Организация
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Дата,
		|	Организация
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ДенежныеСредстваНаличныеОбороты.Период КАК Период,
		|	ДенежныеСредстваНаличныеОбороты.Касса КАК Касса,
		|	СУММА(ДенежныеСредстваНаличныеОбороты.СуммаУпрПриход) КАК Сумма
		|ПОМЕСТИТЬ ОборотыКассаПриход
		|ИЗ
		|	РегистрНакопления.ДенежныеСредстваНаличные.Обороты(&ГраницаНачалоПериода, &ГраницаКонецПериода, День, ) КАК ДенежныеСредстваНаличныеОбороты
		|
		|СГРУППИРОВАТЬ ПО
		|	ДенежныеСредстваНаличныеОбороты.Период,
		|	ДенежныеСредстваНаличныеОбороты.Касса
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Период,
		|	Касса
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	ДенежныеСредстваНаличныеОбороты.Касса КАК Касса
		|ПОМЕСТИТЬ КассаПриход
		|ИЗ
		|	РегистрНакопления.ДенежныеСредстваНаличные.Обороты(&ГраницаНачалоПериода, &ГраницаКонецПериода, День, ) КАК ДенежныеСредстваНаличныеОбороты
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Касса
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	КОНЕЦПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ) КАК Дата,
		|	Пересечения.КонецПериода КАК КонецПериода,
		|	СУММА(ЕСТЬNULL(Обороты.Сумма, 0)) КАК Сумма,
		|	Обороты.Касса КАК Касса
		|ПОМЕСТИТЬ КассаПриходНаростающие
		|ИЗ
		|	НаростающийКалендарь КАК Пересечения
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ОборотыКассаПриход КАК Обороты
		|		ПО (ВЫБОР
		|				КОГДА НАЧАЛОПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ) = &НачалоПериода
		|						И НАЧАЛОПЕРИОДА(Пересечения.КонецПериода, ДЕНЬ) <> &НачалоПериода
		|					ТОГДА Пересечения.КонецПериода > Обороты.Период
		|							И НАЧАЛОПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ) <= Обороты.Период
		|				КОГДА НАЧАЛОПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ) <> &НачалоПериода
		|					ТОГДА Пересечения.КонецПериода > Обороты.Период
		|							И Пересечения.НачалоПериода <= Обороты.Период
		|			КОНЕЦ)
		|
		|СГРУППИРОВАТЬ ПО
		|	Пересечения.КонецПериода,
		|	КОНЕЦПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ),
		|	Обороты.Касса
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Дата,
		|	Пересечения.КонецПериода,
		|	Касса
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	НаростающийКалендарь.КонецПериода КАК Дата,
		|	ЗакупкиПартнеры.Касса КАК Касса
		|ПОМЕСТИТЬ РозподелПоКалендарюКассаПриход
		|ИЗ
		|	НаростающийКалендарь КАК НаростающийКалендарь,
		|	КассаПриход КАК ЗакупкиПартнеры
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Дата,
		|	Касса
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	РозподелПоКалендарю.Дата КАК Дата,
		|	РозподелПоКалендарю.Касса КАК Касса,
		|	ЕСТЬNULL(ОборотыНаростающие.Сумма, 0) КАК Сумма
		|ПОМЕСТИТЬ КешКассаПриход
		|ИЗ
		|	РозподелПоКалендарюКассаПриход КАК РозподелПоКалендарю
		|		ЛЕВОЕ СОЕДИНЕНИЕ КассаПриходНаростающие КАК ОборотыНаростающие
		|		ПО РозподелПоКалендарю.Дата >= ОборотыНаростающие.Дата
		|			И РозподелПоКалендарю.Дата < ОборотыНаростающие.КонецПериода
		|			И РозподелПоКалендарю.Касса = ОборотыНаростающие.Касса
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Дата,
		|	Касса
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ДенежныеСредстваНаличныеОбороты.Период КАК Период,
		|	ДенежныеСредстваНаличныеОбороты.Касса КАК Касса,
		|	СУММА(ДенежныеСредстваНаличныеОбороты.СуммаУпрРасход) КАК Сумма
		|ПОМЕСТИТЬ ОборотыКассаРасход
		|ИЗ
		|	РегистрНакопления.ДенежныеСредстваНаличные.Обороты(&ГраницаНачалоПериода, &ГраницаКонецПериода, День, ) КАК ДенежныеСредстваНаличныеОбороты
		|
		|СГРУППИРОВАТЬ ПО
		|	ДенежныеСредстваНаличныеОбороты.Период,
		|	ДенежныеСредстваНаличныеОбороты.Касса
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Период,
		|	Касса
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	ДенежныеСредстваНаличныеОбороты.Касса КАК Касса
		|ПОМЕСТИТЬ КассаРасход
		|ИЗ
		|	РегистрНакопления.ДенежныеСредстваНаличные.Обороты(&ГраницаНачалоПериода, &ГраницаКонецПериода, День, ) КАК ДенежныеСредстваНаличныеОбороты
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Касса
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	КОНЕЦПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ) КАК Дата,
		|	Пересечения.КонецПериода КАК КонецПериода,
		|	СУММА(ЕСТЬNULL(Обороты.Сумма, 0)) КАК Сумма,
		|	Обороты.Касса КАК Касса
		|ПОМЕСТИТЬ КассаРасходНаростающие
		|ИЗ
		|	НаростающийКалендарь КАК Пересечения
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ОборотыКассаРасход КАК Обороты
		|		ПО (ВЫБОР
		|				КОГДА НАЧАЛОПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ) = &НачалоПериода
		|						И НАЧАЛОПЕРИОДА(Пересечения.КонецПериода, ДЕНЬ) <> &НачалоПериода
		|					ТОГДА Пересечения.КонецПериода > Обороты.Период
		|							И НАЧАЛОПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ) <= Обороты.Период
		|				КОГДА НАЧАЛОПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ) <> &НачалоПериода
		|					ТОГДА Пересечения.КонецПериода > Обороты.Период
		|							И Пересечения.НачалоПериода <= Обороты.Период
		|			КОНЕЦ)
		|
		|СГРУППИРОВАТЬ ПО
		|	Пересечения.КонецПериода,
		|	КОНЕЦПЕРИОДА(Пересечения.НачалоПериода, ДЕНЬ),
		|	Обороты.Касса
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Дата,
		|	Пересечения.КонецПериода,
		|	Касса
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	НаростающийКалендарь.КонецПериода КАК Дата,
		|	ЗакупкиПартнеры.Касса КАК Касса
		|ПОМЕСТИТЬ РозподелПоКалендарюКассаРасход
		|ИЗ
		|	НаростающийКалендарь КАК НаростающийКалендарь,
		|	КассаРасход КАК ЗакупкиПартнеры
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Дата,
		|	Касса
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	РозподелПоКалендарю.Дата КАК Дата,
		|	РозподелПоКалендарю.Касса КАК Касса,
		|	ЕСТЬNULL(ОборотыНаростающие.Сумма, 0) КАК Сумма
		|ПОМЕСТИТЬ КешКассаРасход
		|ИЗ
		|	РозподелПоКалендарюКассаРасход КАК РозподелПоКалендарю
		|		ЛЕВОЕ СОЕДИНЕНИЕ КассаРасходНаростающие КАК ОборотыНаростающие
		|		ПО РозподелПоКалендарю.Дата >= ОборотыНаростающие.Дата
		|			И РозподелПоКалендарю.Дата < ОборотыНаростающие.КонецПериода
		|			И РозподелПоКалендарю.Касса = ОборотыНаростающие.Касса
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Дата,
		|	Касса
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	НаростающийКалендарь.КонецПериода КАК КонецПериода,
		|	ТаблицаКурсов.Курс КАК Курс,
		|	ТаблицаКурсов.Валюта КАК Валюта
		|ПОМЕСТИТЬ КешКурсов
		|ИЗ
		|	НаростающийКалендарь КАК НаростающийКалендарь
		|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКурсов КАК ТаблицаКурсов
		|		ПО (НАЧАЛОПЕРИОДА(НаростающийКалендарь.КонецПериода, ДЕНЬ) >= ТаблицаКурсов.НачалоПериода)
		|			И (НАЧАЛОПЕРИОДА(НаростающийКалендарь.КонецПериода, ДЕНЬ) < ТаблицаКурсов.КонецПериода)
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	КонецПериода,
		|	Валюта
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	НаличныеДС.Период КАК Период,
		|	НаличныеДС.Касса КАК Касса,
		|	НаличныеДС.Касса.ВалютаДенежныхСредств КАК Валюта,
		|	СУММА(НаличныеДС.СуммаКонечныйОстаток) КАК СуммаОстаток
		|ПОМЕСТИТЬ ОборотыНаличные
		|ИЗ
		|	РегистрНакопления.ДенежныеСредстваНаличные.ОстаткиИОбороты(&ГраницаНачалоПериода, &ГраницаКонецПериода, ДЕНЬ, , ) КАК НаличныеДС
		|
		|СГРУППИРОВАТЬ ПО
		|	НаличныеДС.Период,
		|	НаличныеДС.Касса,
		|	НаличныеДС.Касса.ВалютаДенежныхСредств
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Период,
		|	Касса,
		|	Валюта
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ОборотыНаличные.Касса КАК Касса,
		|	ОборотыНаличные.Валюта КАК Валюта,
		|	ОборотыНаличные.СуммаОстаток КАК СуммаОстаток,
		|	ОборотыНаличные.Период КАК НачалоПериода,
		|	МИНИМУМ(ЕСТЬNULL(ОборотыНаличныеКопия.Период, &КонецПериода)) КАК КонецПериода
		|ПОМЕСТИТЬ ОборотыНаличныеНарастающие
		|ИЗ
		|	ОборотыНаличные КАК ОборотыНаличные
		|		ЛЕВОЕ СОЕДИНЕНИЕ ОборотыНаличные КАК ОборотыНаличныеКопия
		|		ПО (ОборотыНаличныеКопия.Касса = ОборотыНаличные.Касса)
		|			И (ОборотыНаличныеКопия.Валюта = ОборотыНаличные.Валюта)
		|			И (ОборотыНаличныеКопия.Период > ОборотыНаличные.Период)
		|
		|СГРУППИРОВАТЬ ПО
		|	ОборотыНаличные.Касса,
		|	ОборотыНаличные.Период,
		|	ОборотыНаличные.Валюта,
		|	ОборотыНаличные.СуммаОстаток
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Касса,
		|	Валюта,
		|	НачалоПериода,
		|	КонецПериода
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	НаростающийКалендарь.КонецПериода КАК КонецПериода,
		|	ОборотыНаличные.Касса КАК Касса,
		|	ОборотыНаличные.Валюта КАК Валюта,
		|	НаростающийКалендарь.НачалоПериода
		|ПОМЕСТИТЬ ТаблицаКассы
		|ИЗ
		|	НаростающийКалендарь КАК НаростающийКалендарь,
		|	ОборотыНаличные КАК ОборотыНаличные
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	КонецПериода,
		|	Касса,
		|	Валюта
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	Кассы.НачалоПериода КАК НачалоПериода,
		|	МАКСИМУМ(ОборотыНарастающие.НачалоПериода) КАК ПериодПрисоединения,
		|	Кассы.Касса КАК Касса,
		|	Кассы.Валюта КАК Валюта,
		|	Кассы.КонецПериода
		|ПОМЕСТИТЬ БазовыйСписок
		|ИЗ
		|	ТаблицаКассы КАК Кассы
		|		ЛЕВОЕ СОЕДИНЕНИЕ ОборотыНаличныеНарастающие КАК ОборотыНарастающие
		|		ПО Кассы.КонецПериода >= ОборотыНарастающие.НачалоПериода
		|			И Кассы.Касса = ОборотыНарастающие.Касса
		|			И Кассы.Валюта = ОборотыНарастающие.Валюта
		|
		|СГРУППИРОВАТЬ ПО
		|	Кассы.НачалоПериода,
		|	Кассы.Касса,
		|	Кассы.Валюта,
		|	Кассы.КонецПериода
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	НачалоПериода,
		|	ПериодПрисоединения
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	БазовыйСписок2.НачалоПериода КАК НачалоПериода,
		|	БазовыйСписок2.КонецПериода КАК Дата,
		|	БазовыйСписок2.Касса КАК Касса,
		|	ВЫБОР
		|		КОГДА БазовыйСписок2.КонецПериода = КОНЕЦПЕРИОДА(&НачалоПериода, ДЕНЬ)
		|			ТОГДА 0
		|		ИНАЧЕ ЕСТЬNULL(ОборотыНаличныеНарастающие.СуммаОстаток, 0)
		|	КОНЕЦ КАК СуммаОстаток,
		|	БазовыйСписок2.Валюта КАК Валюта
		|ПОМЕСТИТЬ КешКасса
		|ИЗ
		|	БазовыйСписок КАК БазовыйСписок2
		|		ЛЕВОЕ СОЕДИНЕНИЕ ОборотыНаличныеНарастающие КАК ОборотыНаличныеНарастающие
		|		ПО БазовыйСписок2.Касса = ОборотыНаличныеНарастающие.Касса
		|			И БазовыйСписок2.ПериодПрисоединения = ОборотыНаличныеНарастающие.НачалоПериода
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	&НачалоПериода,
		|	КОНЕЦПЕРИОДА(&НачалоПериода, ДЕНЬ),
		|	ДенежныеСредстваНаличныеОстатки.Касса,
		|	ДенежныеСредстваНаличныеОстатки.СуммаОстаток,
		|	ДенежныеСредстваНаличныеОстатки.Касса.ВалютаДенежныхСредств
		|ИЗ
		|	РегистрНакопления.ДенежныеСредстваНаличные.Остатки(&КонецПериода, ) КАК ДенежныеСредстваНаличныеОстатки
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	НачалоПериода,
		|	Дата,
		|	Касса,
		|	Валюта
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	КешКасса2.Дата КАК Дата,
		|	КешКасса2.Касса КАК Касса,
		|	СУММА(КешКасса2.СуммаОстаток * КешКурсов.Курс / КешУпрКурсов.Курс) КАК Сумма
		|ПОМЕСТИТЬ ОсновнойКешКасса
		|ИЗ
		|	КешКасса КАК КешКасса2
		|		ЛЕВОЕ СОЕДИНЕНИЕ КешКурсов КАК КешУпрКурсов
		|		ПО КешКасса2.Дата = КешУпрКурсов.КонецПериода
		|		ЛЕВОЕ СОЕДИНЕНИЕ КешКурсов КАК КешКурсов
		|		ПО КешКасса2.Дата = КешКурсов.КонецПериода
		|			И КешКасса2.Валюта = КешКурсов.Валюта
		|ГДЕ
		|	КешУпрКурсов.Валюта = &ВалютаУправленческогоУчета
		|
		|СГРУППИРОВАТЬ ПО
		|	КешКасса2.Дата,
		|	КешКасса2.Касса
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Дата,
		|	Касса
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	БезналДС.Период КАК Период,
		|	БезналДС.БанковскийСчет КАК Банк,
		|	БезналДС.БанковскийСчет.ВалютаДенежныхСредств КАК Валюта,
		|	СУММА(БезналДС.СуммаКонечныйОстаток) КАК СуммаОстаток
		|ПОМЕСТИТЬ ОборотыБезналичные
		|ИЗ
		|	РегистрНакопления.ДенежныеСредстваБезналичные.ОстаткиИОбороты(&ГраницаНачалоПериода, &ГраницаКонецПериода, ДЕНЬ, , ) КАК БезналДС
		|
		|СГРУППИРОВАТЬ ПО
		|	БезналДС.Период,
		|	БезналДС.БанковскийСчет,
		|	БезналДС.БанковскийСчет.ВалютаДенежныхСредств
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Период,
		|	Банк,
		|	Валюта
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ОборотыБезналичные.Банк КАК Банк,
		|	ОборотыБезналичные.Валюта КАК Валюта,
		|	ОборотыБезналичные.СуммаОстаток КАК СуммаОстаток,
		|	ОборотыБезналичные.Период КАК НачалоПериода,
		|	МИНИМУМ(ЕСТЬNULL(ОборотыБезналичныеКопия.Период, &КонецПериода)) КАК КонецПериода
		|ПОМЕСТИТЬ ОборотыБезналичныеНарастающие
		|ИЗ
		|	ОборотыБезналичные КАК ОборотыБезналичные
		|		ЛЕВОЕ СОЕДИНЕНИЕ ОборотыБезналичные КАК ОборотыБезналичныеКопия
		|		ПО (ОборотыБезналичныеКопия.Банк = ОборотыБезналичные.Банк)
		|			И (ОборотыБезналичныеКопия.Валюта = ОборотыБезналичные.Валюта)
		|			И (ОборотыБезналичныеКопия.Период > ОборотыБезналичные.Период)
		|
		|СГРУППИРОВАТЬ ПО
		|	ОборотыБезналичные.Банк,
		|	ОборотыБезналичные.Период,
		|	ОборотыБезналичные.Валюта,
		|	ОборотыБезналичные.СуммаОстаток
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Банк,
		|	Валюта,
		|	НачалоПериода,
		|	КонецПериода
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	НаростающийКалендарь.НачалоПериода КАК НачалоПериода,
		|	НаростающийКалендарь.КонецПериода КАК КонецПериода,
		|	БанковскиеСчетаОрганизаций.Ссылка КАК Банк,
		|	БанковскиеСчетаОрганизаций.ВалютаДенежныхСредств КАК Валюта
		|ПОМЕСТИТЬ КешНаростающиеКалендарБанк
		|ИЗ
		|	НаростающийКалендарь КАК НаростающийКалендарь
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.БанковскиеСчетаОрганизаций КАК БанковскиеСчетаОрганизаций
		|		ПО (ИСТИНА)
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	НачалоПериода,
		|	КонецПериода,
		|	Банк,
		|	Валюта
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	НаростающийКалендарь.НачалоПериода КАК НачалоПериода,
		|	НаростающийКалендарь.КонецПериода КАК КонецПериода,
		|	НаростающийКалендарь.Банк КАК Банк,
		|	МАКСИМУМ(ОборотыНарастающие.НачалоПериода) КАК ПериодПрисоединения,
		|	НаростающийКалендарь.Валюта КАК Валюта
		|ПОМЕСТИТЬ БазовыйСписокПоБанку
		|ИЗ
		|	КешНаростающиеКалендарБанк КАК НаростающийКалендарь
		|		ЛЕВОЕ СОЕДИНЕНИЕ ОборотыБезналичныеНарастающие КАК ОборотыНарастающие
		|		ПО (ОборотыНарастающие.Банк = НаростающийКалендарь.Банк)
		|			И (ОборотыНарастающие.НачалоПериода <= НАЧАЛОПЕРИОДА(ДОБАВИТЬКДАТЕ(НаростающийКалендарь.КонецПериода, СЕКУНДА, 1), ДЕНЬ))
		|
		|СГРУППИРОВАТЬ ПО
		|	НаростающийКалендарь.НачалоПериода,
		|	НаростающийКалендарь.КонецПериода,
		|	НаростающийКалендарь.Банк,
		|	НаростающийКалендарь.Валюта
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	НачалоПериода,
		|	КонецПериода,
		|	Банк,
		|	Валюта,
		|	ПериодПрисоединения
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	БазовыйСписокПоБанку.НачалоПериода КАК НачалоПериода,
		|	БазовыйСписокПоБанку.КонецПериода КАК Дата,
		|	БазовыйСписокПоБанку.Банк КАК Банк,
		|	ЕСТЬNULL(ОборотыБезналичныеНарастающие.СуммаОстаток, 0) КАК СуммаОстаток,
		|	БазовыйСписокПоБанку.Валюта КАК Валюта
		|ПОМЕСТИТЬ КешБанкБезНал
		|ИЗ
		|	БазовыйСписокПоБанку КАК БазовыйСписокПоБанку
		|		ЛЕВОЕ СОЕДИНЕНИЕ ОборотыБезналичныеНарастающие КАК ОборотыБезналичныеНарастающие
		|		ПО БазовыйСписокПоБанку.Банк = ОборотыБезналичныеНарастающие.Банк
		|			И БазовыйСписокПоБанку.ПериодПрисоединения = ОборотыБезналичныеНарастающие.НачалоПериода
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	НачалоПериода,
		|	Дата,
		|	Банк,
		|	Валюта
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	КешБанк.Дата КАК Дата,
		|	КешБанк.Банк КАК Банк,
		|	КешБанк.СуммаОстаток * КешКурсов.Курс / КешУпрКурсов.Курс КАК Сумма
		|ПОМЕСТИТЬ ОсновнойКешБанк
		|ИЗ
		|	КешБанкБезНал КАК КешБанк
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ КешКурсов КАК КешКурсов
		|		ПО КешБанк.Валюта = КешКурсов.Валюта
		|			И КешБанк.Дата = КешКурсов.КонецПериода
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ КешКурсов КАК КешУпрКурсов
		|		ПО КешБанк.Дата = КешУпрКурсов.КонецПериода
		|ГДЕ
		|	КешУпрКурсов.Валюта = &ВалютаУправленческогоУчета
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Дата,
		|	Банк
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	СтоимостьСкладаОбороты.Период КАК Период,
		|	СтоимостьСкладаОбороты.Склад КАК Склад,
		|	СУММА(ВЫБОР
		|			КОГДА СтоимостьСкладаОбороты.Период = НАЧАЛОПЕРИОДА(&КонецПериода, ДЕНЬ)
		|				ТОГДА 0
		|			ИНАЧЕ СтоимостьСкладаОбороты.СтоимостьОборот
		|		КОНЕЦ) КАК Сумма
		|ПОМЕСТИТЬ ОборотыСклад
		|ИЗ
		|	РегистрНакопления.СтоимостьСклада.Обороты(&ГраницаНачалоПериода, ДОБАВИТЬКДАТЕ(&КонецПериода, ДЕНЬ, -1), День, ) КАК СтоимостьСкладаОбороты
		|
		|СГРУППИРОВАТЬ ПО
		|	СтоимостьСкладаОбороты.Период,
		|	СтоимостьСкладаОбороты.Склад
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	НАЧАЛОПЕРИОДА(&КонецПериода, ДЕНЬ),
		|	РегистрАналитикаУчетаНоменклатуры.Склад,
		|	СУММА(СебестоимостьТоваровОстатки.СтоимостьОстаток)
		|ИЗ
		|	РегистрНакопления.СебестоимостьТоваров.Остатки(&ГраницаКонецПериода, ) КАК СебестоимостьТоваровОстатки
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаНоменклатуры КАК РегистрАналитикаУчетаНоменклатуры
		|		ПО СебестоимостьТоваровОстатки.АналитикаУчетаНоменклатуры = РегистрАналитикаУчетаНоменклатуры.КлючАналитики
		|
		|СГРУППИРОВАТЬ ПО
		|	РегистрАналитикаУчетаНоменклатуры.Склад
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	НаростающийКалендарь.КонецПериода КАК Дата,
		|	Обороты.Склад КАК Склад
		|ПОМЕСТИТЬ ТаблицаСклады
		|ИЗ
		|	НаростающийКалендарь КАК НаростающийКалендарь,
		|	ОборотыСклад КАК Обороты
		|
		|СГРУППИРОВАТЬ ПО
		|	НаростающийКалендарь.КонецПериода,
		|	Обороты.Склад
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ТаблицаПартнеры.Дата,
		|	ТаблицаПартнеры.Склад,
		|	ЕСТЬNULL(ОборотыНарастающие.Сумма, 0) КАК Сумма
		|ПОМЕСТИТЬ СписокСтоимостьСклада
		|ИЗ
		|	ТаблицаСклады КАК ТаблицаПартнеры
		|		ЛЕВОЕ СОЕДИНЕНИЕ ОборотыСклад КАК ОборотыНарастающие
		|		ПО ТаблицаПартнеры.Склад = ОборотыНарастающие.Склад
		|			И (ВЫБОР
		|				КОГДА ТаблицаПартнеры.Дата = КОНЕЦПЕРИОДА(&НачалоПериода, ДЕНЬ)
		|					ТОГДА ТаблицаПартнеры.Дата = КОНЕЦПЕРИОДА(ОборотыНарастающие.Период, ДЕНЬ)
		|				КОГДА ТаблицаПартнеры.Дата = &КонецПериода
		|					ТОГДА ОборотыНарастающие.Период = НАЧАЛОПЕРИОДА(&КонецПериода, ДЕНЬ)
		|				ИНАЧЕ ДОБАВИТЬКДАТЕ(ТаблицаПартнеры.Дата, СЕКУНДА, 1) = ОборотыНарастающие.Период
		|			КОНЕЦ)
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	СтоимостьСкладаОбороты.Период КАК Период,
		|	СУММА(ВЫБОР
		|			КОГДА СтоимостьСкладаОбороты.Период = НАЧАЛОПЕРИОДА(&КонецПериода, ДЕНЬ)
		|				ТОГДА 0
		|			ИНАЧЕ СтоимостьСкладаОбороты.СтоимостьОборот
		|		КОНЕЦ) КАК Сумма,
		|	СтоимостьСкладаОбороты.Номенклатура.ВидНоменклатуры КАК ВидНоменклатуры
		|ПОМЕСТИТЬ ОборотыСклад_ВидыНоменклатуры
		|ИЗ
		|	РегистрНакопления.СтоимостьСклада.Обороты(&ГраницаНачалоПериода, ДОБАВИТЬКДАТЕ(&КонецПериода, ДЕНЬ, -1), День, ) КАК СтоимостьСкладаОбороты
		|
		|СГРУППИРОВАТЬ ПО
		|	СтоимостьСкладаОбороты.Период,
		|	СтоимостьСкладаОбороты.Номенклатура.ВидНоменклатуры
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	НАЧАЛОПЕРИОДА(&КонецПериода, ДЕНЬ),
		|	СУММА(СебестоимостьТоваровОстатки.СтоимостьОстаток),
		|	РегистрАналитикаУчетаНоменклатуры.Номенклатура.ВидНоменклатуры
		|ИЗ
		|	РегистрНакопления.СебестоимостьТоваров.Остатки(&ГраницаКонецПериода, ) КАК СебестоимостьТоваровОстатки
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаНоменклатуры КАК РегистрАналитикаУчетаНоменклатуры
		|		ПО СебестоимостьТоваровОстатки.АналитикаУчетаНоменклатуры = РегистрАналитикаУчетаНоменклатуры.КлючАналитики
		|
		|СГРУППИРОВАТЬ ПО
		|	РегистрАналитикаУчетаНоменклатуры.Номенклатура.ВидНоменклатуры
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	НаростающийКалендарь.КонецПериода КАК Дата,
		|	Обороты.ВидНоменклатуры
		|ПОМЕСТИТЬ ТаблицаВидыНоменклатуры
		|ИЗ
		|	НаростающийКалендарь КАК НаростающийКалендарь,
		|	ОборотыСклад_ВидыНоменклатуры КАК Обороты
		|
		|СГРУППИРОВАТЬ ПО
		|	НаростающийКалендарь.КонецПериода,
		|	Обороты.ВидНоменклатуры
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ТаблицаПартнеры.Дата,
		|	ЕСТЬNULL(ОборотыНарастающие.Сумма, 0) КАК Сумма,
		|	ТаблицаПартнеры.ВидНоменклатуры
		|ПОМЕСТИТЬ СписокСтоимостьСклада_ВидыНоменклатуры
		|ИЗ
		|	ТаблицаВидыНоменклатуры КАК ТаблицаПартнеры
		|		ЛЕВОЕ СОЕДИНЕНИЕ ОборотыСклад_ВидыНоменклатуры КАК ОборотыНарастающие
		|		ПО (ВЫБОР
		|				КОГДА ТаблицаПартнеры.Дата = КОНЕЦПЕРИОДА(&НачалоПериода, ДЕНЬ)
		|					ТОГДА ТаблицаПартнеры.Дата = КОНЕЦПЕРИОДА(ОборотыНарастающие.Период, ДЕНЬ)
		|				КОГДА ТаблицаПартнеры.Дата = &КонецПериода
		|					ТОГДА ОборотыНарастающие.Период = НАЧАЛОПЕРИОДА(&КонецПериода, ДЕНЬ)
		|				ИНАЧЕ ДОБАВИТЬКДАТЕ(ТаблицаПартнеры.Дата, СЕКУНДА, 1) = ОборотыНарастающие.Период
		|			КОНЕЦ)
		|			И ТаблицаПартнеры.ВидНоменклатуры = ОборотыНарастающие.ВидНоменклатуры
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	РасчетыСКлиентамиОстаткиИОбороты.АналитикаУчетаПоПартнерам.Партнер КАК Партнер,
		|	РасчетыСКлиентамиОстаткиИОбороты.Валюта КАК Валюта,
		|	РасчетыСКлиентамиОстаткиИОбороты.СуммаКонечныйОстаток КАК Долг,
		|	РасчетыСКлиентамиОстаткиИОбороты.Период КАК Период
		|ПОМЕСТИТЬ КешДебиторка
		|ИЗ
		|	РегистрНакопления.РасчетыСКлиентами.ОстаткиИОбороты(&ГраницаНачалоПериода, &ГраницаКонецПериода, День, , АналитикаУчетаПоПартнерам.Партнер <> ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)) КАК РасчетыСКлиентамиОстаткиИОбороты
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаПоПартнерам КАК РегистрАналитикаУчетаПоПартнерам
		|		ПО РасчетыСКлиентамиОстаткиИОбороты.АналитикаУчетаПоПартнерам = РегистрАналитикаУчетаПоПартнерам.КлючАналитики
		|ГДЕ
		|	РасчетыСКлиентамиОстаткиИОбороты.СуммаКонечныйОстаток > 0
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	РегистрАналитикаУчетаПоПартнерам.Партнер,
		|	РасчетыСПоставщикамиОстаткиИОбороты.Валюта,
		|	РасчетыСПоставщикамиОстаткиИОбороты.СуммаКонечныйОстаток,
		|	РасчетыСПоставщикамиОстаткиИОбороты.Период
		|ИЗ
		|	РегистрНакопления.РасчетыСПоставщиками.ОстаткиИОбороты(&ГраницаНачалоПериода, &ГраницаКонецПериода, День, , АналитикаУчетаПоПартнерам.Партнер <> ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)) КАК РасчетыСПоставщикамиОстаткиИОбороты
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаПоПартнерам КАК РегистрАналитикаУчетаПоПартнерам
		|		ПО РасчетыСПоставщикамиОстаткиИОбороты.АналитикаУчетаПоПартнерам = РегистрАналитикаУчетаПоПартнерам.КлючАналитики
		|ГДЕ
		|	РасчетыСПоставщикамиОстаткиИОбороты.СуммаКонечныйОстаток > 0
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Партнер,
		|	Валюта,
		|	Период
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	РасчетыСКлиентамиОстаткиИОбороты.АналитикаУчетаПоПартнерам.Партнер КАК Партнер,
		|	РасчетыСКлиентамиОстаткиИОбороты.Валюта КАК Валюта,
		|	-РасчетыСКлиентамиОстаткиИОбороты.СуммаКонечныйОстаток КАК Долг,
		|	РасчетыСКлиентамиОстаткиИОбороты.Период КАК Период
		|ПОМЕСТИТЬ КешКредиторка
		|ИЗ
		|	РегистрНакопления.РасчетыСКлиентами.ОстаткиИОбороты(&ГраницаНачалоПериода, &ГраницаКонецПериода, День, , АналитикаУчетаПоПартнерам.Партнер <> ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)) КАК РасчетыСКлиентамиОстаткиИОбороты
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаПоПартнерам КАК РегистрАналитикаУчетаПоПартнерам
		|		ПО РасчетыСКлиентамиОстаткиИОбороты.АналитикаУчетаПоПартнерам = РегистрАналитикаУчетаПоПартнерам.КлючАналитики
		|ГДЕ
		|	РасчетыСКлиентамиОстаткиИОбороты.СуммаКонечныйОстаток <= 0
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	РегистрАналитикаУчетаПоПартнерам.Партнер,
		|	РасчетыСПоставщикамиОстаткиИОбороты.Валюта,
		|	-РасчетыСПоставщикамиОстаткиИОбороты.СуммаКонечныйОстаток,
		|	РасчетыСПоставщикамиОстаткиИОбороты.Период
		|ИЗ
		|	РегистрНакопления.РасчетыСПоставщиками.ОстаткиИОбороты(&ГраницаНачалоПериода, &ГраницаКонецПериода, День, , АналитикаУчетаПоПартнерам.Партнер <> ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)) КАК РасчетыСПоставщикамиОстаткиИОбороты
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаПоПартнерам КАК РегистрАналитикаУчетаПоПартнерам
		|		ПО РасчетыСПоставщикамиОстаткиИОбороты.АналитикаУчетаПоПартнерам = РегистрАналитикаУчетаПоПартнерам.КлючАналитики
		|ГДЕ
		|	РасчетыСПоставщикамиОстаткиИОбороты.СуммаКонечныйОстаток <= 0
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Партнер,
		|	Валюта,
		|	Период
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	КешДебиторка.Период КАК Период,
		|	КешДебиторка.Партнер КАК Партнер,
		|	КешДебиторка.Валюта КАК Валюта,
		|	СУММА(КешДебиторка.Долг) КАК Долг
		|ПОМЕСТИТЬ Дебиторка
		|ИЗ
		|	КешДебиторка КАК КешДебиторка
		|
		|СГРУППИРОВАТЬ ПО
		|	КешДебиторка.Партнер,
		|	КешДебиторка.Валюта,
		|	КешДебиторка.Период
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Период,
		|	Партнер,
		|	Валюта
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	КешКредиторка.Период КАК Период,
		|	КешКредиторка.Партнер КАК Партнер,
		|	КешКредиторка.Валюта КАК Валюта,
		|	СУММА(КешКредиторка.Долг) КАК Долг
		|ПОМЕСТИТЬ Кредиторка
		|ИЗ
		|	КешКредиторка КАК КешКредиторка
		|
		|СГРУППИРОВАТЬ ПО
		|	КешКредиторка.Партнер,
		|	КешКредиторка.Валюта,
		|	КешКредиторка.Период
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Период,
		|	Партнер,
		|	Валюта
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	Дебиторка.Период КАК ДатаНачало,
		|	МИНИМУМ(ЕСТЬNULL(ДебиторкаКопия.Период, ДАТАВРЕМЯ(3999, 1, 1))) КАК ДатаОкончания,
		|	Дебиторка.Партнер КАК Партнер,
		|	Дебиторка.Валюта КАК Валюта,
		|	Дебиторка.Долг
		|ПОМЕСТИТЬ ДебиторкаНаростающие
		|ИЗ
		|	Дебиторка КАК Дебиторка
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Дебиторка КАК ДебиторкаКопия
		|		ПО Дебиторка.Партнер = ДебиторкаКопия.Партнер
		|			И Дебиторка.Валюта = ДебиторкаКопия.Валюта
		|			И Дебиторка.Период < ДебиторкаКопия.Период
		|
		|СГРУППИРОВАТЬ ПО
		|	Дебиторка.Период,
		|	Дебиторка.Партнер,
		|	Дебиторка.Валюта,
		|	Дебиторка.Долг
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Партнер,
		|	Валюта
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	Кредиторка.Период КАК НачалоПериода,
		|	МИНИМУМ(ЕСТЬNULL(КредиторкаКопия.Период, ДАТАВРЕМЯ(3999, 1, 1))) КАК ДатаОкончания,
		|	Кредиторка.Партнер КАК Партнер,
		|	Кредиторка.Валюта КАК Валюта,
		|	Кредиторка.Долг
		|ПОМЕСТИТЬ КредиторкаНаростающие
		|ИЗ
		|	Кредиторка КАК Кредиторка
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Кредиторка КАК КредиторкаКопия
		|		ПО Кредиторка.Партнер = КредиторкаКопия.Партнер
		|			И Кредиторка.Валюта = КредиторкаКопия.Валюта
		|			И Кредиторка.Период < КредиторкаКопия.Период
		|
		|СГРУППИРОВАТЬ ПО
		|	Кредиторка.Период,
		|	Кредиторка.Партнер,
		|	Кредиторка.Валюта,
		|	Кредиторка.Долг
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Партнер,
		|	Валюта
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	РасчетыСКлиентамиОстаткиИОбороты.АналитикаУчетаПоПартнерам.Партнер КАК Партнер,
		|	РасчетыСКлиентамиОстаткиИОбороты.Валюта КАК Валюта
		|ПОМЕСТИТЬ СписокПартнераСВалютами
		|ИЗ
		|	РегистрНакопления.РасчетыСКлиентами.ОстаткиИОбороты(&ГраницаНачалоПериода, &ГраницаКонецПериода, , , АналитикаУчетаПоПартнерам.Партнер <> ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)) КАК РасчетыСКлиентамиОстаткиИОбороты
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаПоПартнерам КАК РегистрАналитикаУчетаПоПартнерам
		|		ПО РасчетыСКлиентамиОстаткиИОбороты.АналитикаУчетаПоПартнерам = РегистрАналитикаУчетаПоПартнерам.КлючАналитики
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	РегистрАналитикаУчетаПоПартнерам.Партнер,
		|	РасчетыСПоставщикамиОстаткиИОбороты.Валюта
		|ИЗ
		|	РегистрНакопления.РасчетыСПоставщиками.ОстаткиИОбороты(&ГраницаНачалоПериода, &ГраницаКонецПериода, , , АналитикаУчетаПоПартнерам.Партнер <> ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)) КАК РасчетыСПоставщикамиОстаткиИОбороты
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаПоПартнерам КАК РегистрАналитикаУчетаПоПартнерам
		|		ПО РасчетыСПоставщикамиОстаткиИОбороты.АналитикаУчетаПоПартнерам = РегистрАналитикаУчетаПоПартнерам.КлючАналитики
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	НаростающийКалендарь.НачалоПериода,
		|	НаростающийКалендарь.КонецПериода,
		|	СписокПартнераСВалютами.Партнер,
		|	СписокПартнераСВалютами.Валюта
		|ПОМЕСТИТЬ БазовыйСписокПартнераСВалютой
		|ИЗ
		|	НаростающийКалендарь КАК НаростающийКалендарь
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ СписокПартнераСВалютами КАК СписокПартнераСВалютами
		|		ПО (ИСТИНА)
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	БазовыйСписокПартнераСВалютой.НачалоПериода,
		|	БазовыйСписокПартнераСВалютой.КонецПериода,
		|	БазовыйСписокПартнераСВалютой.Партнер КАК Партнер,
		|	БазовыйСписокПартнераСВалютой.Валюта КАК Валюта,
		|	МАКСИМУМ(ЕСТЬNULL(ДебиторкаНаростающие.ДатаНачало, НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ))) КАК ПериодПрисоединения
		|ПОМЕСТИТЬ КешДебиторкаКалендарь
		|ИЗ
		|	БазовыйСписокПартнераСВалютой КАК БазовыйСписокПартнераСВалютой
		|		ЛЕВОЕ СОЕДИНЕНИЕ ДебиторкаНаростающие КАК ДебиторкаНаростающие
		|		ПО БазовыйСписокПартнераСВалютой.Партнер = ДебиторкаНаростающие.Партнер
		|			И БазовыйСписокПартнераСВалютой.Валюта = ДебиторкаНаростающие.Валюта
		|			И БазовыйСписокПартнераСВалютой.КонецПериода >= ДебиторкаНаростающие.ДатаНачало
		|
		|СГРУППИРОВАТЬ ПО
		|	БазовыйСписокПартнераСВалютой.НачалоПериода,
		|	БазовыйСписокПартнераСВалютой.Партнер,
		|	БазовыйСписокПартнераСВалютой.КонецПериода,
		|	БазовыйСписокПартнераСВалютой.Валюта
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Партнер,
		|	Валюта,
		|	ПериодПрисоединения
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	БазовыйСписокПартнераСВалютой.НачалоПериода,
		|	БазовыйСписокПартнераСВалютой.КонецПериода,
		|	БазовыйСписокПартнераСВалютой.Партнер КАК Партнер,
		|	БазовыйСписокПартнераСВалютой.Валюта КАК Валюта,
		|	МАКСИМУМ(ЕСТЬNULL(КредиторкаНаростающие.НачалоПериода, НАЧАЛОПЕРИОДА(&НачалоПериода, ДЕНЬ))) КАК ПериодПрисоединения
		|ПОМЕСТИТЬ КешКредиторкаКалендарь
		|ИЗ
		|	БазовыйСписокПартнераСВалютой КАК БазовыйСписокПартнераСВалютой
		|		ЛЕВОЕ СОЕДИНЕНИЕ КредиторкаНаростающие КАК КредиторкаНаростающие
		|		ПО БазовыйСписокПартнераСВалютой.Партнер = КредиторкаНаростающие.Партнер
		|			И БазовыйСписокПартнераСВалютой.Валюта = КредиторкаНаростающие.Валюта
		|			И БазовыйСписокПартнераСВалютой.КонецПериода >= КредиторкаНаростающие.НачалоПериода
		|
		|СГРУППИРОВАТЬ ПО
		|	БазовыйСписокПартнераСВалютой.НачалоПериода,
		|	БазовыйСписокПартнераСВалютой.Партнер,
		|	БазовыйСписокПартнераСВалютой.КонецПериода,
		|	БазовыйСписокПартнераСВалютой.Валюта
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Партнер,
		|	Валюта,
		|	ПериодПрисоединения
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	КешДебиторкаКалендарь.НачалоПериода,
		|	КешДебиторкаКалендарь.КонецПериода,
		|	КешДебиторкаКалендарь.Партнер КАК Партнер,
		|	КешДебиторкаКалендарь.Валюта КАК Валюта,
		|	КешДебиторкаКалендарь.ПериодПрисоединения КАК ПериодПрисоединения,
		|	ЕСТЬNULL(ДебиторкаНаростающие.Долг, 0) КАК Дебит
		|ПОМЕСТИТЬ КешДебитОборот
		|ИЗ
		|	КешДебиторкаКалендарь КАК КешДебиторкаКалендарь
		|		ЛЕВОЕ СОЕДИНЕНИЕ ДебиторкаНаростающие КАК ДебиторкаНаростающие
		|		ПО КешДебиторкаКалендарь.Партнер = ДебиторкаНаростающие.Партнер
		|			И КешДебиторкаКалендарь.Валюта = ДебиторкаНаростающие.Валюта
		|			И КешДебиторкаКалендарь.ПериодПрисоединения = ДебиторкаНаростающие.ДатаНачало
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Партнер,
		|	Валюта,
		|	ПериодПрисоединения
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	КешКредиторкаКалендарь.НачалоПериода,
		|	КешКредиторкаКалендарь.КонецПериода,
		|	КешКредиторкаКалендарь.Партнер КАК Партнер,
		|	КешКредиторкаКалендарь.Валюта КАК Валюта,
		|	КешКредиторкаКалендарь.ПериодПрисоединения КАК ПериодПрисоединения,
		|	ЕСТЬNULL(КредиторкаНаростающие.Долг, 0) КАК Кредит
		|ПОМЕСТИТЬ КешКредитОборот
		|ИЗ
		|	КешКредиторкаКалендарь КАК КешКредиторкаКалендарь
		|		ЛЕВОЕ СОЕДИНЕНИЕ КредиторкаНаростающие КАК КредиторкаНаростающие
		|		ПО КешКредиторкаКалендарь.Партнер = КредиторкаНаростающие.Партнер
		|			И КешКредиторкаКалендарь.Валюта = КредиторкаНаростающие.Валюта
		|			И КешКредиторкаКалендарь.ПериодПрисоединения = КредиторкаНаростающие.НачалоПериода
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Партнер,
		|	Валюта,
		|	ПериодПрисоединения
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	КешДебитОборот.НачалоПериода,
		|	КешДебитОборот.КонецПериода,
		|	КешДебитОборот.Партнер КАК Партнер,
		|	КешДебитОборот.Валюта КАК Валюта,
		|	КешДебитОборот.Дебит - КешКредитОборот.Кредит КАК СуммаОстаток
		|ПОМЕСТИТЬ КешСуммаРасчета
		|ИЗ
		|	КешДебитОборот КАК КешДебитОборот
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ КешКредитОборот КАК КешКредитОборот
		|		ПО КешДебитОборот.Партнер = КешКредитОборот.Партнер
		|			И КешДебитОборот.Валюта = КешКредитОборот.Валюта
		|			И КешДебитОборот.НачалоПериода = КешКредитОборот.НачалоПериода
		|			И КешДебитОборот.КонецПериода = КешКредитОборот.КонецПериода
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Партнер,
		|	Валюта
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	КешСуммаРасчета.НачалоПериода,
		|	КешСуммаРасчета.КонецПериода,
		|	КешСуммаРасчета.Партнер КАК Партнер,
		|	СУММА(КешСуммаРасчета.СуммаОстаток * КешКурсов.Курс / КешУпрКурсов.Курс) КАК Сумма
		|ПОМЕСТИТЬ ОсновнойПоРасчетам
		|ИЗ
		|	КешСуммаРасчета КАК КешСуммаРасчета
		|		ЛЕВОЕ СОЕДИНЕНИЕ КешКурсов КАК КешКурсов
		|		ПО КешСуммаРасчета.Валюта = КешКурсов.Валюта
		|			И КешСуммаРасчета.КонецПериода = КешКурсов.КонецПериода
		|		ЛЕВОЕ СОЕДИНЕНИЕ КешКурсов КАК КешУпрКурсов
		|		ПО КешСуммаРасчета.КонецПериода = КешУпрКурсов.КонецПериода
		|ГДЕ
		|	КешУпрКурсов.Валюта = &ВалютаУправленческогоУчета
		|
		|СГРУППИРОВАТЬ ПО
		|	КешСуммаРасчета.НачалоПериода,
		|	КешСуммаРасчета.КонецПериода,
		|	КешСуммаРасчета.Партнер
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Партнер
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ОсновнойПоРасчетам.НачалоПериода,
		|	ОсновнойПоРасчетам.КонецПериода КАК Дата,
		|	ОсновнойПоРасчетам.Партнер КАК Партнер,
		|	ВЫБОР
		|		КОГДА ОсновнойПоРасчетам.Сумма > 0
		|			ТОГДА ОсновнойПоРасчетам.Сумма
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК Сумма
		|ПОМЕСТИТЬ ОсновнойДт
		|ИЗ
		|	ОсновнойПоРасчетам КАК ОсновнойПоРасчетам
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Партнер
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ОсновнойПоРасчетам.НачалоПериода,
		|	ОсновнойПоРасчетам.КонецПериода КАК Дата,
		|	ОсновнойПоРасчетам.Партнер КАК Партнер,
		|	ВЫБОР
		|		КОГДА ОсновнойПоРасчетам.Сумма <= 0
		|			ТОГДА -ОсновнойПоРасчетам.Сумма
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК Сумма
		|ПОМЕСТИТЬ ОсновнойКт
		|ИЗ
		|	ОсновнойПоРасчетам КАК ОсновнойПоРасчетам
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Партнер
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	""""Выручка"""" КАК Раздел,
		|	""""Розница"""" КАК РазделыОтчета,
		|	ВЫБОР
		|		КОГДА НаростающийИтог.Дата = КОНЕЦПЕРИОДА(&НачалоПериода, ДЕНЬ)
		|			ТОГДА НаростающийИтог.Дата
		|		ИНАЧЕ ДОБАВИТЬКДАТЕ(НаростающийИтог.Дата, СЕКУНДА, 2)
		|	КОНЕЦ КАК Дата,
		|	1 КАК Порядок,
		|	НаростающийИтог.Сумма КАК Сумма,
		|	ВЫБОР
		|		КОГДА &ВидПериода = ЗНАЧЕНИЕ(Перечисление.ДоступныеПериодыОтчета.Неделя)
		|					И РАЗНОСТЬДАТ(НаростающийИтог.Дата, &КонецПериода, ДЕНЬ) >= 7
		|				ИЛИ &ВидПериода = ЗНАЧЕНИЕ(Перечисление.ДоступныеПериодыОтчета.Месяц)
		|					И РАЗНОСТЬДАТ(НаростающийИтог.Дата, &КонецПериода, МЕСЯЦ) >= РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), КОНЕЦПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), ДЕНЬ) + 1
		|			ТОГДА ЕСТЬNULL(НаростающийИтогКопия.Сумма - НаростающийИтог.Сумма, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК Изменение,
		|	НаростающийИтог.Организация КАК ПолеСтроки,
		|	0 КАК ПорядокРазделу
		|ИЗ
		|	КешВыручкаРозница КАК НаростающийИтог
		|		ЛЕВОЕ СОЕДИНЕНИЕ КешВыручкаРозница КАК НаростающийИтогКопия
		|		ПО НаростающийИтог.Дата < НаростающийИтогКопия.Дата
		|			И (ВЫБОР
		|				КОГДА &ВидПериода = ЗНАЧЕНИЕ(Перечисление.ДоступныеПериодыОтчета.Неделя)
		|					ТОГДА РАЗНОСТЬДАТ(НаростающийИтог.Дата, НаростающийИтогКопия.Дата, ДЕНЬ) <= РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(НаростающийИтог.Дата, НЕДЕЛЯ), КОНЕЦПЕРИОДА(НаростающийИтог.Дата, НЕДЕЛЯ), ДЕНЬ) + 1
		|				ИНАЧЕ РАЗНОСТЬДАТ(НаростающийИтог.Дата, НаростающийИтогКопия.Дата, ДЕНЬ) <= РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), КОНЕЦПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), ДЕНЬ) + 1
		|			КОНЕЦ)
		|			И НаростающийИтог.Организация = НаростающийИтогКопия.Организация
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	""""Выручка"""",
		|	""""Опт"""",
		|	ВЫБОР
		|		КОГДА НаростающийИтог.Дата = КОНЕЦПЕРИОДА(&НачалоПериода, ДЕНЬ)
		|			ТОГДА НаростающийИтог.Дата
		|		ИНАЧЕ ДОБАВИТЬКДАТЕ(НаростающийИтог.Дата, СЕКУНДА, 2)
		|	КОНЕЦ,
		|	2,
		|	НаростающийИтог.Сумма,
		|	ВЫБОР
		|		КОГДА &ВидПериода = ЗНАЧЕНИЕ(Перечисление.ДоступныеПериодыОтчета.Неделя)
		|					И РАЗНОСТЬДАТ(НаростающийИтог.Дата, &КонецПериода, ДЕНЬ) >= 7
		|				ИЛИ &ВидПериода = ЗНАЧЕНИЕ(Перечисление.ДоступныеПериодыОтчета.Месяц)
		|					И РАЗНОСТЬДАТ(НаростающийИтог.Дата, &КонецПериода, МЕСЯЦ) >= РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), КОНЕЦПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), ДЕНЬ) + 1
		|			ТОГДА ЕСТЬNULL(НаростающийИтогКопия.Сумма - НаростающийИтог.Сумма, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	НаростающийИтог.Организация,
		|	0
		|ИЗ
		|	КешВыручкаОпт КАК НаростающийИтог
		|		ЛЕВОЕ СОЕДИНЕНИЕ КешВыручкаОпт КАК НаростающийИтогКопия
		|		ПО НаростающийИтог.Дата < НаростающийИтогКопия.Дата
		|			И (ВЫБОР
		|				КОГДА &ВидПериода = ЗНАЧЕНИЕ(Перечисление.ДоступныеПериодыОтчета.Неделя)
		|					ТОГДА РАЗНОСТЬДАТ(НаростающийИтог.Дата, НаростающийИтогКопия.Дата, ДЕНЬ) <= РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(НаростающийИтог.Дата, НЕДЕЛЯ), КОНЕЦПЕРИОДА(НаростающийИтог.Дата, НЕДЕЛЯ), ДЕНЬ) + 1
		|				ИНАЧЕ РАЗНОСТЬДАТ(НаростающийИтог.Дата, НаростающийИтогКопия.Дата, ДЕНЬ) <= РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), КОНЕЦПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), ДЕНЬ) + 1
		|			КОНЕЦ)
		|			И НаростающийИтог.Организация = НаростающийИтогКопия.Организация
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	""""Стоимость склада (на начало периода)"""",
		|	""""Склады"""",
		|	ВЫБОР
		|		КОГДА СписокСтоимостьСклада.Дата = КОНЕЦПЕРИОДА(&НачалоПериода, ДЕНЬ)
		|			ТОГДА СписокСтоимостьСклада.Дата
		|		ИНАЧЕ ДОБАВИТЬКДАТЕ(СписокСтоимостьСклада.Дата, СЕКУНДА, 2)
		|	КОНЕЦ,
		|	4,
		|	СписокСтоимостьСклада.Сумма,
		|	ЕСТЬNULL(СписокСтоимостьСклада1.Сумма - СписокСтоимостьСклада.Сумма, 0),
		|	СписокСтоимостьСклада.Склад,
		|	1
		|ИЗ
		|	СписокСтоимостьСклада КАК СписокСтоимостьСклада
		|		ЛЕВОЕ СОЕДИНЕНИЕ СписокСтоимостьСклада КАК СписокСтоимостьСклада1
		|		ПО СписокСтоимостьСклада.Дата < СписокСтоимостьСклада1.Дата
		|			И (ВЫБОР
		|				КОГДА &ВидПериода = ЗНАЧЕНИЕ(Перечисление.ДоступныеПериодыОтчета.Неделя)
		|					ТОГДА РАЗНОСТЬДАТ(СписокСтоимостьСклада.Дата, СписокСтоимостьСклада1.Дата, ДЕНЬ) <= РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(СписокСтоимостьСклада.Дата, НЕДЕЛЯ), КОНЕЦПЕРИОДА(СписокСтоимостьСклада.Дата, НЕДЕЛЯ), ДЕНЬ) + 1
		|				ИНАЧЕ РАЗНОСТЬДАТ(СписокСтоимостьСклада.Дата, СписокСтоимостьСклада1.Дата, ДЕНЬ) <= РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(СписокСтоимостьСклада.Дата, МЕСЯЦ), КОНЕЦПЕРИОДА(СписокСтоимостьСклада.Дата, МЕСЯЦ), ДЕНЬ) + 1
		|			КОНЕЦ)
		|			И СписокСтоимостьСклада.Склад = СписокСтоимостьСклада1.Склад
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	""""Стоимость склада (на начало периода)"""",
		|	""""Виды номенклатуры"""",
		|	ВЫБОР
		|		КОГДА НаростающийИтог.Дата = КОНЕЦПЕРИОДА(&НачалоПериода, ДЕНЬ)
		|			ТОГДА НаростающийИтог.Дата
		|		ИНАЧЕ ДОБАВИТЬКДАТЕ(НаростающийИтог.Дата, СЕКУНДА, 2)
		|	КОНЕЦ,
		|	5,
		|	НаростающийИтог.Сумма,
		|	ЕСТЬNULL(НаростающийИтогКопия.Сумма - НаростающийИтог.Сумма, 0),
		|	НаростающийИтог.ВидНоменклатуры,
		|	1
		|ИЗ
		|	СписокСтоимостьСклада_ВидыНоменклатуры КАК НаростающийИтог
		|		ЛЕВОЕ СОЕДИНЕНИЕ СписокСтоимостьСклада_ВидыНоменклатуры КАК НаростающийИтогКопия
		|		ПО НаростающийИтог.Дата < НаростающийИтогКопия.Дата
		|			И (ВЫБОР
		|				КОГДА &ВидПериода = ЗНАЧЕНИЕ(Перечисление.ДоступныеПериодыОтчета.Неделя)
		|					ТОГДА РАЗНОСТЬДАТ(НаростающийИтог.Дата, НаростающийИтогКопия.Дата, ДЕНЬ) <= РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(НаростающийИтог.Дата, НЕДЕЛЯ), КОНЕЦПЕРИОДА(НаростающийИтог.Дата, НЕДЕЛЯ), ДЕНЬ) + 1
		|				ИНАЧЕ РАЗНОСТЬДАТ(НаростающийИтог.Дата, НаростающийИтогКопия.Дата, ДЕНЬ) <= РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), КОНЕЦПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), ДЕНЬ) + 1
		|			КОНЕЦ)
		|			И НаростающийИтог.ВидНоменклатуры = НаростающийИтогКопия.ВидНоменклатуры
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	""""Закупки (себестоимость)"""",
		|	""""Виды Номенклатуры"""",
		|	ВЫБОР
		|		КОГДА НаростающийИтог.Дата = КОНЕЦПЕРИОДА(&НачалоПериода, ДЕНЬ)
		|			ТОГДА НаростающийИтог.Дата
		|		ИНАЧЕ ДОБАВИТЬКДАТЕ(НаростающийИтог.Дата, СЕКУНДА, 2)
		|	КОНЕЦ,
		|	6,
		|	НаростающийИтог.Сумма,
		|	ВЫБОР
		|		КОГДА &ВидПериода = ЗНАЧЕНИЕ(Перечисление.ДоступныеПериодыОтчета.Неделя)
		|					И РАЗНОСТЬДАТ(НаростающийИтог.Дата, &КонецПериода, ДЕНЬ) >= 7
		|				ИЛИ &ВидПериода = ЗНАЧЕНИЕ(Перечисление.ДоступныеПериодыОтчета.Месяц)
		|					И РАЗНОСТЬДАТ(НаростающийИтог.Дата, &КонецПериода, МЕСЯЦ) >= РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), КОНЕЦПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), ДЕНЬ) + 1
		|			ТОГДА ЕСТЬNULL(НаростающийИтогКопия.Сумма - НаростающийИтог.Сумма, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	НаростающийИтог.ВидНоменклатуры,
		|	2
		|ИЗ
		|	КешЗакупкиВидНоменклатуры КАК НаростающийИтог
		|		ЛЕВОЕ СОЕДИНЕНИЕ КешЗакупкиВидНоменклатуры КАК НаростающийИтогКопия
		|		ПО НаростающийИтог.Дата < НаростающийИтогКопия.Дата
		|			И (ВЫБОР
		|				КОГДА &ВидПериода = ЗНАЧЕНИЕ(Перечисление.ДоступныеПериодыОтчета.Неделя)
		|					ТОГДА РАЗНОСТЬДАТ(НаростающийИтог.Дата, НаростающийИтогКопия.Дата, ДЕНЬ) <= РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(НаростающийИтог.Дата, НЕДЕЛЯ), КОНЕЦПЕРИОДА(НаростающийИтог.Дата, НЕДЕЛЯ), ДЕНЬ) + 1
		|				ИНАЧЕ РАЗНОСТЬДАТ(НаростающийИтог.Дата, НаростающийИтогКопия.Дата, ДЕНЬ) <= РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), КОНЕЦПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), ДЕНЬ) + 1
		|			КОНЕЦ)
		|			И НаростающийИтог.ВидНоменклатуры = НаростающийИтогКопия.ВидНоменклатуры
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	""""Закупки (себестоимость)"""",
		|	""""Партнеры"""",
		|	ВЫБОР
		|		КОГДА НаростающийИтог.Дата = КОНЕЦПЕРИОДА(&НачалоПериода, ДЕНЬ)
		|			ТОГДА НаростающийИтог.Дата
		|		ИНАЧЕ ДОБАВИТЬКДАТЕ(НаростающийИтог.Дата, СЕКУНДА, 2)
		|	КОНЕЦ,
		|	7,
		|	НаростающийИтог.Сумма,
		|	ВЫБОР
		|		КОГДА &ВидПериода = ЗНАЧЕНИЕ(Перечисление.ДоступныеПериодыОтчета.Неделя)
		|					И РАЗНОСТЬДАТ(НаростающийИтог.Дата, &КонецПериода, ДЕНЬ) >= 7
		|				ИЛИ &ВидПериода = ЗНАЧЕНИЕ(Перечисление.ДоступныеПериодыОтчета.Месяц)
		|					И РАЗНОСТЬДАТ(НаростающийИтог.Дата, &КонецПериода, МЕСЯЦ) >= РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), КОНЕЦПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), ДЕНЬ) + 1
		|			ТОГДА ЕСТЬNULL(НаростающийИтогКопия.Сумма - НаростающийИтог.Сумма, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	НаростающийИтог.Партнер,
		|	2
		|ИЗ
		|	КешЗакупкиПартнеры КАК НаростающийИтог
		|		ЛЕВОЕ СОЕДИНЕНИЕ КешЗакупкиПартнеры КАК НаростающийИтогКопия
		|		ПО НаростающийИтог.Дата < НаростающийИтогКопия.Дата
		|			И (ВЫБОР
		|				КОГДА &ВидПериода = ЗНАЧЕНИЕ(Перечисление.ДоступныеПериодыОтчета.Неделя)
		|					ТОГДА РАЗНОСТЬДАТ(НаростающийИтог.Дата, НаростающийИтогКопия.Дата, ДЕНЬ) <= РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(НаростающийИтог.Дата, НЕДЕЛЯ), КОНЕЦПЕРИОДА(НаростающийИтог.Дата, НЕДЕЛЯ), ДЕНЬ) + 1
		|				ИНАЧЕ РАЗНОСТЬДАТ(НаростающийИтог.Дата, НаростающийИтогКопия.Дата, ДЕНЬ) <= РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), КОНЕЦПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), ДЕНЬ) + 1
		|			КОНЕЦ)
		|			И НаростающийИтог.Партнер = НаростающийИтогКопия.Партнер
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	""""Продажи (себестоимость)"""",
		|	""""Виды Номенклатуры"""",
		|	ВЫБОР
		|		КОГДА НаростающийИтог.Дата = КОНЕЦПЕРИОДА(&НачалоПериода, ДЕНЬ)
		|			ТОГДА НаростающийИтог.Дата
		|		ИНАЧЕ ДОБАВИТЬКДАТЕ(НаростающийИтог.Дата, СЕКУНДА, 2)
		|	КОНЕЦ,
		|	8,
		|	НаростающийИтог.Сумма,
		|	ВЫБОР
		|		КОГДА &ВидПериода = ЗНАЧЕНИЕ(Перечисление.ДоступныеПериодыОтчета.Неделя)
		|					И РАЗНОСТЬДАТ(НаростающийИтог.Дата, &КонецПериода, ДЕНЬ) >= 7
		|				ИЛИ &ВидПериода = ЗНАЧЕНИЕ(Перечисление.ДоступныеПериодыОтчета.Месяц)
		|					И РАЗНОСТЬДАТ(НаростающийИтог.Дата, &КонецПериода, МЕСЯЦ) >= РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), КОНЕЦПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), ДЕНЬ) + 1
		|			ТОГДА ЕСТЬNULL(НаростающийИтогКопия.Сумма - НаростающийИтог.Сумма, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	НаростающийИтог.ВидНоменклатуры,
		|	3
		|ИЗ
		|	КешПродажиВидНоменклатуры КАК НаростающийИтог
		|		ЛЕВОЕ СОЕДИНЕНИЕ КешПродажиВидНоменклатуры КАК НаростающийИтогКопия
		|		ПО НаростающийИтог.Дата < НаростающийИтогКопия.Дата
		|			И (ВЫБОР
		|				КОГДА &ВидПериода = ЗНАЧЕНИЕ(Перечисление.ДоступныеПериодыОтчета.Неделя)
		|					ТОГДА РАЗНОСТЬДАТ(НаростающийИтог.Дата, НаростающийИтогКопия.Дата, ДЕНЬ) <= РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(НаростающийИтог.Дата, НЕДЕЛЯ), КОНЕЦПЕРИОДА(НаростающийИтог.Дата, НЕДЕЛЯ), ДЕНЬ) + 1
		|				ИНАЧЕ РАЗНОСТЬДАТ(НаростающийИтог.Дата, НаростающийИтогКопия.Дата, ДЕНЬ) <= РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), КОНЕЦПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), ДЕНЬ) + 1
		|			КОНЕЦ)
		|			И НаростающийИтог.ВидНоменклатуры = НаростающийИтогКопия.ВидНоменклатуры
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	""""Продажи (себестоимость)"""",
		|	""""Организации"""",
		|	ВЫБОР
		|		КОГДА НаростающийИтог.Дата = КОНЕЦПЕРИОДА(&НачалоПериода, ДЕНЬ)
		|			ТОГДА НаростающийИтог.Дата
		|		ИНАЧЕ ДОБАВИТЬКДАТЕ(НаростающийИтог.Дата, СЕКУНДА, 2)
		|	КОНЕЦ,
		|	9,
		|	НаростающийИтог.Сумма,
		|	ВЫБОР
		|		КОГДА &ВидПериода = ЗНАЧЕНИЕ(Перечисление.ДоступныеПериодыОтчета.Неделя)
		|					И РАЗНОСТЬДАТ(НаростающийИтог.Дата, &КонецПериода, ДЕНЬ) >= 7
		|				ИЛИ &ВидПериода = ЗНАЧЕНИЕ(Перечисление.ДоступныеПериодыОтчета.Месяц)
		|					И РАЗНОСТЬДАТ(НаростающийИтог.Дата, &КонецПериода, МЕСЯЦ) >= РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), КОНЕЦПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), ДЕНЬ) + 1
		|			ТОГДА ЕСТЬNULL(НаростающийИтогКопия.Сумма - НаростающийИтог.Сумма, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	НаростающийИтог.Организация,
		|	3
		|ИЗ
		|	КешПродажиОрганизации КАК НаростающийИтог
		|		ЛЕВОЕ СОЕДИНЕНИЕ КешПродажиОрганизации КАК НаростающийИтогКопия
		|		ПО НаростающийИтог.Дата < НаростающийИтогКопия.Дата
		|			И (ВЫБОР
		|				КОГДА &ВидПериода = ЗНАЧЕНИЕ(Перечисление.ДоступныеПериодыОтчета.Неделя)
		|					ТОГДА РАЗНОСТЬДАТ(НаростающийИтог.Дата, НаростающийИтогКопия.Дата, ДЕНЬ) <= РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(НаростающийИтог.Дата, НЕДЕЛЯ), КОНЕЦПЕРИОДА(НаростающийИтог.Дата, НЕДЕЛЯ), ДЕНЬ) + 1
		|				ИНАЧЕ РАЗНОСТЬДАТ(НаростающийИтог.Дата, НаростающийИтогКопия.Дата, ДЕНЬ) <= РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), КОНЕЦПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), ДЕНЬ) + 1
		|			КОНЕЦ)
		|			И НаростающийИтог.Организация = НаростающийИтогКопия.Организация
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	""""Кредиторская задолженость (на начало периода)"""",
		|	""""Партнеры"""",
		|	ВЫБОР
		|		КОГДА НаростающийИтог.Дата = КОНЕЦПЕРИОДА(&НачалоПериода, ДЕНЬ)
		|			ТОГДА НаростающийИтог.Дата
		|		ИНАЧЕ ДОБАВИТЬКДАТЕ(НаростающийИтог.Дата, СЕКУНДА, 2)
		|	КОНЕЦ,
		|	10,
		|	НаростающийИтог.Сумма,
		|	ЕСТЬNULL(НаростающийИтогКопия.Сумма - НаростающийИтог.Сумма, 0),
		|	НаростающийИтог.Партнер,
		|	4
		|ИЗ
		|	ОсновнойКт КАК НаростающийИтог
		|		ЛЕВОЕ СОЕДИНЕНИЕ ОсновнойКт КАК НаростающийИтогКопия
		|		ПО НаростающийИтог.Дата < НаростающийИтогКопия.Дата
		|			И (ВЫБОР
		|				КОГДА &ВидПериода = ЗНАЧЕНИЕ(Перечисление.ДоступныеПериодыОтчета.Неделя)
		|					ТОГДА РАЗНОСТЬДАТ(НаростающийИтог.Дата, НаростающийИтогКопия.Дата, ДЕНЬ) <= РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(НаростающийИтог.Дата, НЕДЕЛЯ), КОНЕЦПЕРИОДА(НаростающийИтог.Дата, НЕДЕЛЯ), ДЕНЬ) + 1
		|				ИНАЧЕ РАЗНОСТЬДАТ(НаростающийИтог.Дата, НаростающийИтогКопия.Дата, ДЕНЬ) <= РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), КОНЕЦПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), ДЕНЬ) + 1
		|			КОНЕЦ)
		|			И НаростающийИтог.Партнер = НаростающийИтогКопия.Партнер
		|ГДЕ
		|	(НаростающийИтог.Сумма <> 0
		|			ИЛИ ЕСТЬNULL(НаростающийИтогКопия.Сумма - НаростающийИтог.Сумма, 0) <> 0)
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	""""Дебиторская задолженость (на начало периода)"""",
		|	""""Партнеры"""",
		|	ВЫБОР
		|		КОГДА НаростающийИтог.Дата = КОНЕЦПЕРИОДА(&НачалоПериода, ДЕНЬ)
		|			ТОГДА НаростающийИтог.Дата
		|		ИНАЧЕ ДОБАВИТЬКДАТЕ(НаростающийИтог.Дата, СЕКУНДА, 2)
		|	КОНЕЦ,
		|	11,
		|	НаростающийИтог.Сумма,
		|	ЕСТЬNULL(НаростающийИтогКопия.Сумма - НаростающийИтог.Сумма, 0),
		|	НаростающийИтог.Партнер,
		|	5
		|ИЗ
		|	ОсновнойДт КАК НаростающийИтог
		|		ЛЕВОЕ СОЕДИНЕНИЕ ОсновнойДт КАК НаростающийИтогКопия
		|		ПО НаростающийИтог.Дата < НаростающийИтогКопия.Дата
		|			И (ВЫБОР
		|				КОГДА &ВидПериода = ЗНАЧЕНИЕ(Перечисление.ДоступныеПериодыОтчета.Неделя)
		|					ТОГДА РАЗНОСТЬДАТ(НаростающийИтог.Дата, НаростающийИтогКопия.Дата, ДЕНЬ) <= РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(НаростающийИтог.Дата, НЕДЕЛЯ), КОНЕЦПЕРИОДА(НаростающийИтог.Дата, НЕДЕЛЯ), ДЕНЬ) + 1
		|				ИНАЧЕ РАЗНОСТЬДАТ(НаростающийИтог.Дата, НаростающийИтогКопия.Дата, ДЕНЬ) <= РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), КОНЕЦПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), ДЕНЬ) + 1
		|			КОНЕЦ)
		|			И НаростающийИтог.Партнер = НаростающийИтогКопия.Партнер
		|ГДЕ
		|	(НаростающийИтог.Сумма <> 0
		|			ИЛИ ЕСТЬNULL(НаростающийИтогКопия.Сумма - НаростающийИтог.Сумма, 0) <> 0)
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	""""Остатки денег (на начало периода)"""",
		|	""""Наличные"""",
		|	ВЫБОР
		|		КОГДА НаростающийИтог.Дата = КОНЕЦПЕРИОДА(&НачалоПериода, ДЕНЬ)
		|			ТОГДА НаростающийИтог.Дата
		|		ИНАЧЕ ДОБАВИТЬКДАТЕ(НаростающийИтог.Дата, СЕКУНДА, 2)
		|	КОНЕЦ,
		|	12,
		|	НаростающийИтог.Сумма,
		|	ЕСТЬNULL(НаростающийИтогКопия.Сумма - НаростающийИтог.Сумма, 0),
		|	НаростающийИтог.Касса,
		|	6
		|ИЗ
		|	ОсновнойКешКасса КАК НаростающийИтог
		|		ЛЕВОЕ СОЕДИНЕНИЕ ОсновнойКешКасса КАК НаростающийИтогКопия
		|		ПО НаростающийИтог.Дата < НаростающийИтогКопия.Дата
		|			И (ВЫБОР
		|				КОГДА &ВидПериода = ЗНАЧЕНИЕ(Перечисление.ДоступныеПериодыОтчета.Неделя)
		|					ТОГДА РАЗНОСТЬДАТ(НаростающийИтог.Дата, НаростающийИтогКопия.Дата, ДЕНЬ) <= РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(НаростающийИтог.Дата, НЕДЕЛЯ), КОНЕЦПЕРИОДА(НаростающийИтог.Дата, НЕДЕЛЯ), ДЕНЬ) + 1
		|				ИНАЧЕ РАЗНОСТЬДАТ(НаростающийИтог.Дата, НаростающийИтогКопия.Дата, ДЕНЬ) <= РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), КОНЕЦПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), ДЕНЬ) + 1
		|			КОНЕЦ)
		|			И НаростающийИтог.Касса = НаростающийИтогКопия.Касса
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	""""Остатки денег (на начало периода)"""",
		|	""""Безналичные"""",
		|	ВЫБОР
		|		КОГДА НаростающийИтог.Дата = КОНЕЦПЕРИОДА(&НачалоПериода, ДЕНЬ)
		|			ТОГДА НаростающийИтог.Дата
		|		ИНАЧЕ ДОБАВИТЬКДАТЕ(НаростающийИтог.Дата, СЕКУНДА, 2)
		|	КОНЕЦ,
		|	13,
		|	НаростающийИтог.Сумма,
		|	ЕСТЬNULL(НаростающийИтогКопия.Сумма - НаростающийИтог.Сумма, 0),
		|	НаростающийИтог.Банк,
		|	6
		|ИЗ
		|	ОсновнойКешБанк КАК НаростающийИтог
		|		ЛЕВОЕ СОЕДИНЕНИЕ ОсновнойКешБанк КАК НаростающийИтогКопия
		|		ПО НаростающийИтог.Дата < НаростающийИтогКопия.Дата
		|			И (ВЫБОР
		|				КОГДА &ВидПериода = ЗНАЧЕНИЕ(Перечисление.ДоступныеПериодыОтчета.Неделя)
		|					ТОГДА РАЗНОСТЬДАТ(НаростающийИтог.Дата, НаростающийИтогКопия.Дата, ДЕНЬ) <= РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(НаростающийИтог.Дата, НЕДЕЛЯ), КОНЕЦПЕРИОДА(НаростающийИтог.Дата, НЕДЕЛЯ), ДЕНЬ) + 1
		|				ИНАЧЕ РАЗНОСТЬДАТ(НаростающийИтог.Дата, НаростающийИтогКопия.Дата, ДЕНЬ) <= РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), КОНЕЦПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), ДЕНЬ) + 1
		|			КОНЕЦ)
		|			И НаростающийИтог.Банк = НаростающийИтогКопия.Банк
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	""""Движение денег"""",
		|	""""Касса (приход)"""",
		|	ВЫБОР
		|		КОГДА НаростающийИтог.Дата = КОНЕЦПЕРИОДА(&НачалоПериода, ДЕНЬ)
		|			ТОГДА НаростающийИтог.Дата
		|		ИНАЧЕ ДОБАВИТЬКДАТЕ(НаростающийИтог.Дата, СЕКУНДА, 2)
		|	КОНЕЦ,
		|	14,
		|	НаростающийИтог.Сумма,
		|	ВЫБОР
		|		КОГДА &ВидПериода = ЗНАЧЕНИЕ(Перечисление.ДоступныеПериодыОтчета.Неделя)
		|					И РАЗНОСТЬДАТ(НаростающийИтог.Дата, &КонецПериода, ДЕНЬ) >= 7
		|				ИЛИ &ВидПериода = ЗНАЧЕНИЕ(Перечисление.ДоступныеПериодыОтчета.Месяц)
		|					И РАЗНОСТЬДАТ(НаростающийИтог.Дата, &КонецПериода, МЕСЯЦ) >= РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), КОНЕЦПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), ДЕНЬ) + 1
		|			ТОГДА ЕСТЬNULL(НаростающийИтогКопия.Сумма - НаростающийИтог.Сумма, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	НаростающийИтог.Касса,
		|	7
		|ИЗ
		|	КешКассаПриход КАК НаростающийИтог
		|		ЛЕВОЕ СОЕДИНЕНИЕ КешКассаПриход КАК НаростающийИтогКопия
		|		ПО НаростающийИтог.Дата < НаростающийИтогКопия.Дата
		|			И (ВЫБОР
		|				КОГДА &ВидПериода = ЗНАЧЕНИЕ(Перечисление.ДоступныеПериодыОтчета.Неделя)
		|					ТОГДА РАЗНОСТЬДАТ(НаростающийИтог.Дата, НаростающийИтогКопия.Дата, ДЕНЬ) <= РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(НаростающийИтог.Дата, НЕДЕЛЯ), КОНЕЦПЕРИОДА(НаростающийИтог.Дата, НЕДЕЛЯ), ДЕНЬ) + 1
		|				ИНАЧЕ РАЗНОСТЬДАТ(НаростающийИтог.Дата, НаростающийИтогКопия.Дата, ДЕНЬ) <= РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), КОНЕЦПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), ДЕНЬ) + 1
		|			КОНЕЦ)
		|			И НаростающийИтог.Касса = НаростающийИтогКопия.Касса
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	""""Движение денег"""",
		|	""""Касса (расход)"""",
		|	ВЫБОР
		|		КОГДА НаростающийИтог.Дата = КОНЕЦПЕРИОДА(&НачалоПериода, ДЕНЬ)
		|			ТОГДА НаростающийИтог.Дата
		|		ИНАЧЕ ДОБАВИТЬКДАТЕ(НаростающийИтог.Дата, СЕКУНДА, 2)
		|	КОНЕЦ,
		|	15,
		|	НаростающийИтог.Сумма,
		|	ВЫБОР
		|		КОГДА &ВидПериода = ЗНАЧЕНИЕ(Перечисление.ДоступныеПериодыОтчета.Неделя)
		|					И РАЗНОСТЬДАТ(НаростающийИтог.Дата, &КонецПериода, ДЕНЬ) >= 7
		|				ИЛИ &ВидПериода = ЗНАЧЕНИЕ(Перечисление.ДоступныеПериодыОтчета.Месяц)
		|					И РАЗНОСТЬДАТ(НаростающийИтог.Дата, &КонецПериода, МЕСЯЦ) >= РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), КОНЕЦПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), ДЕНЬ) + 1
		|			ТОГДА ЕСТЬNULL(НаростающийИтогКопия.Сумма - НаростающийИтог.Сумма, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	НаростающийИтог.Касса,
		|	7
		|ИЗ
		|	КешКассаРасход КАК НаростающийИтог
		|		ЛЕВОЕ СОЕДИНЕНИЕ КешКассаРасход КАК НаростающийИтогКопия
		|		ПО НаростающийИтог.Дата < НаростающийИтогКопия.Дата
		|			И (ВЫБОР
		|				КОГДА &ВидПериода = ЗНАЧЕНИЕ(Перечисление.ДоступныеПериодыОтчета.Неделя)
		|					ТОГДА РАЗНОСТЬДАТ(НаростающийИтог.Дата, НаростающийИтогКопия.Дата, ДЕНЬ) <= РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(НаростающийИтог.Дата, НЕДЕЛЯ), КОНЕЦПЕРИОДА(НаростающийИтог.Дата, НЕДЕЛЯ), ДЕНЬ) + 1
		|				ИНАЧЕ РАЗНОСТЬДАТ(НаростающийИтог.Дата, НаростающийИтогКопия.Дата, ДЕНЬ) <= РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), КОНЕЦПЕРИОДА(НаростающийИтог.Дата, МЕСЯЦ), ДЕНЬ) + 1
		|			КОНЕЦ)
		|			И НаростающийИтог.Касса = НаростающийИтогКопия.Касса"";		
		Возврат ТекстЗапроса;
		
			
КонецФункции

&НаСервере
Функция ПолучитьВидПериода()
	Возврат  Перечисления.ДоступныеПериодыОтчета.Неделя;
КонецФункции

",
{4,9,
{9,
{1},0,"Отчет",
{1,0},
{"Pattern",
{"#",cd0cb727-6c02-4e15-bbfd-4316e11d78b7}
},
{0,
{0,
{"B",1},0}
},
{0,
{0,
{"B",1},0}
},
{0,0},
{0,0},1,0,0,0,
{0,0},
{0,0}
},
{9,
{2},0,"НаименованиеТекущегоВарианта",
{1,1,
{"ru","Вариант отчета"}
},
{"Pattern",
{"S"}
},
{0,
{0,
{"B",1},0}
},
{0,
{0,
{"B",1},0}
},
{0,0},
{0,0},0,0,0,0,
{0,0},
{0,0}
},
{9,
{3},0,"Результат",
{1,1,
{"ru","Результат"}
},
{"Pattern",
{"#",e603103e-a318-4edc-a014-b1c6cf94d49f}
},
{0,
{0,
{"B",1},0}
},
{0,
{0,
{"B",1},0}
},
{0,0},
{0,0},0,0,0,0,
{0,0},
{0,0}
},
{9,
{4},0,"ДанныеРасшифровки",
{1,0},
{"Pattern",
{"S"}
},
{0,
{0,
{"B",1},0}
},
{0,
{0,
{"B",1},0}
},
{0,0},
{0,0},0,0,0,0,
{0,0},
{0,0}
},
{9,
{5},0,"ДатаНачала",
{1,1,
{"ru","Дата начала"}
},
{"Pattern",
{"D","D"}
},
{0,
{0,
{"B",1},0}
},
{0,
{0,
{"B",1},0}
},
{0,0},
{0,0},0,0,0,0,
{0,0},
{0,0}
},
{9,
{6},0,"ДатаОкончания",
{1,1,
{"ru","Дата окончания"}
},
{"Pattern",
{"D","D"}
},
{0,
{0,
{"B",1},0}
},
{0,
{0,
{"B",1},0}
},
{0,0},
{0,0},0,0,0,0,
{0,0},
{0,0}
},
{9,
{7},0,"ВидПериода",
{1,1,
{"ru","Вид периода"}
},
{"Pattern",
{"#",6a00a492-3e0f-4533-a8f1-00a8d8ba1b69}
},
{0,
{0,
{"B",1},0}
},
{0,
{0,
{"B",1},0}
},
{0,0},
{0,0},0,0,0,0,
{0,0},
{0,0}
},
{9,
{8},0,"ДокументРезультат",
{1,1,
{"ru","Документ результат"}
},
{"Pattern",
{"#",e603103e-a318-4edc-a014-b1c6cf94d49f}
},
{0,
{0,
{"B",1},0}
},
{0,
{0,
{"B",1},0}
},
{0,0},
{0,0},0,0,0,0,
{0,0},
{0,0}
},
{9,
{10},0,"Период",
{1,1,
{"ru","Период"}
},
{"Pattern",
{"#",2fdc88ec-7c9b-43cd-8ba5-873f043bdd88}
},
{0,
{0,
{"B",1},0}
},
{0,
{0,
{"B",1},0}
},
{0,0},
{0,0},0,0,0,0,
{0,0},
{0,0}
},0,0,
{#base64:77u/PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxTZXR0
aW5ncyB4bWxucz0iaHR0cDovL3Y4LjFjLnJ1LzguMS9kYXRhLWNvbXBvc2l0aW9u
LXN5c3RlbS9zZXR0aW5ncyIgeG1sbnM6ZGNzY29yPSJodHRwOi8vdjguMWMucnUv
OC4xL2RhdGEtY29tcG9zaXRpb24tc3lzdGVtL2NvcmUiIHhtbG5zOnN0eWxlPSJo
dHRwOi8vdjguMWMucnUvOC4xL2RhdGEvdWkvc3R5bGUiIHhtbG5zOnN5cz0iaHR0
cDovL3Y4LjFjLnJ1LzguMS9kYXRhL3VpL2ZvbnRzL3N5c3RlbSIgeG1sbnM6djg9
Imh0dHA6Ly92OC4xYy5ydS84LjEvZGF0YS9jb3JlIiB4bWxuczp2OHVpPSJodHRw
Oi8vdjguMWMucnUvOC4xL2RhdGEvdWkiIHhtbG5zOndlYj0iaHR0cDovL3Y4LjFj
LnJ1LzguMS9kYXRhL3VpL2NvbG9ycy93ZWIiIHhtbG5zOndpbj0iaHR0cDovL3Y4
LjFjLnJ1LzguMS9kYXRhL3VpL2NvbG9ycy93aW5kb3dzIiB4bWxuczp4cz0iaHR0
cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEiIHhtbG5zOnhzaT0iaHR0cDov
L3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEtaW5zdGFuY2UiLz4=}
},
{0,0},
{0,2,
{6,
{1,409b9a53-7f7e-4178-86c1-33176c7c7a7a},"Сформировать",
{1,1,
{"ru","Сформировать"}
},
{1,1,
{"ru","Сформировать"}
},
{0,
{0,
{"B",1},0}
},
{0,0,0},
{3,0,
{0},"",-1,-1,1,0},"Сформировать",3,0,0,
{0,0}
},
{6,
{2,409b9a53-7f7e-4178-86c1-33176c7c7a7a},"Период",
{1,1,
{"ru","Период"}
},
{1,1,
{"ru","Период"}
},
{0,
{0,
{"B",1},0}
},
{0,0,0},
{3,0,
{0},"",-1,-1,1,0},"Период",3,0,0,
{0,0}
}
},
{0,0},
{0,0}
}