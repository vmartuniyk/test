#Область ИнтерфейсАвтоматическихТестов

&НаКлиенте
Перем ЮнитТест;

&НаКлиенте
Функция ПолучитьСписокТестов(ЮнитТестирование) Экспорт
	
	ЮнитТест = ЮнитТестирование;
	
	СписокТестов = Новый Массив;	
	Возврат СписокТестов;
	
КонецФункции

#КонецОбласти


&НаКлиенте
Процедура ВходнаяЦенаПриИзменении(Элемент)
	Модифицированность=Истина;
КонецПроцедуры

&НаКлиенте
Процедура ИмяПринтераЭтикетокПриИзменении(Элемент)
	Модифицированность=Истина;
КонецПроцедуры



&НаКлиенте
Процедура ПередЗакрытием(Отказ, СтандартнаяОбработка)
	Если Модифицированность Тогда
		Ответ = Вопрос("Настройки внешних печатных форм были изменены. Сохранить настройки?", РежимДиалогаВопрос.ДаНетОтмена,, КодВозвратаДиалога.Да, "Сохранение настроек внених печатных форм.");
		Если Ответ=КодВозвратаДиалога.Да Тогда
			СохранитьНастройкиОбработкиНаСервере();
		ИначеЕсли Ответ=КодВозвратаДиалога.Отмена Тогда
			Отказ=Истина;
		КонецЕсли;
	КонецЕсли;
КонецПроцедуры

&НаКлиенте
Процедура Записать(Команда)
	Модифицированность=Ложь;
	СохранитьНастройкиОбработкиНаСервере();
КонецПроцедуры

&НаКлиенте
Процедура ЗакрытьИЗаписать(Команда)
	Модифицированность=Ложь;
	СохранитьНастройкиОбработкиНаСервере();
	Закрыть();
КонецПроцедуры





&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	ЗагрузитьНастройкиОбработкиНаСервере();
КонецПроцедуры




&НаСервере
Процедура СохранитьНастройкиОбработкиНаСервере()
	
	УстановитьПривилегированныйРежим(Истина);
	
	СтруктураНастроек = Новый Структура;
	
	СтруктураНастроек.Вставить("ВходнаяЦена", ВходнаяЦена);
	СтруктураНастроек.Вставить("ИмяПринтераЭтикеток", ИмяПринтераЭтикеток);

	
	ХранилищеНастроекДанныхФорм.Сохранить("ГлобальныеНастройкиВнешнихПечатныхФорм"
											, 
											, 
											СтруктураНастроек, 
											"Глобльные настройки внешних печатных форм", 
											"ГлобальныеНастройкиВнешнихПечатныхФорм");
	
КонецПроцедуры

&НаСервере
Процедура ЗагрузитьНастройкиОбработкиНаСервере()
	
	УстановитьПривилегированныйРежим(Истина);
	
	СтруктураНастроек = ХранилищеНастроекДанныхФорм.Загрузить("ГлобальныеНастройкиВнешнихПечатныхФорм",,, "ГлобальныеНастройкиВнешнихПечатныхФорм");
	Если НЕ ТипЗнч(СтруктураНастроек) = Тип("Структура") Тогда
		Возврат;
	КонецЕсли;
	
	СтруктураНастроек.Свойство("ВходнаяЦена", ВходнаяЦена);
	СтруктураНастроек.Свойство("ИмяПринтераЭтикеток", ИмяПринтераЭтикеток);
	
КонецПроцедуры




&НаКлиенте
Функция ОткрытьФормуОбработки(ИмяФорми, ПараметрыФормы, Модально = Истина) Экспорт
	
	Результат = Истина;
	
	Если Модально Тогда
		Результат = ОткрытьФормуМодально("ВнешняяОбработка.ВнешниеПечатныеФормы.Форма." + ИмяФорми, ПараметрыФормы);
	Иначе
		ОткрытьФорму("ВнешняяОбработка.ВнешниеПечатныеФормы.Форма." + ИмяФорми, ПараметрыФормы);
	КонецЕсли;
	
	Возврат Результат;
	
КонецФункции

