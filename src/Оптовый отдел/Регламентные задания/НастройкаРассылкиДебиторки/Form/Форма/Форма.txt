

////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ ФОРМЫ

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	ЗагрузитьНастройкиЗаданияНаСервере();
КонецПроцедуры

&НаКлиенте
Процедура ПередЗакрытием(Отказ, СтандартнаяОбработка)
	ЗаписатьНастройкиПередЗакрытием(Отказ);
КонецПроцедуры







////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ ЭЛЕМЕНТОВ ШАПКИ ФОРМЫ

&НаКлиенте
Процедура ОрганизацииДляРасчетаПриИзменении(Элемент)
	Модифицированность=Истина;
КонецПроцедуры

&НаКлиенте
Процедура УчетнаяЗаписьПриИзменении(Элемент)
	Модифицированность=Истина;
КонецПроцедуры

&НаКлиенте
Процедура ДополнительныеАдресаПриИзменении(Элемент)
	Модифицированность=Истина;
КонецПроцедуры

&НаКлиенте
Процедура СегментыПартнеровПриИзменении(Элемент)
	Модифицированность=Истина;
КонецПроцедуры




////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ ТАБЛИЦЫ ФОРМЫ СписокПользователей

&НаКлиенте
Процедура СписокПользователейПриИзменении(Элемент)
	Модифицированность=Истина;
КонецПроцедуры








////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ КОМАНД ФОРМЫ

&НаКлиенте
Процедура Записать(Команда)
	ЗаписатьНастройкиНаКлиенте();
КонецПроцедуры

&НаКлиенте
Процедура ЗаписатьИЗакрыть(Команда)
	ЗаписатьНастройкиНаКлиенте();
	Закрыть();
КонецПроцедуры

&НаКлиенте
Процедура ТестоваяРассылка(Команда)
	ОткрытьФорму("ВнешняяОбработка.НастройкаРассылкиДебиторки.Форма.ФормаТестовойРассылки");
КонецПроцедуры






////////////////////////////////////////////////////////////////////////////////
// СЛУЖЕБНЫЕ ПРОЦЕДУРЫ И ФУНКЦИИ
 
&НаСервере
Процедура ЗагрузитьНастройкиЗаданияНаСервере()
	ОбъектОбработки = РеквизитФормыВЗначение("Объект");
	ОбъектОбработки.ЗагрузитьНастройкиЗадания();
	ЗначениеВРеквизитФормы(ОбъектОбработки, "Объект");	
КонецПроцедуры // ЗагрузитьНастройкиНаСервере()

&НаСервере
Процедура СохранитьНастройкиЗаданияНаСервере(Отказ=Ложь)
	ОбъектОбработки = РеквизитФормыВЗначение("Объект");
	ОбъектОбработки.СохранитьНастройкиЗадания(Отказ);
	ЗначениеВРеквизитФормы(ОбъектОбработки, "Объект");									  
КонецПроцедуры // СохранитьНастройкиНаСервере()

 



&НаКлиенте
Процедура ЗаписатьНастройкиНаКлиенте(Отказ=Ложь)
	Если Модифицированность Тогда
		СохранитьНастройкиЗаданияНаСервере(Отказ);
		Если Не Отказ Тогда
			Модифицированность=Ложь;
		КонецЕсли;
	КонецЕсли;
КонецПроцедуры // ЗаписатьНастройкиНаКлиенте()


&НаКлиенте
Процедура ЗаписатьНастройкиПередЗакрытием(Отказ)
	
	Если Модифицированность Тогда
		Ответ = Вопрос(НСтр("ru='Настройки рассылки были изменены, сохранить изменения?'"), РежимДиалогаВопрос.ДаНетОтмена);
		Если Ответ = КодВозвратаДиалога.Да Тогда
			ЗаписатьНастройкиНаКлиенте(Отказ);
		КонецЕсли;
		Если Ответ = КодВозвратаДиалога.Нет Тогда
			Модифицированность=Ложь;
		КонецЕсли;
		Если Ответ = КодВозвратаДиалога.Отмена Тогда
			Отказ=Истина;
		КонецЕсли;
	КонецЕсли;
	
КонецПроцедуры // ЗаписатьНастройкиПередЗакрытием()


 